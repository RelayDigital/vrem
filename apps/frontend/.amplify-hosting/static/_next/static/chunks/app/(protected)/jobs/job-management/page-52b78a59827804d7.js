(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8367],{3266:(e,s,n)=>{Promise.resolve().then(n.bind(n,93999))},18085:(e,s,n)=>{"use strict";n.d(s,{A:()=>a});let a=(0,n(71847).A)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},32894:(e,s,n)=>{"use strict";n.d(s,{b:()=>d});var a=n(12115);n(47650);var l=n(32467),t=n(95155),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,s)=>{let n=(0,l.TL)(`Primitive.${s}`),i=a.forwardRef((e,a)=>{let{asChild:l,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(l?n:s,{...i,ref:a})});return i.displayName=`Primitive.${s}`,{...e,[s]:i}},{}),r=a.forwardRef((e,s)=>(0,t.jsx)(i.label,{...e,ref:s,onMouseDown:s=>{var n;s.target.closest("button, input, select, textarea")||(null==(n=e.onMouseDown)||n.call(e,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));r.displayName="Label";var d=r},35626:(e,s,n)=>{"use strict";n.d(s,{A:()=>a});let a=(0,n(71847).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},39347:(e,s,n)=>{"use strict";n.d(s,{A:()=>a});let a=(0,n(71847).A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},66955:(e,s,n)=>{"use strict";n.d(s,{A:()=>a});let a=(0,n(71847).A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},86651:(e,s,n)=>{"use strict";n.d(s,{A:()=>a});let a=(0,n(71847).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},93341:(e,s,n)=>{"use strict";n.d(s,{A:()=>a});let a=(0,n(71847).A)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]])},93999:(e,s,n)=>{"use strict";n.r(s),n.d(s,{default:()=>f});var a=n(95155),l=n(12115),t=n(20063),i=n(52619),r=n.n(i),d=n(24632),o=n(67803),c=n(37119),u=n(61771),h=n(55678),p=n(69802),v=n(30224),g=n(62816),b=n(76457);function f(){var e;(0,t.useRouter)();let{user:s,isLoading:n,organizationId:i,memberships:f}=(0,d.l)(["COMPANY","PROJECT_MANAGER","EDITOR"]),w=(0,h.w)(),k=(0,p.I)(),x=(0,l.useRef)(new Set),j=f.find(e=>e.orgId===i),m=((null==j?void 0:j.role)||(null==j?void 0:j.orgRole)||"").toUpperCase(),A="AGENT"===((null==s?void 0:s.accountType)||"").toUpperCase(),J=A||["OWNER","ADMIN","PROJECT_MANAGER"].includes(m),M=m||"NONE",E=(0,l.useCallback)(e=>{var n,a;let l={projectManagerId:null!=(n=e.projectManagerId)?n:null};return(0,b.ZZ)(M,l,null!=(a=null==s?void 0:s.id)?a:null)},[M,null==s?void 0:s.id]);if((0,l.useEffect)(()=>{let e=e=>{let s=w.getJobById(e.detail.id);s&&(w.selectJob(s),w.openTaskView(s))};return window.addEventListener("openJobTaskView",e),()=>{window.removeEventListener("openJobTaskView",e)}},[w]),(0,l.useEffect)(()=>{if(w.selectedJob){var e;let s=w.selectedJob.id;if(x.current.has(s))return;x.current.add(s);let n=null==(e=w.selectedJob)?void 0:e.organizationId;A||k.fetchMessages(s,"TEAM",n),J&&k.fetchMessages(s,"CUSTOMER",n)}},[null==(e=w.selectedJob)?void 0:e.id,J,A]),!s)return null;let T=w.openRankings;w.assignJob;let y=w.openTaskView,C=w.handleTaskViewClose,O=(e,s)=>{let n={pending:u.Ks.BOOKED,assigned:u.Ks.SHOOTING,in_progress:u.Ks.SHOOTING,editing:u.Ks.EDITING,delivered:u.Ks.DELIVERED,cancelled:u.Ks.BOOKED};w.changeJobStatus(e,n[s]||u.Ks.BOOKED)};return(0,a.jsxs)("div",{className:"size-full overflow-x-hidden flex flex-col h-[calc(100vh-var(--header-h))]",children:[(0,a.jsx)("div",{className:"container relative mx-auto px-md pt-md shrink-0 space-y-6",children:(0,a.jsx)(v.Qp,{children:(0,a.jsxs)(v.AB,{children:[(0,a.jsx)(v.J5,{children:(0,a.jsx)(v.w1,{asChild:!0,children:(0,a.jsx)(r(),{href:"/jobs",children:"Jobs"})})}),(0,a.jsx)(v.tH,{}),(0,a.jsx)(v.J5,{children:(0,a.jsx)(v.tJ,{children:"Job Management"})})]})})}),(0,a.jsx)(g.WT,{fallback:(0,a.jsx)(g.Um,{}),children:(0,a.jsx)(o.S,{jobs:w.jobs,technicians:[],messages:k.messages,onViewRankings:T,onChangeTechnician:T,onJobStatusChange:O,onJobClick:y,activeView:"kanban",canChangeJobStatus:E})}),(0,a.jsx)(c.m,{job:w.selectedJob,messages:w.selectedJob?k.getMessagesForJob(w.selectedJob.id):[],currentUserId:(null==s?void 0:s.id)||"current-user-id",currentUserName:(null==s?void 0:s.name)||"Current User",currentUserAccountType:null==s?void 0:s.accountType,isClient:!1,open:w.showTaskView,onOpenChange:C,onSendMessage:(e,s,n)=>{var a;return k.sendMessage((null==(a=w.selectedJob)?void 0:a.id)||"",e,s,n)},onEditMessage:(e,s)=>k.editMessage(e,s),onDeleteMessage:e=>k.deleteMessage(e),onStatusChange:e=>{w.selectedJob&&O(w.selectedJob.id,e)},onAssignTechnician:w.handleAssignTechnician,onChangeTechnician:w.handleChangeTechnician})]})}}},e=>{e.O(0,[541,5004,277,547,5707,2110,8234,2619,4001,3409,1204,9360,1163,550,1130,7117,2303,7770,9829,5181,5909,5657,5939,4802,4729,2816,1382,4098,8441,1255,7358],()=>e(e.s=3266)),_N_E=e.O()}]);