(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1768],{20017:(e,s,n)=>{"use strict";n.d(s,{A:()=>a});let a=(0,n(71847).A)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},26921:(e,s,n)=>{"use strict";n.d(s,{A:()=>a});let a=(0,n(71847).A)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]])},43285:(e,s,n)=>{"use strict";n.d(s,{b:()=>S});var a=n(95155),t=n(62816),r=n(90923),l=n(95664),i=n(60890),d=n(54255),c=n(26397),o=n(6132),u=n(56154),h=n(26983),m=n(21873),g=n(16485),x=n(6191),p=n(29633),v=n(61362),b=n(48432);function j(e){let{pendingCount:s,assignedCount:n,inProgressCount:t,completedCount:r}=e;return(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsx)(b.CN,{icon:h.A,value:s,label:"Pending Assignment",iconBgColor:"bg-orange-100",iconColor:"text-orange-600"}),(0,a.jsx)(b.CN,{icon:p.A,value:n,label:"Assigned",iconBgColor:"bg-accent",iconColor:"text-primary"}),(0,a.jsx)(b.CN,{icon:p.A,value:t,label:"In Progress",iconBgColor:"bg-accent",iconColor:"text-primary"}),(0,a.jsx)(b.CN,{icon:v.A,value:r,label:"Completed",iconBgColor:"bg-emerald-100",iconColor:"text-emerald-600"})]})}var f=n(96633),N=n(67812),w=n(33884),y=n(71163),C=n(82180),T=n(73344),A=n(97003),k=n(20063),I=n(24632),M=n(84433),J=n(25703);function S(e){let{jobs:s,technicians:n,organizationId:b,onNewJobClick:S,onJobClick:E}=e,{user:O}=(0,I.l)(["AGENT","TECHNICIAN","EDITOR","PROJECT_MANAGER","COMPANY"]),_=(0,k.useRouter)(),{shouldShowGuide:P,isTourActive:D}=(0,J.Mw)(),R=n||n||[],U=s.filter(e=>"pending"===e.status),F=s.filter(e=>"assigned"===e.status),V=s.filter(e=>"in_progress"===e.status),G=s.filter(e=>"delivered"===e.status),z=e=>{E?(E(e),D&&setTimeout(()=>{window.dispatchEvent(new CustomEvent("jobTaskViewOpened",{detail:{id:e.id}}))},100)):_.push("/jobs/".concat(e.id))},K=e=>{let s=e.assignedTechnicianId||e.assignedTechnicianId,n=s?R.find(e=>e.id===s):void 0,t=(e=>{switch(e){case"urgent":return{variant:"destructive",label:"Urgent",icon:o.A};case"rush":return{variant:"secondary",label:"Rush",icon:u.A};default:return{variant:"outline",label:"Standard",icon:h.A}}})(e.priority),r=(e=>{switch(e){case"pending":return{variant:"outline",label:"Pending"};case"assigned":return{variant:"secondary",label:"Assigned"};case"in_progress":return{variant:"default",label:"In Progress"};case"editing":return{variant:"secondary",label:"Editing"};case"delivered":return{variant:"default",label:"Delivered"};case"cancelled":return{variant:"destructive",label:"Cancelled"};default:return{variant:"outline",label:e}}})(e.status),x=t.icon;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.nA,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2 min-w-[200px]",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 text-muted-foreground shrink-0"}),(0,a.jsxs)(C.m_,{children:[(0,a.jsx)(C.k$,{asChild:!0,children:(0,a.jsx)("span",{className:"truncate max-w-[180px]",children:e.propertyAddress})}),(0,a.jsx)(C.ZI,{children:(0,a.jsx)(T.P,{className:"max-w-xs",children:e.propertyAddress})})]})]})}),(0,a.jsx)(f.nA,{children:(0,a.jsx)("span",{className:"text-sm",children:e.clientName})}),(0,a.jsx)(f.nA,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-sm",children:(0,y.GP)(new Date(e.scheduledDate),"MMM d, yyyy")}),e.scheduledTime&&(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:e.scheduledTime})]})]})}),(0,a.jsx)(f.nA,{children:(0,a.jsx)("div",{className:"flex items-center gap-1 flex-wrap",children:e.mediaType.map(e=>{let s=(e=>{switch(e){case"photo":default:return l.A;case"video":return i.A;case"aerial":return d.A;case"twilight":return c.A}})(e);return(0,a.jsxs)(C.m_,{children:[(0,a.jsx)(C.k$,{asChild:!0,children:(0,a.jsx)("div",{className:"p-1.5 rounded bg-muted",children:(0,a.jsx)(s,{className:"h-3 w-3"})})}),(0,a.jsx)(C.ZI,{children:(0,a.jsx)(T.P,{className:"capitalize",children:e})})]},e)})})}),(0,a.jsx)(f.nA,{children:(0,a.jsxs)(N.E,{variant:t.variant,className:"gap-1",children:[(0,a.jsx)(x,{className:"h-3 w-3"}),t.label]})}),(0,a.jsx)(f.nA,{children:(0,a.jsx)(N.E,{variant:r.variant,children:r.label})}),(0,a.jsx)(f.nA,{children:n?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(w.eu,{className:"h-6 w-6",children:[(0,a.jsx)(w.BK,{src:n.avatar,alt:n.name}),(0,a.jsx)(w.q5,{children:n.name.split(" ").map(e=>e[0]).join("")})]}),(0,a.jsx)("span",{className:"text-sm",children:n.name})]}):(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Unassigned"})}),(0,a.jsx)(f.nA,{className:"text-right"})]})};return(0,a.jsx)("main",{className:"container relative mx-auto",children:(0,a.jsxs)("article",{className:"flex flex-col gap-2xl md:gap-3xl px-md","data-tour":"dashboard-article",children:[P&&(0,a.jsx)("div",{className:"@container w-full mt-md","data-tour":"setup-guide",children:(0,a.jsx)(M.K,{})}),(0,a.jsxs)("div",{className:"@container w-full ".concat(P?"":"mt-md"," mb-md"),"data-tour":"agent-dashboard",children:[(0,a.jsxs)("div",{className:"mb-md flex items-baseline justify-between","data-tour":"agent-header",children:[(0,a.jsx)(T.H2,{className:"text-4xl mb-xs",children:"My Jobs"}),(0,a.jsxs)(A.$,{variant:"default",onClick:S,"data-tour":"jobs-create-button",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Create Order"]})]}),(0,a.jsx)("div",{className:"@container w-full mb-md","data-tour":"agent-stats",children:(0,a.jsx)(j,{pendingCount:U.length,assignedCount:F.length,inProgressCount:V.length,completedCount:G.length})}),(0,a.jsx)("div",{className:"@container w-full","data-tour":"agent-jobs-list",children:(0,a.jsxs)(r.tU,{defaultValue:"all",className:"w-full",children:[(0,a.jsxs)(r.j7,{className:"grid w-full grid-cols-5 rounded-md","data-tour":"jobs-tabs",children:[(0,a.jsxs)(r.Xi,{value:"all",children:["All (",s.length,")"]}),(0,a.jsxs)(r.Xi,{value:"pending",children:["Pending (",U.length,")"]}),(0,a.jsxs)(r.Xi,{value:"assigned",children:["Assigned (",F.length,")"]}),(0,a.jsxs)(r.Xi,{value:"in_progress",children:["In Progress (",V.length,")"]}),(0,a.jsxs)(r.Xi,{value:"completed",children:["Completed (",G.length,")"]})]}),(0,a.jsx)(r.av,{value:"all",className:"mt-6",children:(0,a.jsx)(t.rw,{items:s,searchPlaceholder:"Search by address, client, Order #...",searchFields:e=>"".concat(e.propertyAddress," ").concat(e.clientName," ").concat(e.scheduledDate," ").concat(e.orderNumber),filterOptions:[{label:"Urgent",value:"urgent"},{label:"Rush",value:"rush"},{label:"Standard",value:"standard"}],onItemClick:z,onFilterChange:e=>s.filter(s=>"all"===e||s.priority===e),renderItem:e=>{let s=e.assignedTechnicianId||e.assignedTechnicianId,n=s?R.find(e=>e.id===s):void 0;return(0,a.jsx)(t.oe,{job:e,technician:n,currentUserAccountType:null==O?void 0:O.accountType},e.id)},renderTableRow:K,emptyMessage:"No jobs yet",emptyIcon:p.A,emptyTitle:"No jobs yet",emptyDescription:"Create your first booking to get started",emptyAction:{label:"Create Order",onClick:S},itemsPerPage:12})}),(0,a.jsx)(r.av,{value:"pending",className:"mt-6",children:(0,a.jsx)(t.rw,{items:U,searchPlaceholder:"Search by address, client, Order #...",searchFields:e=>"".concat(e.propertyAddress," ").concat(e.clientName," ").concat(e.scheduledDate," ").concat(e.orderNumber),filterOptions:[{label:"Urgent",value:"urgent"},{label:"Rush",value:"rush"},{label:"Standard",value:"standard"}],onItemClick:z,onFilterChange:e=>U.filter(s=>"all"===e||s.priority===e),renderItem:e=>{let s=e.assignedTechnicianId||e.assignedTechnicianId,n=s?R.find(e=>e.id===s):void 0;return(0,a.jsx)(t.oe,{job:e,technician:n,currentUserAccountType:null==O?void 0:O.accountType},e.id)},renderTableRow:K,emptyMessage:"No pending jobs",emptyIcon:h.A,emptyTitle:"No pending jobs",emptyDescription:"All your jobs have been assigned",itemsPerPage:12})}),(0,a.jsx)(r.av,{value:"assigned",className:"mt-6",children:(0,a.jsx)(t.rw,{items:F,searchPlaceholder:"Search by address, client, Order #...",searchFields:e=>"".concat(e.propertyAddress," ").concat(e.clientName," ").concat(e.scheduledDate," ").concat(e.orderNumber),filterOptions:[{label:"Urgent",value:"urgent"},{label:"Rush",value:"rush"},{label:"Standard",value:"standard"}],onItemClick:z,onFilterChange:e=>F.filter(s=>"all"===e||s.priority===e),renderItem:e=>{let s=e.assignedTechnicianId||e.assignedTechnicianId,n=s?R.find(e=>e.id===s):void 0;return(0,a.jsx)(t.oe,{job:e,technician:n,currentUserAccountType:null==O?void 0:O.accountType},e.id)},renderTableRow:K,emptyMessage:"No assigned jobs",emptyIcon:p.A,emptyTitle:"No assigned jobs",emptyDescription:"Jobs will appear here once assigned to a technician",itemsPerPage:12})}),(0,a.jsx)(r.av,{value:"in_progress",className:"mt-6",children:(0,a.jsx)(t.rw,{items:V,searchPlaceholder:"Search by address, client, Order #...",searchFields:e=>"".concat(e.propertyAddress," ").concat(e.clientName," ").concat(e.scheduledDate," ").concat(e.orderNumber),filterOptions:[{label:"Urgent",value:"urgent"},{label:"Rush",value:"rush"},{label:"Standard",value:"standard"}],onItemClick:z,onFilterChange:e=>V.filter(s=>"all"===e||s.priority===e),renderItem:e=>{let s=e.assignedTechnicianId||e.assignedTechnicianId,n=s?R.find(e=>e.id===s):void 0;return(0,a.jsx)(t.oe,{job:e,technician:n,currentUserAccountType:null==O?void 0:O.accountType},e.id)},renderTableRow:K,emptyMessage:"No jobs in progress",emptyIcon:p.A,emptyTitle:"No jobs in progress",emptyDescription:"Active shoots will appear here",itemsPerPage:12})}),(0,a.jsx)(r.av,{value:"completed",className:"mt-6",children:(0,a.jsx)(t.rw,{items:G,searchPlaceholder:"Search by address, client, Order #...",searchFields:e=>"".concat(e.propertyAddress," ").concat(e.clientName," ").concat(e.scheduledDate," ").concat(e.orderNumber),filterOptions:[{label:"Urgent",value:"urgent"},{label:"Rush",value:"rush"},{label:"Standard",value:"standard"}],onItemClick:z,onFilterChange:e=>G.filter(s=>"all"===e||s.priority===e),renderItem:e=>{let s=e.assignedTechnicianId||e.assignedTechnicianId,n=s?R.find(e=>e.id===s):void 0;return(0,a.jsx)(t.oe,{job:e,technician:n},e.id)},renderTableRow:K,emptyMessage:"No completed jobs",emptyIcon:v.A,emptyTitle:"No completed jobs",emptyDescription:"Finished jobs will appear here",itemsPerPage:12})})]})})]})]})})}},48432:(e,s,n)=>{"use strict";n.d(s,{CN:()=>d,MD:()=>c});var a=n(95155),t=n(51089),r=n(83209),l=n(1524),i=n(26921);function d(e){let{icon:s,value:n,type:d="card",label:c,iconBgColor:o="bg-accent",iconColor:u="text-primary",valuePrefix:h="",valueSuffix:m="",description:g="",trendPercentage:x=0,previousValue:p=0,chart:v,chartConfig:b}=e;return(0,a.jsx)(r.Zp,{variant:"muted",children:"card"===d?(0,a.jsx)(r.Wu,{className:"p-6 gap-0",children:(0,a.jsxs)("div",{className:"flex flex-row items-center gap-4",children:[(0,a.jsx)("div",{className:"p-3 ".concat(o," rounded-xl self-start"),children:(0,a.jsx)(s,{className:"size-5 ".concat(u)})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:c}),(0,a.jsxs)("div",{className:"text-3xl font-bold text-foreground mb-1 flex items-baseline gap-1",children:[h,(0,a.jsxs)("span",{className:"flex items-baseline gap-1",children:[n,0!==x&&(x>0?(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm text-green-600",children:[(0,a.jsx)(l.A,{className:"size-4"}),(0,a.jsxs)("span",{children:[x,"%"]})]}):(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm text-red-600",children:[(0,a.jsx)(i.A,{className:"size-4"}),(0,a.jsxs)("span",{children:[x,"%"]})]}))]}),m]}),g&&(0,a.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:g}),0!==p&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["Previous month: ",p]})]})]})}):(0,a.jsx)(r.Wu,{className:"p-6 gap-0",children:(0,a.jsxs)("div",{className:"flex flex-col items-start gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center gap-4 w-full",children:[(0,a.jsx)("div",{className:"p-3 ".concat(o," rounded-xl self-start"),children:(0,a.jsx)(s,{className:"size-5 ".concat(u)})}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:c})]}),(0,a.jsx)(t.at,{config:b||{},className:"h-[300px] w-full",children:(0,a.jsx)("div",{className:"w-full",children:v})})]})})})}function c(e){let{stats:s,columns:n=4,className:t=""}=e;return(0,a.jsx)("div",{className:"grid ".concat({1:"grid-cols-1",2:"grid-cols-1 md:grid-cols-2",3:"grid-cols-1 md:grid-cols-3",4:"grid-cols-1 md:grid-cols-4"}[n]," gap-4 ").concat(t),children:s.map((e,s)=>(0,a.jsx)(d,{icon:e.icon,value:e.value,label:e.label,iconBgColor:e.iconBgColor,iconColor:e.iconColor,valueSuffix:e.valueSuffix},s))})}n(12115),n(67812),n(97003),n(73344),n(75548),n(94876)},49564:(e,s,n)=>{"use strict";n.r(s),n.d(s,{default:()=>j});var a=n(95155),t=n(12115),r=n(20063),l=n(52619),i=n.n(l),d=n(24632),c=n(67803),o=n(43285),u=n(37119),h=n(61771),m=n(55678),g=n(69802),x=n(30224),p=n(62816),v=n(35722),b=n(80408);function j(){var e;let s=(0,r.useRouter)(),{user:n,isLoading:l,organizationId:j,memberships:f}=(0,d.l)(["COMPANY","AGENT","TECHNICIAN","EDITOR","PROJECT_MANAGER"]),N=(0,m.w)(),w=(0,g.I)(),y="AGENT"===((null==n?void 0:n.accountType)||"").toUpperCase(),[C,T]=(0,t.useState)([]),[,A]=(0,t.useState)(!1),k=(0,t.useRef)(new Set),I=(0,t.useMemo)(()=>n?N.jobs.filter(e=>e.assignedTechnicianId===n.id||e.editorId===n.id):[],[N.jobs,n]),M=(0,t.useMemo)(()=>n?N.jobs.filter(e=>e.editorId===n.id):[],[N.jobs,n]),J=f.find(e=>e.orgId===j),S=((null==J?void 0:J.role)||(null==J?void 0:J.orgRole)||"").toUpperCase(),E=y||["OWNER","ADMIN","PROJECT_MANAGER"].includes(S);if((0,t.useEffect)(()=>{let e=e=>{let s=N.getJobById(e.detail.id);s&&(N.selectJob(s),N.openTaskView(s))};return window.addEventListener("openJobTaskView",e),()=>{window.removeEventListener("openJobTaskView",e)}},[N]),(0,t.useEffect)(()=>{if(N.selectedJob){var e;let s=N.selectedJob.id;if(k.current.has(s))return;k.current.add(s);let n=null==(e=N.selectedJob)?void 0:e.organizationId;y||w.fetchMessages(s,"TEAM",n),E&&w.fetchMessages(s,"CUSTOMER",n)}},[null==(e=N.selectedJob)?void 0:e.id,E,y]),(0,t.useEffect)(()=>{let e=!1;return(async()=>{if(n&&!y){A(!0);try{let s=await (0,v.NV)();e||T(s)}catch(s){console.error("Failed to load technicians for jobs list:",s),e||T([])}finally{e||A(!1)}}})(),()=>{e=!0}},[n,y]),!n)return null;let O=(0,b.aJ)(n,f,j),_=N.openRankings;N.assignJob;let P=N.openTaskView,D=N.openTaskDialog,R=N.handleTaskDialogClose,U=()=>{N.selectedJob&&s.push("/jobs/".concat(N.selectedJob.id))},F=N.handleTaskViewClose,V=(e,s)=>{let n={pending:h.Ks.BOOKED,assigned:h.Ks.SHOOTING,in_progress:h.Ks.SHOOTING,editing:h.Ks.EDITING,delivered:h.Ks.DELIVERED,cancelled:h.Ks.BOOKED};N.changeJobStatus(e,n[s]||h.Ks.BOOKED)};return(0,b.UD)(O)?(0,a.jsxs)("div",{className:"size-full overflow-x-hidden",children:[(0,a.jsx)("div",{className:"container relative mx-auto px-md pt-md",children:(0,a.jsx)(x.Qp,{children:(0,a.jsxs)(x.AB,{children:[(0,a.jsx)(x.J5,{children:(0,a.jsx)(x.w1,{asChild:!0,children:(0,a.jsx)(i(),{href:"/jobs",children:"Jobs"})})}),(0,a.jsx)(x.tH,{}),(0,a.jsx)(x.J5,{children:(0,a.jsx)(x.tJ,{children:"All Jobs"})})]})})}),(0,a.jsx)(p.WT,{fallback:(0,a.jsx)(p.Um,{}),children:(0,a.jsx)(c.S,{jobs:N.jobs,technicians:C,messages:w.messages,onViewRankings:_,onChangeTechnician:_,onJobStatusChange:V,onJobClick:P,activeView:"all"})}),(0,a.jsx)(u.m,{job:N.selectedJob,messages:N.selectedJob?w.getMessagesForJob(N.selectedJob.id):[],currentUserId:(null==n?void 0:n.id)||"current-user-id",currentUserName:(null==n?void 0:n.name)||"Current User",currentUserAccountType:null==n?void 0:n.accountType,isClient:!1,open:N.showTaskView,onOpenChange:F,onSendMessage:(e,s,n)=>{var a;return w.sendMessage((null==(a=N.selectedJob)?void 0:a.id)||"",e,s,n)},onEditMessage:(e,s)=>w.editMessage(e,s),onDeleteMessage:e=>w.deleteMessage(e),onStatusChange:e=>{N.selectedJob&&V(N.selectedJob.id,e)},onAssignTechnician:N.handleAssignTechnician,onChangeTechnician:N.handleChangeTechnician,variant:"sheet",onFullScreen:D,onOpenInNewPage:U}),(0,a.jsx)(u.m,{job:N.selectedJob,messages:N.selectedJob?w.getMessagesForJob(N.selectedJob.id):[],currentUserId:(null==n?void 0:n.id)||"current-user-id",currentUserName:(null==n?void 0:n.name)||"Current User",currentUserAccountType:null==n?void 0:n.accountType,isClient:!1,open:N.showTaskDialog,onOpenChange:R,onSendMessage:(e,s,n)=>{var a;return w.sendMessage((null==(a=N.selectedJob)?void 0:a.id)||"",e,s,n)},onEditMessage:(e,s)=>w.editMessage(e,s),onDeleteMessage:e=>w.deleteMessage(e),onStatusChange:e=>{N.selectedJob&&V(N.selectedJob.id,e)},onAssignTechnician:N.handleAssignTechnician,onChangeTechnician:N.handleChangeTechnician,variant:"dialog"})]}):"TECHNICIAN"===O?(0,a.jsxs)("div",{className:"size-full overflow-x-hidden space-y-6",children:[(0,a.jsx)(p.WT,{fallback:(0,a.jsx)(p.Um,{}),children:(0,a.jsx)(c.S,{jobs:I,technicians:C,messages:w.messages,onViewRankings:()=>{},onChangeTechnician:void 0,onJobStatusChange:V,onJobClick:P,activeView:"all"})}),(0,a.jsx)(u.m,{job:N.selectedJob,messages:N.selectedJob?w.getMessagesForJob(N.selectedJob.id):[],currentUserId:(null==n?void 0:n.id)||"current-user-id",currentUserName:(null==n?void 0:n.name)||"Current User",isClient:!1,open:N.showTaskView,onOpenChange:F,onSendMessage:(e,s,n)=>{var a;return w.sendMessage((null==(a=N.selectedJob)?void 0:a.id)||"",e,s,n)},onEditMessage:(e,s)=>w.editMessage(e,s),onDeleteMessage:e=>w.deleteMessage(e),onStatusChange:e=>{N.selectedJob&&V(N.selectedJob.id,e)},onAssignTechnician:N.handleAssignTechnician,onChangeTechnician:N.handleChangeTechnician,variant:"sheet",onFullScreen:D,onOpenInNewPage:U}),(0,a.jsx)(u.m,{job:N.selectedJob,messages:N.selectedJob?w.getMessagesForJob(N.selectedJob.id):[],currentUserId:(null==n?void 0:n.id)||"current-user-id",currentUserName:(null==n?void 0:n.name)||"Current User",isClient:!1,open:N.showTaskDialog,onOpenChange:R,onSendMessage:(e,s,n)=>{var a;return w.sendMessage((null==(a=N.selectedJob)?void 0:a.id)||"",e,s,n)},onEditMessage:(e,s)=>w.editMessage(e,s),onDeleteMessage:e=>w.deleteMessage(e),onStatusChange:e=>{N.selectedJob&&V(N.selectedJob.id,e)},onAssignTechnician:N.handleAssignTechnician,onChangeTechnician:N.handleChangeTechnician,variant:"dialog"})]}):"EDITOR"===S?(0,a.jsxs)("div",{className:"size-full overflow-x-hidden space-y-6",children:[(0,a.jsx)(p.WT,{fallback:(0,a.jsx)(p.Um,{}),children:(0,a.jsx)(c.S,{jobs:M,technicians:C,messages:w.messages,onViewRankings:()=>{},onChangeTechnician:void 0,onJobStatusChange:V,onJobClick:P,activeView:"all"})}),(0,a.jsx)(u.m,{job:N.selectedJob,messages:N.selectedJob?w.getMessagesForJob(N.selectedJob.id):[],currentUserId:(null==n?void 0:n.id)||"current-user-id",currentUserName:(null==n?void 0:n.name)||"Current User",isClient:!1,open:N.showTaskView,onOpenChange:F,onSendMessage:(e,s,n)=>{var a;return w.sendMessage((null==(a=N.selectedJob)?void 0:a.id)||"",e,s,n)},onEditMessage:(e,s)=>w.editMessage(e,s),onDeleteMessage:e=>w.deleteMessage(e),onStatusChange:e=>{N.selectedJob&&V(N.selectedJob.id,e)},onAssignTechnician:N.handleAssignTechnician,onChangeTechnician:N.handleChangeTechnician,variant:"sheet",onFullScreen:D,onOpenInNewPage:U}),(0,a.jsx)(u.m,{job:N.selectedJob,messages:N.selectedJob?w.getMessagesForJob(N.selectedJob.id):[],currentUserId:(null==n?void 0:n.id)||"current-user-id",currentUserName:(null==n?void 0:n.name)||"Current User",isClient:!1,open:N.showTaskDialog,onOpenChange:R,onSendMessage:(e,s,n)=>{var a;return w.sendMessage((null==(a=N.selectedJob)?void 0:a.id)||"",e,s,n)},onEditMessage:(e,s)=>w.editMessage(e,s),onDeleteMessage:e=>w.deleteMessage(e),onStatusChange:e=>{N.selectedJob&&V(N.selectedJob.id,e)},onAssignTechnician:N.handleAssignTechnician,onChangeTechnician:N.handleChangeTechnician,variant:"dialog"})]}):"AGENT"===O?(0,a.jsx)("div",{className:"size-full overflow-x-hidden",children:(0,a.jsx)(p.WT,{fallback:(0,a.jsx)(p.Um,{}),children:(0,a.jsx)(o.b,{jobs:N.jobCards,technicians:[],organizationId:n.organizationId||"",onNewJobClick:()=>s.push("/booking")})})}):(0,a.jsx)("div",{className:"size-full overflow-x-hidden p-6"})}},51089:(e,s,n)=>{"use strict";n.d(s,{II:()=>m,Nt:()=>g,at:()=>u});var a=n(95155),t=n(12115),r=n(26265),l=n(33420),i=n(37665),d=n(64936);let c={light:"",dark:".dark"},o=t.createContext(null);function u(e){let{id:s,className:n,children:l,config:i,...c}=e,u=t.useId(),m="chart-".concat(s||u.replace(/:/g,""));return(0,a.jsx)(o.Provider,{value:{config:i},children:(0,a.jsxs)("div",{"data-slot":"chart","data-chart":m,className:(0,d.cn)("[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",n),...c,children:[(0,a.jsx)(h,{id:m,config:i}),(0,a.jsx)(r.u,{children:l})]})})}let h=e=>{let{id:s,config:n}=e,t=Object.entries(n).filter(e=>{let[,s]=e;return s.theme||s.color});return t.length?(0,a.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(c).map(e=>{let[n,a]=e;return"\n".concat(a," [data-chart=").concat(s,"] {\n").concat(t.map(e=>{var s;let[a,t]=e,r=(null==(s=t.theme)?void 0:s[n])||t.color;return r?"  --color-".concat(a,": ").concat(r,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},m=l.m;function g(e){let{active:s,payload:n,className:r,indicator:l="dot",hideLabel:i=!1,hideIndicator:c=!1,label:u,labelFormatter:h,labelClassName:m,formatter:g,color:p,nameKey:v,labelKey:b}=e,{config:j}=function(){let e=t.useContext(o);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}(),f=t.useMemo(()=>{var e;if(i||!(null==n?void 0:n.length))return null;let[s]=n,t="".concat(b||(null==s?void 0:s.dataKey)||(null==s?void 0:s.name)||"value"),r=x(j,s,t),l=b||"string"!=typeof u?null==r?void 0:r.label:(null==(e=j[u])?void 0:e.label)||u;return h?(0,a.jsx)("div",{className:(0,d.cn)("font-medium",m),children:h(l,n)}):l?(0,a.jsx)("div",{className:(0,d.cn)("font-medium",m),children:l}):null},[u,h,n,i,m,j,b]);if(!s||!(null==n?void 0:n.length))return null;let N=1===n.length&&"dot"!==l;return(0,a.jsxs)("div",{className:(0,d.cn)("border-border/50 bg-background grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl",r),children:[N?null:f,(0,a.jsx)("div",{className:"grid gap-1.5",children:n.map((e,s)=>{let n="".concat(v||e.name||e.dataKey||"value"),t=x(j,e,n),r=p||e.payload.fill||e.color;return(0,a.jsx)("div",{className:(0,d.cn)("[&>svg]:text-muted-foreground flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5","dot"===l&&"items-center"),children:g&&(null==e?void 0:e.value)!==void 0&&e.name?g(e.value,e.name,e,s,e.payload):(0,a.jsxs)(a.Fragment,{children:[(null==t?void 0:t.icon)?(0,a.jsx)(t.icon,{}):!c&&(0,a.jsx)("div",{className:(0,d.cn)("shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)",{"h-2.5 w-2.5":"dot"===l,"w-1":"line"===l,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===l,"my-0.5":N&&"dashed"===l}),style:{"--color-bg":r,"--color-border":r}}),(0,a.jsxs)("div",{className:(0,d.cn)("flex flex-1 justify-between leading-none",N?"items-end":"items-center"),children:[(0,a.jsxs)("div",{className:"grid gap-1.5",children:[N?f:null,(0,a.jsx)("span",{className:"text-muted-foreground",children:(null==t?void 0:t.label)||e.name})]}),e.value&&(0,a.jsx)("span",{className:"text-foreground font-mono font-medium tabular-nums",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})}function x(e,s,n){if("object"!=typeof s||null===s)return;let a="payload"in s&&"object"==typeof s.payload&&null!==s.payload?s.payload:void 0,t=n;return n in s&&"string"==typeof s[n]?t=s[n]:a&&n in a&&"string"==typeof a[n]&&(t=a[n]),t in e?e[t]:e[n]}i.s},55850:(e,s,n)=>{"use strict";n.d(s,{k:()=>i});var a=n(95155),t=n(12115),r=n(77450),l=n(25016);let i=t.forwardRef((e,s)=>{let{className:n,value:t,indicatorClassName:i,...d}=e;return(0,a.jsx)(r.bL,{ref:s,className:(0,l.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",n),...d,children:(0,a.jsx)(r.C1,{className:(0,l.cn)("h-full w-full flex-1 bg-primary transition-all",i),style:{transform:"translateX(-".concat(100-(t||0),"%)")}})})});i.displayName=r.bL.displayName},77450:(e,s,n)=>{"use strict";n.d(s,{C1:()=>N,bL:()=>f});var a=n(12115),t=n(95155);n(47650);var r=n(32467),l=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,s)=>{let n=(0,r.TL)(`Primitive.${s}`),l=a.forwardRef((e,a)=>{let{asChild:r,...l}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(r?n:s,{...l,ref:a})});return l.displayName=`Primitive.${s}`,{...e,[s]:l}},{}),i="Progress",[d,c]=function(e,s=[]){let n=[],r=()=>{let s=n.map(e=>a.createContext(e));return function(n){let t=n?.[e]||s;return a.useMemo(()=>({[`__scope${e}`]:{...n,[e]:t}}),[n,t])}};return r.scopeName=e,[function(s,r){let l=a.createContext(r);l.displayName=s+"Context";let i=n.length;n=[...n,r];let d=s=>{let{scope:n,children:r,...d}=s,c=n?.[e]?.[i]||l,o=a.useMemo(()=>d,Object.values(d));return(0,t.jsx)(c.Provider,{value:o,children:r})};return d.displayName=s+"Provider",[d,function(n,t){let d=t?.[e]?.[i]||l,c=a.useContext(d);if(c)return c;if(void 0!==r)return r;throw Error(`\`${n}\` must be used within \`${s}\``)}]},function(...e){let s=e[0];if(1===e.length)return s;let n=()=>{let n=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let t=n.reduce((s,{useScope:n,scopeName:a})=>{let t=n(e)[`__scope${a}`];return{...s,...t}},{});return a.useMemo(()=>({[`__scope${s.scopeName}`]:t}),[t])}};return n.scopeName=s.scopeName,n}(r,...s)]}(i),[o,u]=d(i),h=a.forwardRef((e,s)=>{var n,a,r,i;let{__scopeProgress:d,value:c=null,max:u,getValueLabel:h=x,...m}=e;(u||0===u)&&!b(u)&&console.error((n="".concat(u),a="Progress","Invalid prop `max` of value `".concat(n,"` supplied to `").concat(a,"`. Only numbers greater than 0 are valid max values. Defaulting to `").concat(100,"`.")));let g=b(u)?u:100;null===c||j(c,g)||console.error((r="".concat(c),i="Progress","Invalid prop `value` of value `".concat(r,"` supplied to `").concat(i,"`. The `value` prop must be:\n  - a positive number\n  - less than the value passed to `max` (or ").concat(100," if no `max` prop is set)\n  - `null` or `undefined` if the progress is indeterminate.\n\nDefaulting to `null`.")));let f=j(c,g)?c:null,N=v(f)?h(f,g):void 0;return(0,t.jsx)(o,{scope:d,value:f,max:g,children:(0,t.jsx)(l.div,{"aria-valuemax":g,"aria-valuemin":0,"aria-valuenow":v(f)?f:void 0,"aria-valuetext":N,role:"progressbar","data-state":p(f,g),"data-value":null!=f?f:void 0,"data-max":g,...m,ref:s})})});h.displayName=i;var m="ProgressIndicator",g=a.forwardRef((e,s)=>{var n;let{__scopeProgress:a,...r}=e,i=u(m,a);return(0,t.jsx)(l.div,{"data-state":p(i.value,i.max),"data-value":null!=(n=i.value)?n:void 0,"data-max":i.max,...r,ref:s})});function x(e,s){return"".concat(Math.round(e/s*100),"%")}function p(e,s){return null==e?"indeterminate":e===s?"complete":"loading"}function v(e){return"number"==typeof e}function b(e){return v(e)&&!isNaN(e)&&e>0}function j(e,s){return v(e)&&!isNaN(e)&&e<=s&&e>=0}g.displayName=m;var f=h,N=g},79679:(e,s,n)=>{Promise.resolve().then(n.bind(n,49564))},84433:(e,s,n)=>{"use strict";n.d(s,{K:()=>N});var a=n(95155),t=n(12115),r=n(20017),l=n(48314),i=n(65229),d=n(12108),c=n(24033),o=n(5917),u=n(83209),h=n(97003),m=n(55850),g=n(35561),x=n(51539),p=n(7220),v=n(25703),b=n(25016);function j(e){let{borderWidth:s=1,duration:n=14,shineColor:t="#000000",className:r,style:l,...i}=e;return(0,a.jsx)("div",{style:{"--border-width":"".concat(s,"px"),"--duration":"".concat(n,"s"),backgroundImage:"radial-gradient(transparent,transparent, ".concat(Array.isArray(t)?t.join(","):t,",transparent,transparent)"),backgroundSize:"300% 300%",mask:"linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0)",WebkitMask:"linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0)",WebkitMaskComposite:"xor",maskComposite:"exclude",padding:"var(--border-width)",...l},className:(0,b.cn)("motion-safe:animate-shine pointer-events-none absolute inset-0 size-full rounded-[inherit] will-change-[background-position]",r),...i})}let f=["DASHBOARD_OVERVIEW","JOB_MANAGEMENT","MESSAGING_CHAT","SETTINGS_INTEGRATIONS"];function N(e){let{className:s}=e,{status:n,isLoading:N,error:w,isTourActive:y,tourStepContext:C,getTrackProgress:T,startTourFromStep:A,dismissGuide:k,resetProgress:I}=(0,v.Mw)(),[M,J]=(0,t.useState)(!0),[S,E]=(0,t.useState)("");if((null==n?void 0:n.dismissedGuide)||(null==n?void 0:n.hasCompletedSetup))return null;if(N)return(0,a.jsxs)(u.Zp,{className:(0,b.cn)("animate-pulse",s),children:[(0,a.jsxs)(u.aR,{children:[(0,a.jsx)("div",{className:"h-5 w-32 bg-muted rounded"}),(0,a.jsx)("div",{className:"h-3 w-48 bg-muted rounded mt-2"})]}),(0,a.jsx)(u.Wu,{children:(0,a.jsx)("div",{className:"h-2 w-full bg-muted rounded"})})]});if(w)return null;let O=f.reduce((e,s)=>{var n;let a=(0,v.ue)(s,C);if(0===a.length)return e;let t=T(s);return{completed:e.completed+(null!=(n=null==t?void 0:t.completed)?n:0),total:e.total+a.length}},{completed:0,total:0}),_={...O,percentage:O.total>0?Math.round(O.completed/O.total*100):0};return(0,a.jsxs)(u.Zp,{className:(0,b.cn)("relative overflow-hidden rounded-lg",s),"data-tour":"setup-guide",children:[(0,a.jsx)(j,{shineColor:["#6366f1","#a855f7","#ec4899"],borderWidth:1,duration:10}),(0,a.jsxs)(g.Nt,{open:M,onOpenChange:J,children:[(0,a.jsx)(u.aR,{className:"p-4!",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(u.ZB,{className:"text-base font-semibold",children:"Setup Guide"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-0.5",children:"Get started with a quick tour of the platform"}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-1.5",children:[(0,a.jsxs)("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:[_.completed," / ",_.total," completed"]}),(0,a.jsx)(m.k,{value:_.percentage,className:"h-1.5 w-24",indicatorClassName:100===_.percentage?"bg-green-500":void 0})]})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsxs)(p.rI,{children:[(0,a.jsx)(p.ty,{asChild:!0,children:(0,a.jsx)(h.$,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:(0,a.jsx)(r.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(p.SQ,{align:"end",children:[(0,a.jsxs)(p._2,{onClick:()=>I(),children:[(0,a.jsx)(l.A,{className:"h-4 w-4 mr-2"}),"Reset progress"]}),(0,a.jsxs)(p._2,{onClick:()=>k(),children:[(0,a.jsx)(i.A,{className:"h-4 w-4 mr-2"}),"Dismiss guide"]})]})]}),(0,a.jsx)(g.R6,{asChild:!0,children:(0,a.jsx)(h.$,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:M?(0,a.jsx)(d.A,{className:"h-4 w-4"}):(0,a.jsx)(c.A,{className:"h-4 w-4"})})})]})]})}),(0,a.jsx)(g.Ke,{children:(0,a.jsx)(u.Wu,{className:"p-0!",children:(0,a.jsx)(x.nD,{type:"single",collapsible:!0,value:S,onValueChange:E,className:"w-full",children:f.map(e=>{var s,n;let t=T(e),r=v.Wo[e],l=null!=(s=null==t?void 0:t.finished)&&s,i=null!=(n=null==t?void 0:t.completed)?n:0,d=(0,v.ue)(e,C);return 0===d.length?null:(0,a.jsxs)(x.As,{value:e,className:"border-b-0 border-t",children:[(0,a.jsx)(x.$m,{className:"py-3 px-3 hover:no-underline bg-muted/50 rounded-none items-center",children:(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsx)("div",{className:"text-left",children:(0,a.jsx)("p",{className:(0,b.cn)("text-sm font-medium",l&&"text-muted-foreground"),children:r.title})})})}),(0,a.jsx)(x.ub,{className:"border-t p-0",children:(0,a.jsx)("div",{className:"flex flex-col gap-1",children:d.map((s,n)=>{let t=n<i,r=n===i,l=n>i;return(0,a.jsxs)("button",{onClick:()=>A(e,n),disabled:y||l,className:(0,b.cn)("w-full text-left px-4 py-2.5 text-sm transition-colors","flex items-center gap-3 rounded-none",l?"opacity-40":"hover:bg-primary/10 cursor-pointer",r&&!l&&"text-primary font-medium"),children:[(0,a.jsx)("div",{className:(0,b.cn)("flex size-5 items-center justify-center rounded-full shrink-0",t?"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-400":r?"border-2 border-primary border-dashed":"border-2 border-muted-foreground/20 border-dashed"),children:t&&(0,a.jsx)(o.A,{className:"h-3 w-3"})}),(0,a.jsx)("span",{className:(0,b.cn)(t&&"text-muted-foreground"),children:s.title})]},s.id)})})})]},e)})})})})]})]})}}},e=>{e.O(0,[6143,541,5004,277,547,5707,2110,8234,2619,4001,3409,1204,9360,1163,550,1130,7117,2303,4419,7770,9829,2305,5181,5909,5657,4802,4729,2816,1279,1382,4098,8441,1255,7358],()=>e(e.s=79679)),_N_E=e.O()}]);