"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4098],{30224:(e,n,l)=>{l.d(n,{AB:()=>d,J5:()=>c,Qp:()=>r,tH:()=>m,tJ:()=>u,w1:()=>o});var a=l(95155);l(12115);var s=l(32467),i=l(27937),t=l(64936);function r(e){let{...n}=e;return(0,a.jsx)("nav",{"aria-label":"breadcrumb","data-slot":"breadcrumb",...n})}function d(e){let{className:n,...l}=e;return(0,a.jsx)("ol",{"data-slot":"breadcrumb-list",className:(0,t.cn)("text-muted-foreground flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-2.5",n),...l})}function c(e){let{className:n,...l}=e;return(0,a.jsx)("li",{"data-slot":"breadcrumb-item",className:(0,t.cn)("inline-flex items-center gap-1.5",n),...l})}function o(e){let{asChild:n,className:l,...i}=e,r=n?s.DX:"a";return(0,a.jsx)(r,{"data-slot":"breadcrumb-link",className:(0,t.cn)("hover:text-foreground transition-colors",l),...i})}function u(e){let{className:n,...l}=e;return(0,a.jsx)("span",{"data-slot":"breadcrumb-page",role:"link","aria-disabled":"true","aria-current":"page",className:(0,t.cn)("text-foreground font-normal",n),...l})}function m(e){let{children:n,className:l,...s}=e;return(0,a.jsx)("li",{"data-slot":"breadcrumb-separator",role:"presentation","aria-hidden":"true",className:(0,t.cn)("[&>svg]:size-3.5",l),...s,children:null!=n?n:(0,a.jsx)(i.A,{})})}},67803:(e,n,l)=>{l.d(n,{S:()=>K});var a=l(95155),s=l(12115),i=l(62816),t=l(71011),r=l(67812),d=l(16485),c=l(95664),o=l(42024),u=l(61362),m=l(17787),x=l(49027),h=l(27587),f=l(47650),g=l(77382),v=l(83209),j=l(27346),p=l(25016);let b=(0,g.A)(),N=(0,s.createContext)({columns:[],data:[],activeCardId:null,overColumnId:null}),w=e=>{let{id:n,children:l,className:s}=e,{isOver:i,setNodeRef:t}=(0,m.zM)({id:n});return(0,a.jsx)("div",{className:(0,p.cn)("flex h-full w-full flex-col overflow-hidden rounded-md text-xs ring-2 transition-all",i?"ring-primary":"ring-transparent",s),ref:t,style:{maxHeight:"100%"},children:l})},y=e=>{let{id:n,name:l,children:i,className:t,disabled:r=!1}=e,{attributes:d,listeners:c,setNodeRef:o,transition:u,transform:m,isDragging:f}=(0,x.gl)({id:n,disabled:r}),{activeCardId:g}=(0,s.useContext)(N),j={transition:u,transform:h.Ks.Transform.toString(m)},w=r?{}:{...c,...d};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:j,...w,ref:o,children:(0,a.jsx)(v.Zp,{className:(0,p.cn)("gap-4 rounded-md p-3 shadow-sm",!r&&"cursor-grab",r&&"cursor-default",f&&"pointer-events-none cursor-grabbing opacity-30",t),children:null!=i?i:(0,a.jsx)("p",{className:"m-0 font-medium text-sm",children:l})})}),g===n&&!r&&(0,a.jsx)(b.In,{children:(0,a.jsx)(v.Zp,{className:(0,p.cn)("cursor-grab gap-4 rounded-md p-3 shadow-sm ring-2 ring-primary",f&&"cursor-grabbing",t),children:null!=i?i:(0,a.jsx)("p",{className:"m-0 font-medium text-sm",children:l})})})]})},A=e=>{let{children:n,className:l,...i}=e,{data:t,activeCardId:r,overColumnId:d}=(0,s.useContext)(N),c=t.filter(e=>e.column===i.id),o=c.map(e=>e.id);return(0,a.jsxs)(j.F,{className:"h-full overflow-hidden",children:[(0,a.jsx)(x.gB,{items:o,children:(0,a.jsxs)("div",{className:(0,p.cn)("flex size-full flex-col space-y-2 p-2",l),...i,children:[c.map(n),!1]})}),(0,a.jsx)(j.$,{orientation:"vertical"})]})},D=e=>{let{className:n,...l}=e;return(0,a.jsx)("div",{className:(0,p.cn)("m-0 p-2 font-semibold text-sm",n),...l})},C=e=>{let{children:n,onDragStart:l,onDragEnd:i,onDragOver:t,className:r,columns:d,data:c,onDataChange:o,...u}=e,[h,g]=(0,s.useState)(null),[v,j]=(0,s.useState)(null),w=(0,m.FR)((0,m.MS)(m.cA),(0,m.MS)(m.IG),(0,m.MS)(m.uN));return(0,a.jsx)(N.Provider,{value:{columns:d,data:c,activeCardId:h,overColumnId:v},children:(0,a.jsxs)(m.Mp,{accessibility:{announcements:{onDragStart(e){var n;let{active:l}=e,{name:a,column:s}=null!=(n=c.find(e=>e.id===l.id))?n:{};return'Picked up the card "'.concat(a,'" from the "').concat(s,'" column')},onDragOver(e){var n,l;let{active:a,over:s}=e,{name:i}=null!=(l=c.find(e=>e.id===a.id))?l:{},t=null==(n=d.find(e=>e.id===(null==s?void 0:s.id)))?void 0:n.name;return'Dragged the card "'.concat(i,'" over the "').concat(t,'" column')},onDragEnd(e){var n,l;let{active:a,over:s}=e,{name:i}=null!=(l=c.find(e=>e.id===a.id))?l:{},t=null==(n=d.find(e=>e.id===(null==s?void 0:s.id)))?void 0:n.name;return'Dropped the card "'.concat(i,'" into the "').concat(t,'" column')},onDragCancel(e){var n;let{active:l}=e,{name:a}=null!=(n=c.find(e=>e.id===l.id))?n:{};return'Cancelled dragging the card "'.concat(a,'"')}}},collisionDetection:m.fp,onDragCancel:()=>{g(null),j(null)},onDragEnd:e=>{g(null),j(null),null==i||i(e);let{active:n,over:l}=e;if(!l||n.id===l.id)return;let a=[...c],s=a.findIndex(e=>e.id===n.id),t=a.findIndex(e=>e.id===l.id);a=(0,x.be)(a,s,t),null==o||o(a)},onDragOver:e=>{var n,l;let{active:a,over:s}=e;if(!s)return void j(null);let i=c.find(e=>e.id===a.id),r=c.find(e=>e.id===s.id);if(!i)return void j(null);let u=i.column,m=(null==r?void 0:r.column)||(null==(n=d.find(e=>e.id===s.id))?void 0:n.id)||(null==(l=d[0])?void 0:l.id);if(m&&j(m),u!==m){let e=[...c],n=e.findIndex(e=>e.id===a.id),l=e.findIndex(e=>e.id===s.id);e[n].column=m,e=(0,x.be)(e,n,l),null==o||o(e)}null==t||t(e)},onDragStart:e=>{c.find(n=>n.id===e.active.id)&&g(e.active.id),null==l||l(e)},sensors:w,...u,children:[(0,a.jsx)("div",{className:"h-full w-full overflow-x-auto overflow-y-hidden scroll-smooth",children:(0,a.jsx)("div",{className:(0,p.cn)("flex h-full flex-row gap-2 min-h-0","2xl:grid 2xl:size-full 2xl:auto-cols-fr 2xl:grid-flow-col 2xl:gap-4 2xl:overflow-x-visible",r),children:d.map(e=>(0,a.jsx)("div",{className:(0,p.cn)("flex-[0_0_100%]","md:flex-[0_0_calc(50%-0.25rem)]","lg:flex-[0_0_calc(33.333%-0.333rem)]","xl:flex-[0_0_calc(25%-0.375rem)]","2xl:flex-none 2xl:min-w-0","h-full min-h-0"),children:n(e)},e.id))})}),(0,f.createPortal)((0,a.jsx)(m.Hd,{children:(0,a.jsx)(b.Out,{})}),document.body)]})})},k=[{id:"booked",name:"Booked",icon:d.A,color:"text-blue-600",statuses:["pending","assigned"],targetStatus:"assigned"},{id:"shooting",name:"Shooting",icon:c.A,color:"text-purple-600",statuses:["in_progress"],targetStatus:"in_progress"},{id:"editing",name:"Editing",icon:o.A,color:"text-orange-600",statuses:["editing"],targetStatus:"editing"},{id:"delivered",name:"Delivered",icon:u.A,color:"text-green-600",statuses:["delivered"],targetStatus:"delivered"}];function S(e){let{jobs:n,technicians:l,messages:i=[],onViewRankings:d,onChangeTechnician:c,onJobStatusChange:o,onJobClick:u,disableContextMenu:m=!1,canChangeJobStatus:x}=e,h=(0,s.useMemo)(()=>n.map(e=>{let n=k.find(n=>n.statuses.includes(e.status));return{id:e.id,name:e.propertyAddress,column:(null==n?void 0:n.id)||"booked",job:e}}),[n]);return(0,a.jsx)("div",{className:"h-full w-full overflow-x-auto overflow-y-hidden",children:(0,a.jsx)(C,{columns:k,data:h,onDataChange:e=>{o&&e.forEach(e=>{let n=h.find(n=>n.id===e.id);if(n&&n.column!==e.column){let n=k.find(n=>n.id===e.column);if(n)if("booked"===n.id){if("pending"===e.job.status||"assigned"===e.job.status)return;o(e.job.id,"assigned")}else o(e.job.id,n.targetStatus)}})},className:"h-full",children:e=>{let n=e.icon,s=h.filter(n=>n.column===e.id);return(0,a.jsxs)(w,{id:e.id,className:"relative shrink-0 md:max-w-[350px] shadow-none",children:[(0,a.jsxs)(D,{className:"flex items-center justify-between p-4 border-b shrink-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n,{className:"h-4 w-4 ".concat(e.color)}),(0,a.jsx)("span",{className:"text-sm font-semibold",children:e.name})]}),(0,a.jsx)(r.E,{variant:"secondary",className:"text-xs",children:s.length})]}),0===s.length?(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center overflow-hidden",children:(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground text-sm px-4",children:"No jobs in this column"})}):(0,a.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:(0,a.jsx)(A,{id:e.id,className:"h-full",children:e=>{let n=e.job.assignedTechnicianId?l.find(n=>n.id===e.job.assignedTechnicianId):void 0,s=!x||x(e.job);return(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)(y,{id:e.id,name:e.name,column:e.column,className:"p-0 w-full border-none shadow-none hover:translate-y-[-2px] transition-transform duration-200",disabled:!s,children:(0,a.jsx)(t.R,{job:e.job,technician:n,messages:i,onViewRankings:("pending"===e.job.status||"assigned"===e.job.status)&&d?()=>d(e.job):void 0,onChangeTechnician:c?()=>c(e.job):void 0,onJobClick:u?()=>u(e.job):void 0,disableContextMenu:m})})},e.id)}})})]},e.id)}})})}var I=l(60890),T=l(54255),_=l(26397),P=l(6132),M=l(56154),E=l(26983),F=l(21873),R=l(29633),J=l(86651),z=l(66955),O=l(93341),V=l(96633),Z=l(97003),$=l(33884),B=l(33789),H=l(47507),L=l(71163),U=l(82180),q=l(73344),G=l(64936);function K(e){let{jobs:n,technicians:l,messages:t=[],onViewRankings:o,onChangeTechnician:u,onJobStatusChange:m,onJobClick:x,disableContextMenu:h=!1,activeView:f="all",canChangeJobStatus:g}=e,[v,j]=(0,s.useState)(""),[p,b]=(0,s.useState)("all"),[N,w]=(0,s.useState)("date-desc"),y=(0,s.useMemo)(()=>{let e=[...n];if(v){let n=v.toLowerCase();e=e.filter(e=>"".concat(e.propertyAddress," ").concat(e.clientName," ").concat(e.scheduledDate," ").concat(e.orderNumber).toLowerCase().includes(n))}if("all"!==p&&(e=["urgent","rush","standard"].includes(p)?e.filter(e=>e.priority===p):e.filter(e=>e.status===p),v)){let n=v.toLowerCase();e=e.filter(e=>"".concat(e.propertyAddress," ").concat(e.clientName," ").concat(e.scheduledDate," ").concat(e.orderNumber).toLowerCase().includes(n))}return e.sort((e,n)=>{switch(N){case"date-asc":if(e.scheduledDate&&n.scheduledDate)return new Date(e.scheduledDate).getTime()-new Date(n.scheduledDate).getTime();if(e.scheduledDate)return -1;if(n.scheduledDate)return 1;return 0;case"date-desc":if(e.scheduledDate&&n.scheduledDate)return new Date(n.scheduledDate).getTime()-new Date(e.scheduledDate).getTime();if(e.scheduledDate)return -1;if(n.scheduledDate)return 1;return 0;case"client-asc":if(e.clientName&&n.clientName)return e.clientName.localeCompare(n.clientName);return 0;case"client-desc":if(e.clientName&&n.clientName)return n.clientName.localeCompare(e.clientName);return 0;case"priority":let l={urgent:3,rush:2,standard:1},a=l[e.priority]||0;return(l[n.priority]||0)-a;default:return 0}}),e},[n,v,p,N]);return(0,a.jsx)("main",{className:(0,G.cn)("container relative mx-auto","kanban"===f?"h-full flex flex-col":""),"data-tour":"jobs-view",children:(0,a.jsx)("article",{className:(0,G.cn)("flex flex-col gap-2xl md:gap-3xl px-md","kanban"===f?"flex-1 min-h-0":""),children:(0,a.jsxs)("div",{className:(0,G.cn)("@container w-full mt-md mb-md","kanban"===f?"flex flex-col flex-1 min-h-0":""),children:[(0,a.jsx)(q.H2,{className:"text-4xl mb-xs","data-tour":"jobs-header",children:"Jobs"}),"all"===f&&(0,a.jsx)("div",{className:"mt-0",children:(0,a.jsx)(i.rw,{items:n,searchPlaceholder:"Search by address, client, Order #...",searchFields:e=>"".concat(e.propertyAddress," ").concat(e.clientName," ").concat(e.scheduledDate," ").concat(e.orderNumber),filterOptions:[{label:"Urgent",value:"urgent"},{label:"Rush",value:"rush"},{label:"Standard",value:"standard"},{label:"Pending",value:"pending"},{label:"Assigned",value:"assigned"},{label:"In Progress",value:"in_progress"},{label:"Delivered",value:"delivered"}],onFilterChange:e=>"all"===e?n:["urgent","rush","standard"].includes(e)?n.filter(n=>n.priority===e):n.filter(n=>n.status===e),renderItem:(e,n,s)=>{let t=e.assignedTechnicianId?l.find(n=>n.id===e.assignedTechnicianId):void 0;return(0,a.jsx)(i.oe,{job:e,technician:t,onViewRankings:"pending"===e.status&&o?()=>o(e):void 0,onClick:x?()=>x(e):void 0},e.id)},renderTableRow:e=>{let n=e.assignedTechnicianId?l.find(n=>n.id===e.assignedTechnicianId):void 0,s=(e=>{switch(e){case"urgent":return{variant:"destructive",label:"Urgent",icon:P.A};case"rush":return{variant:"secondary",label:"Rush",icon:M.A};default:return{variant:"outline",label:"Standard",icon:E.A}}})(e.priority),i=(e=>{switch(e){case"pending":return{variant:"outline",label:"Pending"};case"assigned":return{variant:"secondary",label:"Assigned"};case"in_progress":return{variant:"default",label:"In Progress"};case"editing":return{variant:"secondary",label:"Editing"};case"delivered":return{variant:"default",label:"Delivered"};case"cancelled":return{variant:"destructive",label:"Cancelled"};default:return{variant:"outline",label:e}}})(e.status),t=s.icon;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(V.nA,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2 min-w-[200px]",children:[(0,a.jsx)(F.A,{className:"h-4 w-4 text-muted-foreground shrink-0"}),(0,a.jsxs)(U.m_,{children:[(0,a.jsx)(U.k$,{asChild:!0,children:(0,a.jsx)("span",{className:"truncate max-w-[180px]",children:e.propertyAddress})}),(0,a.jsx)(U.ZI,{children:(0,a.jsx)(q.P,{className:"max-w-xs",children:e.propertyAddress})})]})]})}),(0,a.jsx)(V.nA,{children:(0,a.jsx)("span",{className:"text-sm",children:e.clientName})}),(0,a.jsx)(V.nA,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-sm",children:(0,L.GP)(new Date(e.scheduledDate),"MMM d, yyyy")}),e.scheduledTime&&(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:e.scheduledTime})]})]})}),(0,a.jsx)(V.nA,{children:(0,a.jsx)("div",{className:"flex items-center gap-1 flex-wrap",children:e.mediaType.map(e=>{let n=(e=>{switch(e){case"photo":default:return c.A;case"video":return I.A;case"aerial":return T.A;case"twilight":return _.A}})(e);return(0,a.jsxs)(U.m_,{children:[(0,a.jsx)(U.k$,{asChild:!0,children:(0,a.jsx)("div",{className:"p-1.5 rounded bg-muted",children:(0,a.jsx)(n,{className:"h-3 w-3"})})}),(0,a.jsx)(U.ZI,{children:(0,a.jsx)(q.P,{className:"capitalize",children:e})})]},e)})})}),(0,a.jsx)(V.nA,{children:(0,a.jsxs)(r.E,{variant:s.variant,className:"gap-1",children:[(0,a.jsx)(t,{className:"h-3 w-3"}),s.label]})}),(0,a.jsx)(V.nA,{children:(0,a.jsx)(r.E,{variant:i.variant,children:i.label})}),(0,a.jsx)(V.nA,{children:n?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)($.eu,{className:"h-6 w-6",children:[(0,a.jsx)($.BK,{src:n.avatar,alt:n.name}),(0,a.jsx)($.q5,{children:n.name.split(" ").map(e=>e[0]).join("")})]}),(0,a.jsx)("span",{className:"text-sm",children:n.name})]}):(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Unassigned"})}),(0,a.jsx)(V.nA,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:["pending"===e.status&&o&&(0,a.jsx)(Z.$,{variant:"outline",size:"sm",onClick:()=>o(e),children:"Find Technician"}),x&&(0,a.jsx)(Z.$,{variant:"ghost",size:"sm",onClick:()=>x(e),children:"View"})]})})]})},emptyMessage:"No jobs found",emptyIcon:R.A,emptyTitle:"No jobs found",emptyDescription:"Jobs will appear here once created",itemsPerPage:12})}),"kanban"===f&&(0,a.jsx)("div",{className:"flex-1 flex flex-col min-h-0",children:(0,a.jsxs)("div",{className:"flex flex-col flex-1 min-h-0 space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-3 shrink-0",children:[(0,a.jsxs)("div",{className:"relative flex-1 min-w-0",children:[(0,a.jsx)(J.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground/60"}),(0,a.jsx)(B.p,{type:"text",variant:"muted",placeholder:"Search by address, client, Order #...",value:v,onChange:e=>j(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(H.l6,{value:p,onValueChange:b,children:[(0,a.jsxs)(H.bq,{variant:"muted",className:"w-10 md:w-[180px] shrink-0 [&>svg:last-child]:hidden md:[&>svg:last-child]:block",children:[(0,a.jsx)(z.A,{className:"h-4 w-4 md:mr-2"}),(0,a.jsx)(H.yv,{placeholder:"All Items",className:"hidden md:inline"})]}),(0,a.jsxs)(H.gC,{children:[(0,a.jsx)(H.eb,{value:"all",children:"All Items"}),(0,a.jsx)(H.eb,{value:"urgent",children:"Urgent"}),(0,a.jsx)(H.eb,{value:"rush",children:"Rush"}),(0,a.jsx)(H.eb,{value:"standard",children:"Standard"}),(0,a.jsx)(H.eb,{value:"pending",children:"Pending"}),(0,a.jsx)(H.eb,{value:"assigned",children:"Assigned"}),(0,a.jsx)(H.eb,{value:"in_progress",children:"In Progress"}),(0,a.jsx)(H.eb,{value:"delivered",children:"Delivered"})]})]}),(0,a.jsxs)(H.l6,{value:N,onValueChange:w,children:[(0,a.jsxs)(H.bq,{variant:"muted",className:"w-10 md:w-[180px] shrink-0 [&>svg:last-child]:hidden md:[&>svg:last-child]:block",children:[(0,a.jsx)(O.A,{className:"h-4 w-4 md:mr-2"}),(0,a.jsx)(H.yv,{placeholder:"Sort by",className:"hidden md:inline"})]}),(0,a.jsxs)(H.gC,{children:[(0,a.jsx)(H.eb,{value:"date-desc",children:"Date (Newest First)"}),(0,a.jsx)(H.eb,{value:"date-asc",children:"Date (Oldest First)"}),(0,a.jsx)(H.eb,{value:"client-asc",children:"Client (A-Z)"}),(0,a.jsx)(H.eb,{value:"client-desc",children:"Client (Z-A)"}),(0,a.jsx)(H.eb,{value:"priority",children:"Priority"})]})]})]}),(0,a.jsx)("div",{className:"flex-1 min-h-0",children:(0,a.jsx)(S,{jobs:y,technicians:l,messages:t,onViewRankings:o,onChangeTechnician:u,onJobStatusChange:m,onJobClick:x,disableContextMenu:h,canChangeJobStatus:g})})]})})]})})})}}}]);