"use strict";exports.id=4815,exports.ids=[4815],exports.modules={14160:(a,b,c)=>{c.d(b,{S:()=>W});var d=c(21124),e=c(38301),f=c(21411),g=c(14293),h=c(22544),i=c(72567),j=c(36734),k=c(80646),l=c(59268),m=c(10366),n=c(99615),o=c(22023);c(23312);var p=c(48736),q=c(45119),r=c(72966),s=c(15514);let t=(0,p.A)(),u=(0,e.createContext)({columns:[],data:[],activeCardId:null,overColumnId:null}),v=({id:a,children:b,className:c})=>{let{isOver:e,setNodeRef:f}=(0,m.zM)({id:a});return(0,d.jsx)("div",{className:(0,s.cn)("flex h-full w-full flex-col overflow-hidden rounded-md text-xs ring-2 transition-all",e?"ring-primary":"ring-transparent",c),ref:f,style:{maxHeight:"100%"},children:b})},w=({id:a,name:b,children:c,className:f,disabled:g=!1})=>{let{attributes:h,listeners:i,setNodeRef:j,transition:k,transform:l,isDragging:m}=(0,n.gl)({id:a,disabled:g}),{activeCardId:p}=(0,e.useContext)(u),r={transition:k,transform:o.Ks.Transform.toString(l)},v=g?{}:{...i,...h};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{style:r,...v,ref:j,children:(0,d.jsx)(q.Zp,{className:(0,s.cn)("gap-4 rounded-md p-3 shadow-sm",!g&&"cursor-grab",g&&"cursor-default",m&&"pointer-events-none cursor-grabbing opacity-30",f),children:c??(0,d.jsx)("p",{className:"m-0 font-medium text-sm",children:b})})}),p===a&&!g&&(0,d.jsx)(t.In,{children:(0,d.jsx)(q.Zp,{className:(0,s.cn)("cursor-grab gap-4 rounded-md p-3 shadow-sm ring-2 ring-primary",m&&"cursor-grabbing",f),children:c??(0,d.jsx)("p",{className:"m-0 font-medium text-sm",children:b})})})]})},x=({children:a,className:b,...c})=>{let{data:f,activeCardId:g,overColumnId:h}=(0,e.useContext)(u),i=f.filter(a=>a.column===c.id),j=i.map(a=>a.id);return(0,d.jsxs)(r.F,{className:"h-full overflow-hidden",children:[(0,d.jsx)(n.gB,{items:j,children:(0,d.jsxs)("div",{className:(0,s.cn)("flex size-full flex-col space-y-2 p-2",b),...c,children:[i.map(a),!1]})}),(0,d.jsx)(r.$,{orientation:"vertical"})]})},y=({className:a,...b})=>(0,d.jsx)("div",{className:(0,s.cn)("m-0 p-2 font-semibold text-sm",a),...b}),z=({children:a,onDragStart:b,onDragEnd:c,onDragOver:f,className:g,columns:h,data:i,onDataChange:j,...k})=>{let[l,o]=(0,e.useState)(null),[p,q]=(0,e.useState)(null),r=(0,m.FR)((0,m.MS)(m.cA),(0,m.MS)(m.IG),(0,m.MS)(m.uN));return(0,d.jsx)(u.Provider,{value:{columns:h,data:i,activeCardId:l,overColumnId:p},children:(0,d.jsxs)(m.Mp,{accessibility:{announcements:{onDragStart({active:a}){let{name:b,column:c}=i.find(b=>b.id===a.id)??{};return`Picked up the card "${b}" from the "${c}" column`},onDragOver({active:a,over:b}){let{name:c}=i.find(b=>b.id===a.id)??{},d=h.find(a=>a.id===b?.id)?.name;return`Dragged the card "${c}" over the "${d}" column`},onDragEnd({active:a,over:b}){let{name:c}=i.find(b=>b.id===a.id)??{},d=h.find(a=>a.id===b?.id)?.name;return`Dropped the card "${c}" into the "${d}" column`},onDragCancel({active:a}){let{name:b}=i.find(b=>b.id===a.id)??{};return`Cancelled dragging the card "${b}"`}}},collisionDetection:m.fp,onDragCancel:()=>{o(null),q(null)},onDragEnd:a=>{o(null),q(null),c?.(a);let{active:b,over:d}=a;if(!d||b.id===d.id)return;let e=[...i],f=e.findIndex(a=>a.id===b.id),g=e.findIndex(a=>a.id===d.id);e=(0,n.be)(e,f,g),j?.(e)},onDragOver:a=>{let{active:b,over:c}=a;if(!c)return void q(null);let d=i.find(a=>a.id===b.id),e=i.find(a=>a.id===c.id);if(!d)return void q(null);let g=d.column,k=e?.column||h.find(a=>a.id===c.id)?.id||h[0]?.id;if(k&&q(k),g!==k){let a=[...i],d=a.findIndex(a=>a.id===b.id),e=a.findIndex(a=>a.id===c.id);a[d].column=k,a=(0,n.be)(a,d,e),j?.(a)}f?.(a)},onDragStart:a=>{i.find(b=>b.id===a.active.id)&&o(a.active.id),b?.(a)},sensors:r,...k,children:[(0,d.jsx)("div",{className:"h-full w-full overflow-x-auto overflow-y-hidden scroll-smooth",children:(0,d.jsx)("div",{className:(0,s.cn)("flex h-full flex-row gap-2 min-h-0","2xl:grid 2xl:size-full 2xl:auto-cols-fr 2xl:grid-flow-col 2xl:gap-4 2xl:overflow-x-visible",g),children:h.map(b=>(0,d.jsx)("div",{className:(0,s.cn)("flex-[0_0_100%]","md:flex-[0_0_calc(50%-0.25rem)]","lg:flex-[0_0_calc(33.333%-0.333rem)]","xl:flex-[0_0_calc(25%-0.375rem)]","2xl:flex-none 2xl:min-w-0","h-full min-h-0"),children:a(b)},b.id))})}),!1]})})},A=[{id:"booked",name:"Booked",icon:i.A,color:"text-blue-600",statuses:["pending","assigned"],targetStatus:"assigned"},{id:"shooting",name:"Shooting",icon:j.A,color:"text-purple-600",statuses:["in_progress"],targetStatus:"in_progress"},{id:"editing",name:"Editing",icon:k.A,color:"text-orange-600",statuses:["editing"],targetStatus:"editing"},{id:"delivered",name:"Delivered",icon:l.A,color:"text-green-600",statuses:["delivered"],targetStatus:"delivered"}];function B({jobs:a,technicians:b,messages:c=[],onViewRankings:f,onChangeTechnician:i,onJobStatusChange:j,onJobClick:k,disableContextMenu:l=!1,canChangeJobStatus:m}){let n=(0,e.useMemo)(()=>a.map(a=>{let b=A.find(b=>b.statuses.includes(a.status));return{id:a.id,name:a.propertyAddress,column:b?.id||"booked",job:a}}),[a]);return(0,d.jsx)("div",{className:"h-full w-full overflow-x-auto overflow-y-hidden",children:(0,d.jsx)(z,{columns:A,data:n,onDataChange:a=>{j&&a.forEach(a=>{let b=n.find(b=>b.id===a.id);if(b&&b.column!==a.column){let b=A.find(b=>b.id===a.column);if(b)if("booked"===b.id){if("pending"===a.job.status||"assigned"===a.job.status)return;j(a.job.id,"assigned")}else j(a.job.id,b.targetStatus)}})},className:"h-full",children:a=>{let e=a.icon,j=n.filter(b=>b.column===a.id);return(0,d.jsxs)(v,{id:a.id,className:"relative shrink-0 md:max-w-[350px] shadow-none",children:[(0,d.jsxs)(y,{className:"flex items-center justify-between p-4 border-b shrink-0",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(e,{className:`h-4 w-4 ${a.color}`}),(0,d.jsx)("span",{className:"text-sm font-semibold",children:a.name})]}),(0,d.jsx)(h.E,{variant:"secondary",className:"text-xs",children:j.length})]}),0===j.length?(0,d.jsx)("div",{className:"flex-1 flex items-center justify-center overflow-hidden",children:(0,d.jsx)("div",{className:"text-center py-8 text-muted-foreground text-sm px-4",children:"No jobs in this column"})}):(0,d.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:(0,d.jsx)(x,{id:a.id,className:"h-full",children:a=>{let e=a.job.assignedTechnicianId?b.find(b=>b.id===a.job.assignedTechnicianId):void 0,h=!m||m(a.job);return(0,d.jsx)("div",{className:"w-full",children:(0,d.jsx)(w,{id:a.id,name:a.name,column:a.column,className:"p-0 w-full border-none shadow-none hover:translate-y-[-2px] transition-transform duration-200",disabled:!h,children:(0,d.jsx)(g.R,{job:a.job,technician:e,messages:c,onViewRankings:("pending"===a.job.status||"assigned"===a.job.status)&&f?()=>f(a.job):void 0,onChangeTechnician:i?()=>i(a.job):void 0,onJobClick:k?()=>k(a.job):void 0,disableContextMenu:l})})},a.id)}})})]},a.id)}})})}var C=c(87278),D=c(52647),E=c(39983),F=c(18310),G=c(46422),H=c(15303),I=c(69957),J=c(11489),K=c(88285),L=c(81925),M=c(86773),N=c(17677),O=c(19217),P=c(674),Q=c(7629),R=c(28241),S=c(31115),T=c(36736),U=c(99042),V=c(67442);function W({jobs:a,technicians:b,messages:c=[],onViewRankings:g,onChangeTechnician:k,onJobStatusChange:l,onJobClick:m,disableContextMenu:n=!1,activeView:o="all",canChangeJobStatus:p}){let[q,r]=(0,e.useState)(""),[s,t]=(0,e.useState)("all"),[u,v]=(0,e.useState)("date-desc"),w=(0,e.useMemo)(()=>{let b=[...a];if(q){let a=q.toLowerCase();b=b.filter(b=>`${b.propertyAddress} ${b.clientName} ${b.scheduledDate} ${b.orderNumber}`.toLowerCase().includes(a))}if("all"!==s&&(b=["urgent","rush","standard"].includes(s)?b.filter(a=>a.priority===s):b.filter(a=>a.status===s),q)){let a=q.toLowerCase();b=b.filter(b=>`${b.propertyAddress} ${b.clientName} ${b.scheduledDate} ${b.orderNumber}`.toLowerCase().includes(a))}return b.sort((a,b)=>{switch(u){case"date-asc":if(a.scheduledDate&&b.scheduledDate)return new Date(a.scheduledDate).getTime()-new Date(b.scheduledDate).getTime();if(a.scheduledDate)return -1;if(b.scheduledDate)return 1;return 0;case"date-desc":if(a.scheduledDate&&b.scheduledDate)return new Date(b.scheduledDate).getTime()-new Date(a.scheduledDate).getTime();if(a.scheduledDate)return -1;if(b.scheduledDate)return 1;return 0;case"client-asc":if(a.clientName&&b.clientName)return a.clientName.localeCompare(b.clientName);return 0;case"client-desc":if(a.clientName&&b.clientName)return b.clientName.localeCompare(a.clientName);return 0;case"priority":let c={urgent:3,rush:2,standard:1},d=c[a.priority]||0;return(c[b.priority]||0)-d;default:return 0}}),b},[a,q,s,u]);return(0,d.jsx)("main",{className:(0,V.cn)("container relative mx-auto","kanban"===o?"h-full flex flex-col":""),"data-tour":"jobs-view",children:(0,d.jsx)("article",{className:(0,V.cn)("flex flex-col gap-2xl md:gap-3xl px-md","kanban"===o?"flex-1 min-h-0":""),children:(0,d.jsxs)("div",{className:(0,V.cn)("@container w-full mt-md mb-md","kanban"===o?"flex flex-col flex-1 min-h-0":""),children:[(0,d.jsx)(U.H2,{className:"text-4xl mb-xs","data-tour":"jobs-header",children:"Jobs"}),"all"===o&&(0,d.jsx)("div",{className:"mt-0",children:(0,d.jsx)(f.rw,{items:a,searchPlaceholder:"Search by address, client, Order #...",searchFields:a=>`${a.propertyAddress} ${a.clientName} ${a.scheduledDate} ${a.orderNumber}`,filterOptions:[{label:"Urgent",value:"urgent"},{label:"Rush",value:"rush"},{label:"Standard",value:"standard"},{label:"Pending",value:"pending"},{label:"Assigned",value:"assigned"},{label:"In Progress",value:"in_progress"},{label:"Delivered",value:"delivered"}],onFilterChange:b=>"all"===b?a:["urgent","rush","standard"].includes(b)?a.filter(a=>a.priority===b):a.filter(a=>a.status===b),renderItem:(a,c,e)=>{let h=a.assignedTechnicianId?b.find(b=>b.id===a.assignedTechnicianId):void 0;return(0,d.jsx)(f.oe,{job:a,technician:h,onViewRankings:"pending"===a.status&&g?()=>g(a):void 0,onClick:m?()=>m(a):void 0},a.id)},renderTableRow:a=>{let c=a.assignedTechnicianId?b.find(b=>b.id===a.assignedTechnicianId):void 0,e=(a=>{switch(a){case"urgent":return{variant:"destructive",label:"Urgent",icon:F.A};case"rush":return{variant:"secondary",label:"Rush",icon:G.A};default:return{variant:"outline",label:"Standard",icon:H.A}}})(a.priority),f=(a=>{switch(a){case"pending":return{variant:"outline",label:"Pending"};case"assigned":return{variant:"secondary",label:"Assigned"};case"in_progress":return{variant:"default",label:"In Progress"};case"editing":return{variant:"secondary",label:"Editing"};case"delivered":return{variant:"default",label:"Delivered"};case"cancelled":return{variant:"destructive",label:"Cancelled"};default:return{variant:"outline",label:a}}})(a.status),k=e.icon;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(N.nA,{children:(0,d.jsxs)("div",{className:"flex items-center gap-2 min-w-[200px]",children:[(0,d.jsx)(I.A,{className:"h-4 w-4 text-muted-foreground shrink-0"}),(0,d.jsxs)(T.m_,{children:[(0,d.jsx)(T.k$,{asChild:!0,children:(0,d.jsx)("span",{className:"truncate max-w-[180px]",children:a.propertyAddress})}),(0,d.jsx)(T.ZI,{children:(0,d.jsx)(U.P,{className:"max-w-xs",children:a.propertyAddress})})]})]})}),(0,d.jsx)(N.nA,{children:(0,d.jsx)("span",{className:"text-sm",children:a.clientName})}),(0,d.jsx)(N.nA,{children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(i.A,{className:"h-4 w-4 text-muted-foreground"}),(0,d.jsxs)("div",{className:"flex flex-col",children:[(0,d.jsx)("span",{className:"text-sm",children:(0,S.GP)(new Date(a.scheduledDate),"MMM d, yyyy")}),a.scheduledTime&&(0,d.jsx)("span",{className:"text-xs text-muted-foreground",children:a.scheduledTime})]})]})}),(0,d.jsx)(N.nA,{children:(0,d.jsx)("div",{className:"flex items-center gap-1 flex-wrap",children:a.mediaType.map(a=>{let b=(a=>{switch(a){case"photo":default:return j.A;case"video":return C.A;case"aerial":return D.A;case"twilight":return E.A}})(a);return(0,d.jsxs)(T.m_,{children:[(0,d.jsx)(T.k$,{asChild:!0,children:(0,d.jsx)("div",{className:"p-1.5 rounded bg-muted",children:(0,d.jsx)(b,{className:"h-3 w-3"})})}),(0,d.jsx)(T.ZI,{children:(0,d.jsx)(U.P,{className:"capitalize",children:a})})]},a)})})}),(0,d.jsx)(N.nA,{children:(0,d.jsxs)(h.E,{variant:e.variant,className:"gap-1",children:[(0,d.jsx)(k,{className:"h-3 w-3"}),e.label]})}),(0,d.jsx)(N.nA,{children:(0,d.jsx)(h.E,{variant:f.variant,children:f.label})}),(0,d.jsx)(N.nA,{children:c?(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsxs)(P.eu,{className:"h-6 w-6",children:[(0,d.jsx)(P.BK,{src:c.avatar,alt:c.name}),(0,d.jsx)(P.q5,{children:c.name.split(" ").map(a=>a[0]).join("")})]}),(0,d.jsx)("span",{className:"text-sm",children:c.name})]}):(0,d.jsx)("span",{className:"text-sm text-muted-foreground",children:"Unassigned"})}),(0,d.jsx)(N.nA,{className:"text-right",children:(0,d.jsxs)("div",{className:"flex items-center justify-end gap-2",children:["pending"===a.status&&g&&(0,d.jsx)(O.$,{variant:"outline",size:"sm",onClick:()=>g(a),children:"Find Technician"}),m&&(0,d.jsx)(O.$,{variant:"ghost",size:"sm",onClick:()=>m(a),children:"View"})]})})]})},emptyMessage:"No jobs found",emptyIcon:J.A,emptyTitle:"No jobs found",emptyDescription:"Jobs will appear here once created",itemsPerPage:12})}),"kanban"===o&&(0,d.jsx)("div",{className:"flex-1 flex flex-col min-h-0",children:(0,d.jsxs)("div",{className:"flex flex-col flex-1 min-h-0 space-y-4",children:[(0,d.jsxs)("div",{className:"flex gap-3 shrink-0",children:[(0,d.jsxs)("div",{className:"relative flex-1 min-w-0",children:[(0,d.jsx)(K.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground/60"}),(0,d.jsx)(Q.p,{type:"text",variant:"muted",placeholder:"Search by address, client, Order #...",value:q,onChange:a=>r(a.target.value),className:"pl-10"})]}),(0,d.jsxs)(R.l6,{value:s,onValueChange:t,children:[(0,d.jsxs)(R.bq,{variant:"muted",className:"w-10 md:w-[180px] shrink-0 [&>svg:last-child]:hidden md:[&>svg:last-child]:block",children:[(0,d.jsx)(L.A,{className:"h-4 w-4 md:mr-2"}),(0,d.jsx)(R.yv,{placeholder:"All Items",className:"hidden md:inline"})]}),(0,d.jsxs)(R.gC,{children:[(0,d.jsx)(R.eb,{value:"all",children:"All Items"}),(0,d.jsx)(R.eb,{value:"urgent",children:"Urgent"}),(0,d.jsx)(R.eb,{value:"rush",children:"Rush"}),(0,d.jsx)(R.eb,{value:"standard",children:"Standard"}),(0,d.jsx)(R.eb,{value:"pending",children:"Pending"}),(0,d.jsx)(R.eb,{value:"assigned",children:"Assigned"}),(0,d.jsx)(R.eb,{value:"in_progress",children:"In Progress"}),(0,d.jsx)(R.eb,{value:"delivered",children:"Delivered"})]})]}),(0,d.jsxs)(R.l6,{value:u,onValueChange:v,children:[(0,d.jsxs)(R.bq,{variant:"muted",className:"w-10 md:w-[180px] shrink-0 [&>svg:last-child]:hidden md:[&>svg:last-child]:block",children:[(0,d.jsx)(M.A,{className:"h-4 w-4 md:mr-2"}),(0,d.jsx)(R.yv,{placeholder:"Sort by",className:"hidden md:inline"})]}),(0,d.jsxs)(R.gC,{children:[(0,d.jsx)(R.eb,{value:"date-desc",children:"Date (Newest First)"}),(0,d.jsx)(R.eb,{value:"date-asc",children:"Date (Oldest First)"}),(0,d.jsx)(R.eb,{value:"client-asc",children:"Client (A-Z)"}),(0,d.jsx)(R.eb,{value:"client-desc",children:"Client (Z-A)"}),(0,d.jsx)(R.eb,{value:"priority",children:"Priority"})]})]})]}),(0,d.jsx)("div",{className:"flex-1 min-h-0",children:(0,d.jsx)(B,{jobs:w,technicians:b,messages:c,onViewRankings:g,onChangeTechnician:k,onJobStatusChange:l,onJobClick:m,disableContextMenu:n,canChangeJobStatus:p})})]})})]})})})}},20670:(a,b,c)=>{c.d(b,{AB:()=>i,J5:()=>j,Qp:()=>h,tH:()=>m,tJ:()=>l,w1:()=>k});var d=c(21124);c(38301);var e=c(96425),f=c(59405),g=c(67442);function h({...a}){return(0,d.jsx)("nav",{"aria-label":"breadcrumb","data-slot":"breadcrumb",...a})}function i({className:a,...b}){return(0,d.jsx)("ol",{"data-slot":"breadcrumb-list",className:(0,g.cn)("text-muted-foreground flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-2.5",a),...b})}function j({className:a,...b}){return(0,d.jsx)("li",{"data-slot":"breadcrumb-item",className:(0,g.cn)("inline-flex items-center gap-1.5",a),...b})}function k({asChild:a,className:b,...c}){let f=a?e.DX:"a";return(0,d.jsx)(f,{"data-slot":"breadcrumb-link",className:(0,g.cn)("hover:text-foreground transition-colors",b),...c})}function l({className:a,...b}){return(0,d.jsx)("span",{"data-slot":"breadcrumb-page",role:"link","aria-disabled":"true","aria-current":"page",className:(0,g.cn)("text-foreground font-normal",a),...b})}function m({children:a,className:b,...c}){return(0,d.jsx)("li",{"data-slot":"breadcrumb-separator",role:"presentation","aria-hidden":"true",className:(0,g.cn)("[&>svg]:size-3.5",b),...c,children:a??(0,d.jsx)(f.A,{})})}}};