exports.id=3277,exports.ids=[3277],exports.modules={674:(a,b,c)=>{"use strict";c.d(b,{BK:()=>h,eu:()=>g,q5:()=>i});var d=c(21124);c(38301);var e=c(60190),f=c(67442);function g({className:a,...b}){return(0,d.jsx)(e.bL,{"data-slot":"avatar",className:(0,f.cn)("relative flex size-10 shrink-0 overflow-hidden rounded-full",a),...b})}function h({className:a,...b}){return(0,d.jsx)(e._V,{"data-slot":"avatar-image",className:(0,f.cn)("aspect-square size-full",a),...b})}function i({className:a,...b}){return(0,d.jsx)(e.H4,{"data-slot":"avatar-fallback",className:(0,f.cn)("bg-muted flex size-full items-center justify-center rounded-full",a),...b})}},1323:(a,b,c)=>{"use strict";c.d(b,{q:()=>u});var d=c(21124),e=c(38301),f=c(19217),g=c(7629),h=c(33305),i=c(72966),j=c(28241),k=c(22544),l=c(36736),m=c(78660),n=c(79944),o=c(78583),p=c(47089),q=c(88285),r=c(81925),s=c(86773),t=c(99042);function u({title:a,items:b,renderItem:c,searchPlaceholder:u="Search...",filterOptions:v=[],onFilterChange:w,searchFields:x,emptyMessage:y="No items found",triggerButton:z,itemCount:A,horizontalLayout:B=!1,itemWidth:C="320px",showInlineExpandButton:D=!1,open:E,onOpenChange:F,onNavigateToFullView:G,useGridLayout:H=!0,renderHeaderActions:I,onScrollControlsReady:J,nestedView:K,nestedViewTitle:L,onNestedViewClose:M,onShowNestedView:N}){let[O,P]=(0,e.useState)(!1),[Q,R]=(0,e.useState)(""),[S,T]=(0,e.useState)("all"),[U,V]=(0,e.useState)("date-desc"),[W,X]=(0,e.useState)(!1),[Y,Z]=(0,e.useState)(null),[$,_]=(0,e.useState)(""),aa=(0,e.useRef)(null);(0,e.useCallback)((a,b)=>{Z(a),_(b),X(!0)},[]);let ab=void 0!==E,ac=ab?E:O,ad=a=>{a||(X(!1),Z(null),_("")),ab&&F?F(a):P(a)},ae=[...b];Q&&x&&(ae=ae.filter(a=>x(a).toLowerCase().includes(Q.toLowerCase()))),"all"!==S&&w&&(ae=w(S),Q&&x&&(ae=ae.filter(a=>x(a).toLowerCase().includes(Q.toLowerCase())))),ae.sort((a,b)=>{switch(U){case"date-asc":if(a.scheduledDate&&b.scheduledDate)return new Date(a.scheduledDate).getTime()-new Date(b.scheduledDate).getTime();if(a.scheduledDate)return -1;if(b.scheduledDate)return 1;return 0;case"date-desc":if(a.scheduledDate&&b.scheduledDate)return new Date(b.scheduledDate).getTime()-new Date(a.scheduledDate).getTime();if(a.scheduledDate)return -1;if(b.scheduledDate)return 1;return 0;case"client-asc":if(a.clientName&&b.clientName)return a.clientName.localeCompare(b.clientName);return 0;case"client-desc":if(a.clientName&&b.clientName)return b.clientName.localeCompare(a.clientName);return 0;case"priority":let c={urgent:3,rush:2,standard:1},d=c[a.priority]||0;return(c[b.priority]||0)-d;default:return 0}});let af=A&&!ac?ae.slice(0,A):ae,ag=!!A&&ae.length>A,ah=(0,e.useCallback)(()=>{aa.current&&aa.current.scrollBy({left:-400,behavior:"smooth"})},[]),ai=(0,e.useCallback)(()=>{aa.current&&aa.current.scrollBy({left:400,behavior:"smooth"})},[]);return(0,d.jsxs)(d.Fragment,{children:[B&&I&&af.length>0&&(0,d.jsx)("div",{className:"mb-4",children:I(ah,ai)}),B?(0,d.jsx)("div",{className:"w-full",children:(0,d.jsx)("div",{ref:aa,className:"w-full overflow-x-auto scrollbar-hide",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:(0,d.jsx)("div",{className:"flex gap-4",style:{width:"max-content"},children:af.map((a,b)=>(0,d.jsx)("div",{style:{minWidth:C,maxWidth:C,width:C},className:"flex grow",children:c(a,b)},b))})})}):(0,d.jsx)("div",{className:"space-y-4",children:af.map((a,b)=>(0,d.jsx)("div",{children:c(a,b)},b))}),D&&ag&&(0,d.jsx)("div",{className:"text-center pt-4 pb-2",children:(0,d.jsxs)(f.$,{variant:"outline",onClick:()=>ad(!0),className:"gap-2 w-full sm:w-auto",children:[(0,d.jsx)(m.A,{className:"h-4 w-4"}),"View All ",b.length," Items"]})}),z&&(0,d.jsx)("div",{onClick:()=>ad(!0),children:z}),(0,d.jsx)(h.lG,{open:ac,onOpenChange:ad,children:(0,d.jsxs)(h.Cf,{className:"min-w-7xl max-w-[95vw] max-h-[90vh] [&>button]:hidden",children:[(0,d.jsx)(h.c7,{children:(0,d.jsxs)(h.L3,{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[W&&K&&(0,d.jsx)(f.$,{variant:"ghost",size:"icon",onClick:()=>{X(!1),M&&M()},className:"h-8 w-8","aria-label":"Go back",children:(0,d.jsx)(n.A,{className:"h-4 w-4"})}),(0,d.jsx)("span",{children:W&&$?$:a})]}),(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[!W&&(0,d.jsxs)(k.E,{variant:"secondary",children:[ae.length," items"]}),!W&&G&&(0,d.jsxs)(l.m_,{children:[(0,d.jsx)(l.k$,{asChild:!0,children:(0,d.jsx)(f.$,{variant:"ghost",size:"icon",onClick:()=>{ad(!1),G()},className:"h-8 w-8",children:(0,d.jsx)(o.A,{className:"h-4 w-4"})})}),(0,d.jsx)(l.ZI,{side:"top",children:(0,d.jsx)(t.P,{children:"Go to Jobs"})})]}),(0,d.jsx)(f.$,{variant:"ghost",size:"icon",onClick:()=>{W?(X(!1),M&&M()):ad(!1)},className:"h-8 w-8",children:(0,d.jsx)(p.A,{className:"h-4 w-4"})})]})]})}),W&&Y?Y:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex gap-3 pb-4 border-b",children:[(0,d.jsxs)("div",{className:"relative flex-1",children:[(0,d.jsx)(q.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground/60"}),(0,d.jsx)(g.p,{placeholder:u,value:Q,onChange:a=>R(a.target.value),className:"pl-10"}),Q&&(0,d.jsx)(f.$,{variant:"ghost",size:"sm",onClick:()=>R(""),className:"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 p-0",children:(0,d.jsx)(p.A,{className:"h-4 w-4"})})]}),v.length>0&&(0,d.jsxs)(j.l6,{value:S,onValueChange:T,children:[(0,d.jsxs)(j.bq,{className:"w-[200px]",children:[(0,d.jsx)(r.A,{className:"h-4 w-4 mr-2"}),(0,d.jsx)(j.yv,{placeholder:"Filter by..."})]}),(0,d.jsxs)(j.gC,{children:[(0,d.jsx)(j.eb,{value:"all",children:"All Items"}),v.map(a=>(0,d.jsx)(j.eb,{value:a.value,children:a.label},a.value))]})]}),(0,d.jsxs)(j.l6,{value:U,onValueChange:V,children:[(0,d.jsxs)(j.bq,{className:"w-[180px]",children:[(0,d.jsx)(s.A,{className:"h-4 w-4 mr-2"}),(0,d.jsx)(j.yv,{placeholder:"Sort by"})]}),(0,d.jsxs)(j.gC,{children:[(0,d.jsx)(j.eb,{value:"date-asc",children:"Date (Earliest)"}),(0,d.jsx)(j.eb,{value:"date-desc",children:"Date (Latest)"}),(0,d.jsx)(j.eb,{value:"client-asc",children:"Client (A-Z)"}),(0,d.jsx)(j.eb,{value:"client-desc",children:"Client (Z-A)"}),(0,d.jsx)(j.eb,{value:"priority",children:"Priority"})]})]})]}),H?(0,d.jsx)(i.F,{className:"max-h-[calc(90vh-200px)]",children:(0,d.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pr-4 items-stretch",children:ae.length>0?ae.map((a,b)=>(0,d.jsx)("div",{className:"h-full flex",children:(0,d.jsx)("div",{className:"w-full",children:c(a,b)})},b)):(0,d.jsx)("div",{className:"col-span-full text-center py-12 text-muted-foreground",children:y})})}):B?(0,d.jsx)("div",{className:"w-full overflow-x-auto",children:(0,d.jsx)("div",{className:"flex gap-4 pb-4",style:{width:"max-content"},children:ae.length>0?ae.map((a,b)=>(0,d.jsx)("div",{style:{minWidth:C,maxWidth:C,width:C},className:"flex-shrink-0",children:c(a,b)},b)):(0,d.jsx)("div",{className:"text-center py-12 text-muted-foreground w-full",children:y})})}):(0,d.jsx)(i.F,{className:"max-h-[calc(90vh-200px)]",children:(0,d.jsx)("div",{className:"space-y-4 pr-4",children:ae.length>0?ae.map((a,b)=>(0,d.jsx)("div",{children:c(a,b)},b)):(0,d.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:y})})})]})]})})]})}},6544:(a,b,c)=>{"use strict";c.d(b,{FT:()=>h,q1:()=>i});var d=c(38301),e=c(33201),f=c(60127);function g(a,b){if(!b)return"NONE";let c=a.find(a=>a.orgId===b);if(!c)return"NONE";if("PERSONAL"===c.organization?.type)return"PERSONAL_OWNER";let d=c.orgRole||c.role;return d||"NONE"}function h(a){let{user:b,memberships:c,activeOrganizationId:h}=(0,e.A)();return(0,d.useMemo)(()=>{let d=g(c,h),e=b?.id??null;return(0,f.Ib)(d,a,e)},[b?.id,c,h,a?.projectManagerId,a?.technicianId,a?.editorId])}function i(){let{user:a,memberships:b,activeOrganizationId:c}=(0,e.A)();return(0,d.useMemo)(()=>{let d=g(b,c);return{canManageCustomers:(0,f.lN)(d),canViewCustomers:(0,f.BO)(d),canCreateOrder:(0,f.$K)(d),isAdmin:(0,f.qc)(d),effectiveRole:d,userId:a?.id??null}},[a?.id,b,c])}},7629:(a,b,c)=>{"use strict";c.d(b,{p:()=>h});var d=c(21124);c(38301);var e=c(26691),f=c(67442);let g=(0,e.F)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground flex w-full min-w-0 rounded-md transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"border-input bg-input-background dark:bg-input/30 border px-3 py-1",outline:"border-2 bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 border px-3 py-1",ghost:"border-0 bg-transparent hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 px-3 py-1",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 px-3 py-1",muted:"border-transparent bg-muted text-foreground hover:bg-muted/80 px-3 py-1",flat:"border-0 bg-transparent px-3 py-1"},size:{default:"h-9 text-base md:text-sm",sm:"h-8 text-sm px-2.5 py-1",lg:"h-10 text-base px-4 py-2"}},defaultVariants:{variant:"default",size:"default"}});function h({className:a,type:b,variant:c,size:e,...h}){return(0,d.jsx)("input",{type:b,"data-slot":"input",className:(0,f.cn)(g({variant:c,size:e}),a),...h})}},8044:(a,b,c)=>{"use strict";c.d(b,{w:()=>g});var d=c(21124);c(38301);var e=c(83973),f=c(15514);function g({className:a,orientation:b="horizontal",decorative:c=!0,...g}){return(0,d.jsx)(e.b,{"data-slot":"separator",decorative:c,orientation:b,className:(0,f.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",a),...g})}},9188:(a,b,c)=>{"use strict";c.d(b,{Hr:()=>n,Ht:()=>o,I:()=>l,M5:()=>t,SQ:()=>k,_2:()=>m,lp:()=>p,lv:()=>r,mB:()=>q,nV:()=>s,rI:()=>i,ty:()=>j});var d=c(21124);c(38301);var e=c(66848),f=c(90133),g=c(59405),h=c(67442);function i({...a}){return(0,d.jsx)(e.bL,{"data-slot":"dropdown-menu",...a})}function j({...a}){return(0,d.jsx)(e.l9,{"data-slot":"dropdown-menu-trigger",...a})}function k({className:a,sideOffset:b=4,...c}){return(0,d.jsx)(e.ZL,{children:(0,d.jsx)(e.UC,{"data-slot":"dropdown-menu-content",sideOffset:b,className:(0,h.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),...c})})}function l({...a}){return(0,d.jsx)(e.YJ,{"data-slot":"dropdown-menu-group",...a})}function m({className:a,inset:b,variant:c="default",...f}){return(0,d.jsx)(e.q7,{"data-slot":"dropdown-menu-item","data-inset":b,"data-variant":c,className:(0,h.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-pointer items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-disabled:pointer-events-none data-disabled:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),...f})}function n({...a}){return(0,d.jsx)(e.z6,{"data-slot":"dropdown-menu-radio-group",...a})}function o({className:a,children:b,...c}){return(0,d.jsxs)(e.hN,{"data-slot":"dropdown-menu-radio-item",className:(0,h.cn)("focus:bg-accent focus:text-accent-foreground relative flex cursor-pointer items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-disabled:pointer-events-none data-disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),...c,children:[(0,d.jsx)("span",{className:"pointer-events-none absolute left-2 flex size-3.5 items-center justify-center",children:(0,d.jsx)(e.VF,{children:(0,d.jsx)(f.A,{className:"size-2 fill-current"})})}),b]})}function p({className:a,inset:b,...c}){return(0,d.jsx)(e.JU,{"data-slot":"dropdown-menu-label","data-inset":b,className:(0,h.cn)("px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",a),...c})}function q({className:a,...b}){return(0,d.jsx)(e.wv,{"data-slot":"dropdown-menu-separator",className:(0,h.cn)("bg-border -mx-1 my-1 h-px",a),...b})}function r({...a}){return(0,d.jsx)(e.Pb,{"data-slot":"dropdown-menu-sub",...a})}function s({className:a,inset:b,children:c,...f}){return(0,d.jsxs)(e.ZP,{"data-slot":"dropdown-menu-sub-trigger","data-inset":b,className:(0,h.cn)("focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-pointer items-center rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8",a),...f,children:[c,(0,d.jsx)(g.A,{className:"ml-auto size-4"})]})}function t({className:a,...b}){return(0,d.jsx)(e.G5,{"data-slot":"dropdown-menu-sub-content",className:(0,h.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg",a),...b})}},11534:(a,b,c)=>{"use strict";c.d(b,{XY:()=>z,I2:()=>y,pp:()=>r,oX:()=>f,De:()=>o});var d=c(21124),e=c(38301);function f(a){let[b,c]=(0,e.useState)(!1),{src:f,alt:g,style:h,className:i,...j}=a;return b?(0,d.jsx)("div",{className:`inline-block bg-gray-100 text-center align-middle ${i??""}`,style:h,children:(0,d.jsx)("div",{className:"flex items-center justify-center size-full",children:(0,d.jsx)("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODgiIGhlaWdodD0iODgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBvcGFjaXR5PSIuMyIgZmlsbD0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIzLjciPjxyZWN0IHg9IjE2IiB5PSIxNiIgd2lkdGg9IjU2IiBoZWlnaHQ9IjU2IiByeD0iNiIvPjxwYXRoIGQ9Im0xNiA1OCAxNi0xOCAzMiAzMiIvPjxjaXJjbGUgY3g9IjUzIiBjeT0iMzUiIHI9IjciLz48L3N2Zz4KCg==",alt:"Error loading image",...j,"data-original-url":f})})}):(0,d.jsx)("img",{src:f,alt:g,className:i,style:h,...j,onError:()=>{c(!0)}})}var g=c(22544),h=c(36734),i=c(87278),j=c(52647),k=c(39983),l=c(69957),m=c(72567),n=c(15303);function o({job:a,onClick:b}){return(0,d.jsx)("div",{className:"p-4 border-2 border-border rounded-xl hover:border-primary/50 transition-colors cursor-pointer",onClick:b,children:(0,d.jsxs)("div",{className:"flex gap-4",children:[(0,d.jsx)("div",{className:"w-32 h-32 rounded-lg overflow-hidden flex-shrink-0",children:a.propertyImage&&"delivered"===a.status?(0,d.jsx)(f,{src:a.propertyImage,alt:a.propertyAddress,className:"size-full object-cover"}):(0,d.jsx)("div",{className:(a=>{switch(a){case"pending":return"bg-gradient-to-br from-status-pending/20 via-status-pending/15 to-status-pending/10";case"assigned":return"bg-gradient-to-br from-status-assigned/20 via-status-assigned/15 to-status-assigned/10";case"in_progress":return"bg-gradient-to-br from-status-in-progress/20 via-status-in-progress/15 to-status-in-progress/10";case"editing":return"bg-gradient-to-br from-status-editing/20 via-status-editing/15 to-status-editing/10";case"delivered":return"bg-gradient-to-br from-status-delivered/20 via-status-delivered/15 to-status-delivered/10";default:return"bg-gradient-to-br from-status-cancelled/20 via-status-cancelled/15 to-status-cancelled/10"}})(a.status)+" size-full"})}),(0,d.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,d.jsxs)("div",{className:"flex items-start justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"text-sm text-muted-foreground",children:a.clientName}),(0,d.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,d.jsx)(l.A,{className:"h-4 w-4 text-muted-foreground/60"}),(0,d.jsx)("span",{className:"text-sm",children:a.propertyAddress})]})]}),(0,d.jsx)(g.E,{variant:"urgent"===a.priority?"destructive":"rush"===a.priority?"default":"secondary",children:a.priority})]}),(0,d.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(m.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{children:a.scheduledDate})]}),(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(n.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{children:a.scheduledTime})]})]}),(0,d.jsx)("div",{className:"flex gap-2",children:a.mediaType.map(a=>{let b=(a=>{switch(a){case"photo":default:return h.A;case"video":return i.A;case"aerial":return j.A;case"twilight":return k.A}})(a);return(0,d.jsxs)("div",{className:"flex items-center gap-1.5 px-2.5 py-1 bg-muted rounded-lg text-xs",children:[(0,d.jsx)(b,{className:"h-3.5 w-3.5 text-muted-foreground"}),(0,d.jsx)("span",{className:"text-foreground/90 capitalize",children:a})]},a)})}),a.requirements&&(0,d.jsx)("div",{className:"text-xs text-muted-foreground mt-2 line-clamp-2",children:a.requirements})]})]})})}var p=c(19217),q=c(99042);function r({icon:a,title:b,description:c,action:e}){return(0,d.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,d.jsx)(a,{className:"size-16 mx-auto mb-4 text-muted-foreground/40"}),(0,d.jsx)(q.H3,{className:"text-xl text-foreground mb-2",children:b}),(0,d.jsx)(q.QX,{className:"mb-6",children:c}),e&&(0,d.jsx)(p.$,{onClick:e.onClick,children:e.label})]})}var s=c(45119),t=c(674),u=c(33847),v=c(30733),w=c(10578),x=c(71563);function y({company:a,onApply:b,isApplied:c=!1,showApplyButton:f=!0}){let[h,i]=(0,e.useState)(!1),[j,k]=(0,e.useState)("");return(0,d.jsx)(s.Zp,{className:"p-6",children:(0,d.jsxs)("div",{className:"flex gap-6",children:[(0,d.jsxs)(t.eu,{className:"size-20 border-2 border-border",children:[(0,d.jsx)(t.BK,{src:a.avatar}),(0,d.jsx)(t.q5,{className:"bg-primary text-primary-foreground",children:a.name.split(" ").map(a=>a[0]).join("")})]}),(0,d.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)(q.H3,{className:"text-lg mb-1",children:a.name}),(0,d.jsx)(q.Oc,{className:"text-muted-foreground",children:a.description})]}),(0,d.jsxs)("div",{className:"flex items-center gap-4",children:[a.rating&&(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(0,d.jsx)(v.A,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,d.jsx)(q.Oc,{children:a.rating}),(0,d.jsxs)(q.QX,{children:["(",a.reviewCount,")"]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(0,d.jsx)(w.A,{className:"h-4 w-4 text-muted-foreground/60"}),(0,d.jsxs)(q.Oc,{children:[a.technicianCount," technicians"]})]})]}),(0,d.jsx)("div",{className:"flex flex-wrap gap-2",children:a.services?.map(a=>(0,d.jsx)(g.E,{variant:"outline",children:a},a))}),f&&(h?(0,d.jsxs)("div",{className:"space-y-3 pt-3 border-t",children:[(0,d.jsx)(u.T,{value:j,onChange:a=>k(a.target.value),placeholder:"Tell them why you'd like to join...",rows:3}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(p.$,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),(0,d.jsxs)(p.$,{onClick:()=>{b&&(b(a.id,j),i(!1),k(""))},children:[(0,d.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Send Application"]})]})]}):(0,d.jsx)(p.$,{onClick:()=>i(!0),disabled:c,children:c?"Application Pending":"Apply to Join"}))]})]})})}function z({application:a}){return(0,d.jsx)("div",{className:"p-4 bg-status-pending/10 border-2 border-status-pending/30 rounded-xl",children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"text-sm font-medium",children:a.companyName}),(0,d.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["Applied ",a.appliedAt.toLocaleDateString()]}),a.message&&(0,d.jsxs)("div",{className:"text-xs text-muted-foreground mt-2 line-clamp-2",children:['"',a.message,'"']})]}),(0,d.jsx)(g.E,{variant:"outline",className:"pending"===a.status?"border-status-pending text-status-pending":"approved"===a.status?"border-status-delivered text-status-delivered":"border-destructive text-destructive",children:"pending"===a.status?"Pending Review":a.status})]})})}c(27176),c(96341)},14293:(a,b,c)=>{"use strict";c.d(b,{R:()=>L});var d=c(21124),e=c(38301),f=c(674),g=c(22544),h=c(19217),i=c(31115),j=c(36734),k=c(87278),l=c(52647),m=c(54684),n=c(97851),o=c(99329),p=c(18310),q=c(46422),r=c(15303),s=c(38882),t=c(72567),u=c(30733),v=c(9188),w=c(15044),x=c(67442);function y(a){return(0,d.jsx)(w.bL,{"data-slot":"context-menu",...a})}function z({...a}){return(0,d.jsx)(w.l9,{"data-slot":"context-menu-trigger",...a})}function A({className:a,...b}){return(0,d.jsx)(w.ZL,{children:(0,d.jsx)(w.UC,{"data-slot":"context-menu-content",className:(0,x.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",a),...b})})}function B({className:a,inset:b,variant:c="default",...e}){return(0,d.jsx)(w.q7,{"data-slot":"context-menu-item","data-inset":b,"data-variant":c,className:(0,x.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-pointer items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),...e})}var C=c(77278);function D({...a}){return(0,d.jsx)(C.bL,{"data-slot":"hover-card",...a})}function E({...a}){return(0,d.jsx)(C.l9,{"data-slot":"hover-card-trigger",...a})}function F({className:a,align:b="center",sideOffset:c=4,...e}){return(0,d.jsx)(C.ZL,{"data-slot":"hover-card-portal",children:(0,d.jsx)(C.UC,{"data-slot":"hover-card-content",align:b,sideOffset:c,className:(0,x.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-64 origin-(--radix-hover-card-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",a),...e})})}var G=c(36736),H=c(15514),I=c(99042),J=c(6544);let K=({status:a,jobId:b,className:c})=>{let f=(a=>{switch(a){case"pending":return{base:"bg-amber-100 dark:bg-amber-900",primary:"bg-amber-400/60",secondary:"bg-orange-400/50",accent:"bg-yellow-300/45",highlight:"bg-amber-500/40"};case"assigned":return{base:"bg-blue-100 dark:bg-blue-900",primary:"bg-blue-400/60",secondary:"bg-indigo-400/50",accent:"bg-cyan-300/45",highlight:"bg-blue-500/40"};case"in_progress":return{base:"bg-violet-100 dark:bg-violet-900",primary:"bg-violet-400/60",secondary:"bg-purple-400/50",accent:"bg-fuchsia-300/45",highlight:"bg-indigo-500/40"};case"editing":return{base:"bg-pink-100 dark:bg-pink-900",primary:"bg-pink-400/60",secondary:"bg-rose-400/50",accent:"bg-fuchsia-300/45",highlight:"bg-pink-500/40"};case"delivered":return{base:"bg-emerald-100 dark:bg-emerald-900",primary:"bg-emerald-400/60",secondary:"bg-teal-400/50",accent:"bg-green-300/45",highlight:"bg-emerald-500/40"};default:return{base:"bg-slate-200 dark:bg-slate-800",primary:"bg-slate-400/60",secondary:"bg-gray-400/50",accent:"bg-zinc-300/45",highlight:"bg-slate-500/40"}}})(a),g=(0,e.useMemo)(()=>{let a=(a=>{let b=0;for(let c=0;c<a.length;c++){let d=a.charCodeAt(c);b=(b<<5)-b+d,b&=b}return()=>(b=((b=Math.imul((b=Math.imul(b^b>>>16,0x85ebca6b))^b>>>13,0xc2b2ae35))^b>>>16)>>>0)%1e3/1e3})(b),c=()=>({top:`${-30+80*a()}%`,left:`${-30+80*a()}%`});return{blob1:{...c(),width:`${65+15*a()}%`,height:`${65+15*a()}%`},blob2:{...c(),width:`${60+15*a()}%`,height:`${60+15*a()}%`},blob3:{...c(),width:`${40+15*a()}%`,height:`${40+15*a()}%`},blob4:{...c(),width:`${25+12*a()}%`,height:`${25+12*a()}%`},rotation1:60*a(),rotation2:60*a(),rotation3:60*a(),rotation4:60*a()}},[b]);return(0,d.jsxs)("div",{className:(0,H.cn)("absolute inset-0 overflow-hidden",f.base,c),children:[(0,d.jsx)("div",{className:(0,H.cn)("absolute rounded-full blur-3xl",f.primary),style:{...g.blob1,transform:`rotate(${g.rotation1}deg)`}}),(0,d.jsx)("div",{className:(0,H.cn)("absolute rounded-full blur-3xl",f.secondary),style:{...g.blob2,transform:`rotate(${g.rotation2}deg)`}}),(0,d.jsx)("div",{className:(0,H.cn)("absolute rounded-full blur-2xl",f.accent),style:{...g.blob3,transform:`rotate(${g.rotation3}deg)`}}),(0,d.jsx)("div",{className:(0,H.cn)("absolute rounded-full blur-2xl",f.highlight),style:{...g.blob4,transform:`rotate(${g.rotation4}deg)`}})]})};function L({job:a,technician:b,messages:c=[],onClick:w,onViewRankings:x,onJobClick:C,onChangeTechnician:L,disableContextMenu:M=!1}){let[N,O]=(0,e.useState)(!1),[P,Q]=(0,e.useState)(!1),R={projectManagerId:a.projectManagerId??void 0,technicianId:a.assignedTechnicianId??void 0,editorId:a.editorId??void 0},{canAssignTechnician:S}=(0,J.FT)(R),T=(a=>{let b=a=>(a.replace("_","-"),""),c=a=>{let c=b(a);return c?`${c}20`:""};switch(a){case"delivered":return{label:"Delivered",dotColor:b("delivered")||"oklch(0.60 0.15 142)",bgColor:c("delivered")||"oklch(0.60 0.15 142 / 0.2)",textColor:b("delivered")||"oklch(0.60 0.15 142)"};case"in_progress":return{label:"In Progress",dotColor:b("in-progress")||"oklch(0.60 0.15 280)",bgColor:c("in-progress")||"oklch(0.60 0.15 280 / 0.2)",textColor:b("in-progress")||"oklch(0.60 0.15 280)"};case"pending":case"assigned":return{label:"pending"===a?"Pending":"Assigned",dotColor:b(a)||"oklch(0.55 0.15 250)",bgColor:c(a)||"oklch(0.55 0.15 250 / 0.2)",textColor:b(a)||"oklch(0.55 0.15 250)"};case"editing":return{label:"Editing",dotColor:b("editing")||"oklch(0.65 0.15 60)",bgColor:c("editing")||"oklch(0.65 0.15 60 / 0.2)",textColor:b("editing")||"oklch(0.65 0.15 60)"};default:return{label:"Pending",dotColor:b("pending")||"oklch(0.65 0.15 60)",bgColor:c("pending")||"oklch(0.65 0.15 60 / 0.2)",textColor:b("pending")||"oklch(0.65 0.15 60)"}}})(a.status),U=(a=>{switch(a){case"urgent":return{priority:"urgent",icon:p.A,label:"Urgent"};case"rush":return{priority:"rush",icon:q.A,label:"Rush"};default:return{priority:"standard",icon:r.A,label:"Standard"}}})(a.priority),V=U.icon,W=(()=>{try{let[b,c,d]=a.scheduledDate.split("-").map(Number),e=new Date(b,c-1,d);return(0,i.GP)(e,"dd MMM yyyy")}catch(b){return a.scheduledDate}})(),X=b?[b]:[];c.filter(b=>b.jobId===a.id).length;let Y=(0,d.jsxs)("div",{className:(0,H.cn)("group relative w-full max-w-full rounded-md overflow-hidden transition-all duration-200",w||C?"cursor-pointer":""),onClick:a=>{let b=a.target;!(b.closest('[role="menu"]')||b.closest('[data-dropdown-trigger="true"]')||b.closest("[data-radix-dropdown-menu-trigger]")||b.closest("[data-radix-dropdown-menu-content]")||b.closest('button[aria-haspopup="menu"]')||b.closest("button[data-radix-dropdown-menu-trigger]")||b.closest("[data-radix-context-menu-trigger]")||b.closest("[data-radix-context-menu-content]")||b.closest('[data-slot="dropdown-menu-trigger"]')||b.closest('[data-slot="dropdown-menu-content"]')||b.closest('[data-slot="context-menu-trigger"]')||b.closest('[data-slot="context-menu-content"]'))&&(w?w():C&&C())},children:[(0,d.jsx)(K,{status:a.status,jobId:a.id,className:"group-hover:scale-[1.02] transition-transform duration-300 pointer-events-none"}),(0,d.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-card/80 via-card/60 to-card/90"}),(0,d.jsxs)("div",{className:"relative z-10 flex flex-col justify-between h-full p-3 space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,d.jsxs)("div",{className:"flex items-center gap-1.5 flex-wrap",children:[(0,d.jsxs)(g.E,{variant:"secondary",className:(0,H.cn)("flex items-center gap-1 rounded-full backdrop-blur-md! bg-card/60! group-hover:bg-card! transition-colors duration-200","urgent"===U.priority&&"bg-priority-urgent/10 text-priority-urgent","rush"===U.priority&&"bg-priority-rush/10 text-priority-rush","standard"===U.priority&&"bg-priority-standard/10 text-priority-standard"),children:[(0,d.jsx)(V,{className:(0,H.cn)("size-3","urgent"===U.priority&&"text-priority-urgent","rush"===U.priority&&"text-priority-rush","standard"===U.priority&&"text-priority-standard")}),(0,d.jsx)("span",{className:(0,H.cn)("text-[10px] font-medium","urgent"===U.priority&&"text-priority-urgent","rush"===U.priority&&"text-priority-rush","standard"===U.priority&&"text-priority-standard"),children:U.label})]}),a.orderNumber&&(0,d.jsx)(g.E,{variant:"secondary",className:"rounded-full backdrop-blur-md! bg-card/60! group-hover:bg-card! transition-colors duration-200",children:(0,d.jsxs)("span",{className:"text-[10px] font-medium",children:["#",a.orderNumber]})})]}),(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsxs)(g.E,{variant:"secondary",className:"flex items-center gap-1.5 rounded-full backdrop-blur-md! bg-card/60! group-hover:bg-card! transition-colors duration-200",children:[(0,d.jsx)("div",{className:(0,H.cn)("size-1.5 rounded-full","pending"===a.status&&"bg-status-pending","assigned"===a.status&&"bg-status-assigned","in_progress"===a.status&&"bg-status-in-progress","editing"===a.status&&"bg-status-editing","delivered"===a.status&&"bg-status-delivered","cancelled"===a.status&&"bg-status-cancelled")}),(0,d.jsx)("span",{className:(0,H.cn)("text-[10px] font-medium","pending"===a.status&&"text-status-pending","assigned"===a.status&&"text-status-assigned","in_progress"===a.status&&"text-status-in-progress","editing"===a.status&&"text-status-editing","delivered"===a.status&&"text-status-delivered","cancelled"===a.status&&"text-status-cancelled"),children:T.label})]}),(0,d.jsx)("div",{className:"relative z-50",onClick:a=>a.stopPropagation(),onPointerDown:a=>a.stopPropagation(),onMouseDown:a=>a.stopPropagation(),children:(0,d.jsxs)(v.rI,{open:N,onOpenChange:O,children:[(0,d.jsx)(v.ty,{asChild:!0,children:(0,d.jsxs)(h.$,{variant:"ghost",size:"icon",className:"h-6 w-6 rounded-full backdrop-blur-md! bg-card/60! hover:bg-card! transition-colors duration-200","data-dropdown-trigger":"true",children:[(0,d.jsx)(s.A,{className:"h-3.5 w-3.5"}),(0,d.jsx)("span",{className:"sr-only",children:"More options"})]})}),(0,d.jsxs)(v.SQ,{align:"end",className:"z-10000",onPointerDown:a=>a.stopPropagation(),onMouseDown:a=>a.stopPropagation(),children:[C&&(0,d.jsx)(v._2,{onSelect:a=>{a.preventDefault(),O(!1),C()},children:"View Details"}),x&&("pending"===a.status||"assigned"===a.status)&&!a.assignedTechnicianId&&S&&(0,d.jsx)(v._2,{onSelect:a=>{a.preventDefault(),O(!1),x()},children:"Find Technician"}),L&&a.assignedTechnicianId&&("assigned"===a.status||"in_progress"===a.status)&&S&&(0,d.jsx)(v._2,{onSelect:a=>{a.preventDefault(),O(!1),L()},children:"Change Technician"})]})]})})]})]}),(0,d.jsxs)("div",{className:"space-y-1 flex-1",children:[(0,d.jsxs)(G.m_,{children:[(0,d.jsx)(G.k$,{asChild:!0,children:(0,d.jsx)("h3",{className:"text-sm font-semibold text-foreground leading-tight line-clamp-2",children:a.propertyAddress})}),(0,d.jsx)(G.ZI,{side:"top",className:"max-w-xs",children:(0,d.jsx)(I.P,{className:"wrap-break-word",children:a.propertyAddress})})]}),a.clientName&&(0,d.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-1",children:a.clientName})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,d.jsxs)("div",{className:"inline-flex items-center gap-1",children:[(0,d.jsx)(t.A,{className:"size-3"}),(0,d.jsx)("span",{children:W})]}),a.scheduledTime&&(0,d.jsxs)("div",{className:"inline-flex items-center gap-1",children:[(0,d.jsx)(r.A,{className:"size-3"}),(0,d.jsx)("span",{children:a.scheduledTime})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[a.mediaType&&a.mediaType.length>0&&(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[a.mediaType.slice(0,3).map(a=>{let b=(a=>{let b=a.toLowerCase();return b.includes("photo")?j.A:b.includes("video")?k.A:b.includes("drone")||b.includes("aerial")?l.A:b.includes("3d")||b.includes("matterport")?m.A:b.includes("floor")?n.A:b.includes("virtual")||b.includes("tour")?o.A:j.A})(a);return(0,d.jsxs)(G.m_,{children:[(0,d.jsx)(G.k$,{asChild:!0,children:(0,d.jsx)("div",{className:"p-1 rounded-full backdrop-blur-md! bg-card/60! group-hover:bg-card! transition-colors duration-200",children:(0,d.jsx)(b,{className:"size-3 text-muted-foreground"})})}),(0,d.jsx)(G.ZI,{side:"top",className:"capitalize",children:a})]},a)}),a.mediaType.length>3&&(0,d.jsxs)("span",{className:"text-[10px] text-muted-foreground",children:["+",a.mediaType.length-3]})]}),X.length>0&&(0,d.jsxs)(D,{children:[(0,d.jsx)(E,{asChild:!0,children:(0,d.jsx)("div",{className:"cursor-pointer",children:(0,d.jsxs)(f.eu,{className:"h-6 w-6 border-2 border-card",children:[(0,d.jsx)(f.BK,{src:X[0].avatar,alt:X[0].name}),(0,d.jsx)(f.q5,{className:"text-[10px] bg-muted text-muted-foreground",children:X[0].name.split(" ").map(a=>a[0]).join("")})]})})}),(0,d.jsx)(F,{className:"w-80 p-0",align:"end",children:(0,d.jsxs)("div",{className:"p-4 space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsxs)(f.eu,{className:"size-12 border-2 border-background",children:[(0,d.jsx)(f.BK,{src:X[0].avatar,alt:X[0].name}),(0,d.jsx)(f.q5,{className:"bg-primary text-primary-foreground text-sm",children:X[0].name.split(" ").map(a=>a[0]).join("")})]}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("div",{className:"flex items-center gap-1.5 mb-1",children:(0,d.jsx)("span",{className:"font-semibold text-sm truncate",children:X[0].name})}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,d.jsx)(u.A,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),(0,d.jsx)("span",{className:"text-xs text-foreground",children:X[0].rating.overall})]}),(0,d.jsxs)("span",{className:"text-xs text-muted-foreground",children:[X[0].reliability.totalJobs," jobs"]})]})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted/50 rounded-lg",children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"On-time"}),(0,d.jsxs)("span",{className:"text-foreground font-medium",children:[(100*X[0].reliability.onTimeRate).toFixed(0),"%"]})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted/50 rounded-lg",children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Delivery"}),(0,d.jsxs)("span",{className:"text-foreground font-medium",children:[X[0].reliability.averageDeliveryTime,"h"]})]})]})]})})]})]})]})]})]});return M?Y:(0,d.jsxs)(y,{...{open:P,onOpenChange:Q},children:[(0,d.jsx)(z,{asChild:!0,onContextMenu:a=>{let b=a.target;if(b.closest("[data-radix-dropdown-menu-trigger]")||b.closest('button[aria-haspopup="menu"]')||b.closest('[data-slot="dropdown-menu-trigger"]'))return void a.preventDefault()},children:Y}),(0,d.jsxs)(A,{className:"z-9999",onPointerDown:a=>{a.stopPropagation()},onMouseDown:a=>{a.stopPropagation()},children:[C&&(0,d.jsx)(B,{className:"cursor-pointer",onSelect:a=>{a.preventDefault(),a.stopPropagation(),Q(!1),setTimeout(()=>{C()},0)},children:"View Details"}),x&&("pending"===a.status||"assigned"===a.status)&&!a.assignedTechnicianId&&S&&(0,d.jsx)(B,{className:"cursor-pointer",onSelect:a=>{a.preventDefault(),a.stopPropagation(),Q(!1),setTimeout(()=>{x()},0)},children:"Find Technician"}),L&&a.assignedTechnicianId&&("assigned"===a.status||"in_progress"===a.status)&&S&&(0,d.jsx)(B,{className:"cursor-pointer",onSelect:a=>{a.preventDefault(),a.stopPropagation(),Q(!1),setTimeout(()=>{L()},0)},children:"Change Technician"})]})]})}},15514:(a,b,c)=>{"use strict";c.d(b,{cn:()=>f,e:()=>g,w:()=>h});var d=c(43249),e=c(58829);function f(...a){return(0,e.QP)((0,d.$)(a))}let g=!1;function h(a,b=!1){if(b){let b=[];return a.street&&b.push(a.street),b.push(a.city),b.push(a.stateProvince),a.postalCode&&b.push(a.postalCode),b.push(a.country),b.join(", ")}return`${a.city}, ${a.stateProvince}, ${a.country}`}},17677:(a,b,c)=>{"use strict";c.d(b,{A0:()=>g,BF:()=>h,Hj:()=>i,XI:()=>f,nA:()=>k,nd:()=>j});var d=c(21124);c(38301);var e=c(67442);function f({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,d.jsx)("table",{"data-slot":"table",className:(0,e.cn)("w-full caption-bottom text-sm",a),...b})})}function g({className:a,...b}){return(0,d.jsx)("thead",{"data-slot":"table-header",className:(0,e.cn)("[&_tr]:border-b",a),...b})}function h({className:a,...b}){return(0,d.jsx)("tbody",{"data-slot":"table-body",className:(0,e.cn)("[&_tr:last-child]:border-0",a),...b})}function i({className:a,...b}){return(0,d.jsx)("tr",{"data-slot":"table-row",className:(0,e.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",a),...b})}function j({className:a,...b}){return(0,d.jsx)("th",{"data-slot":"table-head",className:(0,e.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...b})}function k({className:a,...b}){return(0,d.jsx)("td",{"data-slot":"table-cell",className:(0,e.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...b})}},19217:(a,b,c)=>{"use strict";c.d(b,{$:()=>i,r:()=>h});var d=c(21124);c(38301);var e=c(96425),f=c(26691),g=c(15514);let h=(0,f.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive cursor-pointer",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline",muted:"text-primary border-none bg-muted hover:bg-primary/20 transition-colors duration-300",flat:"text-primary border-none bg-transparent hover:text-primary/60 transition-colors duration-300",activeFlat:"text-primary border-none bg-transparent",mutedFlat:"text-primary/60 border-none bg-transparent hover:text-primary/90 transition-colors duration-300"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function i({className:a,variant:b,size:c,asChild:f=!1,...i}){let j=f?e.DX:"button";return(0,d.jsx)(j,{"data-slot":"button",className:(0,g.cn)(h({variant:b,size:c,className:a})),...i})}},21017:(a,b,c)=>{"use strict";c.d(b,{Eb:()=>n,Iu:()=>k,M_:()=>p,WA:()=>o,cU:()=>l,dK:()=>j,n$:()=>m});var d=c(21124);c(38301);var e=c(8294),f=c(59405),g=c(38882),h=c(67442),i=c(19217);function j({className:a,...b}){return(0,d.jsx)("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:(0,h.cn)("mx-auto flex w-full justify-center",a),...b})}function k({className:a,...b}){return(0,d.jsx)("ul",{"data-slot":"pagination-content",className:(0,h.cn)("flex flex-row items-center gap-1",a),...b})}function l({...a}){return(0,d.jsx)("li",{"data-slot":"pagination-item",...a})}function m({className:a,isActive:b,size:c="icon",...e}){return(0,d.jsx)("a",{"aria-current":b?"page":void 0,"data-slot":"pagination-link","data-active":b,className:(0,h.cn)((0,i.r)({variant:b?"outline":"ghost",size:c}),a),...e})}function n({className:a,...b}){return(0,d.jsxs)(m,{"aria-label":"Go to previous page",size:"default",className:(0,h.cn)("gap-1 px-2.5 sm:pl-2.5",a),...b,children:[(0,d.jsx)(e.A,{}),(0,d.jsx)("span",{className:"hidden sm:block",children:"Previous"})]})}function o({className:a,...b}){return(0,d.jsxs)(m,{"aria-label":"Go to next page",size:"default",className:(0,h.cn)("gap-1 px-2.5 sm:pr-2.5",a),...b,children:[(0,d.jsx)("span",{className:"hidden sm:block",children:"Next"}),(0,d.jsx)(f.A,{})]})}function p({className:a,...b}){return(0,d.jsxs)("span",{"aria-hidden":!0,"data-slot":"pagination-ellipsis",className:(0,h.cn)("flex size-9 items-center justify-center",a),...b,children:[(0,d.jsx)(g.A,{className:"size-4"}),(0,d.jsx)("span",{className:"sr-only",children:"More pages"})]})}},21411:(a,b,c)=>{"use strict";c.d(b,{oe:()=>d.o,WT:()=>R,bm:()=>C,RV:()=>z,Um:()=>Q,rw:()=>M});var d=c(40804);c(14293);var e=c(21124),f=c(38301),g=c(19217),h=c(7629),i=c(53199),j=c(33847),k=c(28241),l=c(69643),m=c(61010),n=c(42830),o=c(31115),p=c(69957),q=c(14263),r=c(15303),s=c(46422),t=c(18310),u=c(72567),v=c(44560),w=c(81676),x=c(79347);function y({value:a,onChange:b,onBlur:c,isGeocoding:d}){let[g,i]=(0,f.useState)(a),[j,k]=(0,f.useState)(!1),[l,m]=(0,f.useState)([]),[n,o]=(0,f.useState)(!1),r=(0,f.useRef)(null),s=(0,f.useCallback)(a=>{i(a.place_name);let[c,d]=a.center;b(a.place_name,{lat:d,lng:c}),m([]),k(!1)},[b]);return(0,e.jsxs)("div",{ref:r,className:"relative",children:[(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(p.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground/60 z-10"}),(0,e.jsx)(h.p,{id:"propertyAddress",value:g,onChange:a=>{i(a.target.value),b(a.target.value,void 0)},onFocus:()=>k(!0),onBlur:c,placeholder:"Full street address including city and state",className:"pl-11 h-11"}),(n||d)&&(0,e.jsx)(q.A,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground animate-spin"})]}),j&&l.length>0&&(0,e.jsx)("div",{className:"absolute top-full mt-1 w-full bg-card rounded-lg border border-border shadow-lg z-50 max-h-60 overflow-y-auto",children:l.map(a=>(0,e.jsx)("button",{type:"button",onClick:()=>s(a),className:"w-full text-left p-3 hover:bg-muted transition-colors first:rounded-t-lg last:rounded-b-lg",children:(0,e.jsxs)("div",{className:"flex items-start gap-2",children:[(0,e.jsx)(p.A,{className:"h-4 w-4 text-muted-foreground mt-0.5 shrink-0"}),(0,e.jsx)("div",{className:"flex-1 min-w-0",children:(0,e.jsx)("div",{className:"text-sm text-foreground truncate",children:a.place_name})})]})},a.id))})]})}function z({onSubmit:a,initialValues:b}){let[c,d]=(0,f.useState)({clientName:"",propertyAddress:"",location:void 0,scheduledDate:b?.scheduledDate||"",scheduledTime:b?.scheduledTime||"",mediaType:[],priority:"standard",estimatedDuration:b?.estimatedDuration||120,requirements:""}),[p,z]=(0,f.useState)(!1),[A,B]=(0,f.useState)([]),[C,D]=(0,f.useState)(""),[E,F]=(0,f.useState)(null),[G,H]=(0,f.useState)(!1),[I,J]=(0,f.useState)(!1),[K,L]=(0,f.useState)(!1),[M,N]=(0,f.useState)({name:"",email:"",phone:""}),O=(0,f.useMemo)(()=>{let a=C.trim().toLowerCase();return a?A.filter(b=>{let c=(b.name||"").toLowerCase(),d=(b.email||"").toLowerCase();return c.includes(a)||d.includes(a)}):A},[A,C]),P=async a=>{let b="pk.eyJ1IjoiZHVyb2RwIiwiYSI6ImNtaHplcW53cDA4dHQycnB6dnhqeGtveXgifQ.6GR-s3V7vfGRsoVlhSTFhg";if(!b)return console.warn("Mapbox token not configured"),null;try{let c=`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(a)}.json?access_token=${b}&types=address&country=us,ca&limit=1`,d=await fetch(c);if(!d.ok)throw Error("Geocoding request failed");let e=await d.json();if(e.features&&e.features.length>0){let a=e.features[0],[b,c]=a.center;return{lat:c,lng:b,placeName:a.place_name}}return null}catch(a){return console.error("Geocoding error:",a),null}},Q=async()=>{if(!c.location&&c.propertyAddress.trim()){z(!0);let a=c.propertyAddress.trim(),b=await P(a);b&&d(a=>({...a,location:{lat:b.lat,lng:b.lng},propertyAddress:b.placeName})),z(!1)}},R=(0,f.useCallback)(async a=>{H(!0);try{let b=await x.F.customers.list(a);B(b)}catch(a){console.error("Failed to load customers",a),n.oR.error("Unable to load customers")}finally{H(!1)}},[]),S=async()=>{await R(C||void 0)},T=a=>{F(a),d(b=>({...b,clientName:a.name})),J(!1)},U=async()=>{if(!M.name.trim())return void n.oR.error("Customer name is required");try{let a=await x.F.customers.create({name:M.name.trim(),email:M.email||void 0,phone:M.phone||void 0});if("customer_created"===a.type&&a.customer)B(b=>[a.customer,...b]),T(a.customer),N({name:"",email:"",phone:""}),n.oR.success("Customer added");else if("invitation_sent"===a.type)n.oR.success(a.message||`Invitation sent to ${M.email}`),N({name:"",email:"",phone:""}),J(!1);else if("invitation_pending"===a.type)n.oR.info(a.message||`An invitation is already pending for ${M.email}`);else if(("existing_customer"===a.type||"existing_customer_linked"===a.type)&&a.customer){B(b=>b.some(b=>b.id===a.customer.id)?b:[a.customer,...b]),T(a.customer),N({name:"",email:"",phone:""});let b="existing_customer_linked"===a.type?"Customer linked to their account":"Customer already exists";n.oR.info(a.message||b)}}catch(a){console.error("Failed to create customer",a),n.oR.error("Unable to create customer")}},V=async e=>{if(e.preventDefault(),!c.clientName.trim()&&!E)return void n.oR.error("Please enter a client name");if(!c.propertyAddress.trim())return void n.oR.error("Please enter a property address");if(!c.scheduledDate)return void n.oR.error("Please select a scheduled date");if(!c.scheduledTime)return void n.oR.error("Please select a scheduled time");if(0===c.mediaType.length)return void n.oR.error("Please select at least one media type");let f=c.location,g=c.propertyAddress.trim(),h={unparsed_address:g};if(c.propertyAddress.trim()){let a=c.propertyAddress.trim();n.oR.loading("Geocoding address...",{id:"geocoding"});let b=await P(a);b?(f={lat:b.lat,lng:b.lng},g=b.placeName,h={...h,unparsed_address:b.placeName,latitude:b.lat,longitude:b.lng},n.oR.success("Address geocoded successfully",{id:"geocoding"})):f?n.oR.dismiss("geocoding"):(n.oR.error("Could not find location for this address. Using default location.",{id:"geocoding"}),f={lat:51.0447,lng:-114.0719},h={...h,latitude:f.lat,longitude:f.lng})}try{await a({clientName:(E?.name||c.clientName).trim(),customerId:E?.id,propertyAddress:g,location:f,address:h,scheduledDate:c.scheduledDate,scheduledTime:c.scheduledTime,mediaType:c.mediaType,priority:c.priority,estimatedDuration:c.estimatedDuration,requirements:c.requirements.trim(),status:"pending"}),d({clientName:"",propertyAddress:"",location:void 0,scheduledDate:b?.scheduledDate||"",scheduledTime:b?.scheduledTime||"",mediaType:[],priority:"standard",estimatedDuration:b?.estimatedDuration||120,requirements:""}),F(null)}catch(a){console.error("Error submitting form:",a)}},W=[{value:"standard",label:"Standard",icon:r.A,color:"text-blue-600"},{value:"rush",label:"Rush (24h)",icon:s.A,color:"text-orange-600"},{value:"urgent",label:"Urgent (12h)",icon:t.A,color:"text-destructive"}];return(0,e.jsxs)("form",{onSubmit:V,className:"space-y-6",children:[(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsx)(i.J,{className:"text-sm",children:"Customer"}),(0,e.jsx)(g.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>J(a=>!a),children:I?"Cancel":"Add New"})]}),!I&&(0,e.jsxs)("div",{className:"flex flex-col gap-2 md:flex-row",children:[(0,e.jsx)(h.p,{placeholder:"Search by name or email",value:C,onChange:a=>D(a.target.value),onFocus:()=>L(!0),onBlur:()=>{setTimeout(()=>L(!1),100)},className:"h-11"}),(0,e.jsx)(g.$,{type:"button",variant:"outline",className:"h-11",onClick:S,disabled:G,children:G?(0,e.jsxs)("span",{className:"flex items-center gap-2",children:[(0,e.jsx)(q.A,{className:"h-4 w-4 animate-spin"}),"Searching"]}):"Search"})]}),K&&O.length>0&&(0,e.jsx)("div",{className:"flex flex-col gap-2 max-h-56 overflow-y-auto pr-1",children:O.map(a=>(0,e.jsx)(g.$,{type:"button",variant:E?.id===a.id?"default":"outline",onMouseDown:b=>{b.preventDefault(),T(a),L(!1)},className:"justify-start h-auto py-2",children:(0,e.jsxs)("div",{className:"flex items-center gap-3 text-left w-full",children:[(0,e.jsx)("div",{className:"h-9 w-9 rounded-full bg-muted flex items-center justify-center text-xs font-semibold",children:(a.name||"").split(" ").map(a=>a[0]).join("").toUpperCase()}),(0,e.jsxs)("div",{className:"flex flex-col",children:[(0,e.jsx)("span",{className:"font-medium",children:a.name}),(0,e.jsx)("span",{className:"text-xs text-muted-foreground",children:a.email||"No email"})]})]})},a.id))}),E&&(0,e.jsxs)("div",{className:"rounded-md border bg-muted/30 px-3 py-2 text-sm",children:["Selected customer: ",(0,e.jsx)("strong",{children:E.name})," ",E.email&&(0,e.jsxs)("span",{className:"text-muted-foreground",children:["(",E.email,")"]})]}),I&&(0,e.jsxs)("div",{className:"flex flex-col gap-3 bg-muted/20 p-3 rounded-md border",children:[(0,e.jsxs)("div",{className:"space-y-1",children:[(0,e.jsx)(i.J,{className:"text-xs uppercase text-muted-foreground",children:"Name *"}),(0,e.jsx)(h.p,{value:M.name,onChange:a=>N(b=>({...b,name:a.target.value})),placeholder:"Customer name",className:"h-10"})]}),(0,e.jsxs)("div",{className:"space-y-1",children:[(0,e.jsx)(i.J,{className:"text-xs uppercase text-muted-foreground",children:"Email"}),(0,e.jsx)(h.p,{type:"email",value:M.email,onChange:a=>N(b=>({...b,email:a.target.value})),placeholder:"customer@email.com",className:"h-10"})]}),(0,e.jsxs)("div",{className:"space-y-1",children:[(0,e.jsx)(i.J,{className:"text-xs uppercase text-muted-foreground",children:"Phone"}),(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsx)(h.p,{value:M.phone,onChange:a=>N(b=>({...b,phone:a.target.value})),placeholder:"(555) 123-4567",className:"h-10"}),(0,e.jsx)(g.$,{type:"button",onClick:U,className:"h-10",children:"Save"})]})]})]})]}),(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(i.J,{htmlFor:"clientName",className:"text-sm",children:"Client Name *"}),(0,e.jsx)(h.p,{id:"clientName",value:c.clientName,onChange:a=>d({...c,clientName:a.target.value}),placeholder:"Enter client or agency name",className:"h-11"})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(i.J,{htmlFor:"priority",className:"text-sm",children:"Priority Level"}),(0,e.jsxs)(k.l6,{value:c.priority,onValueChange:a=>d({...c,priority:a}),children:[(0,e.jsx)(k.bq,{className:"h-11",children:(0,e.jsx)(k.yv,{})}),(0,e.jsx)(k.gC,{children:W.map(a=>{let b=a.icon;return(0,e.jsx)(k.eb,{value:a.value,children:(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)(b,{className:`h-4 w-4 ${a.color}`}),(0,e.jsx)("span",{children:a.label})]})},a.value)})})]})]})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(i.J,{htmlFor:"propertyAddress",className:"text-sm",children:"Property Address *"}),(0,e.jsx)(y,{value:c.propertyAddress,onChange:(a,b)=>d({...c,propertyAddress:a,location:b}),onBlur:Q,isGeocoding:p})]}),(0,e.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(i.J,{className:"text-sm",children:"Shoot Date *"}),(0,e.jsxs)(m.AM,{children:[(0,e.jsx)(m.Wv,{asChild:!0,children:(0,e.jsxs)(g.$,{type:"button",variant:"outline",className:"relative w-full justify-start text-left font-normal h-11 pl-11",children:[(0,e.jsx)(u.A,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground/60"}),c.scheduledDate?(()=>{try{let a=new Date(c.scheduledDate+"T00:00:00");if(!isNaN(a.getTime()))return(0,o.GP)(a,"PPP")}catch(a){}return c.scheduledDate})():(0,e.jsx)("span",{className:"text-muted-foreground",children:"Pick a date"})]})}),(0,e.jsx)(m.hl,{className:"w-auto p-0",align:"start",children:(0,e.jsx)(l.V,{mode:"single",selected:c.scheduledDate?(()=>{try{let a=new Date(c.scheduledDate+"T00:00:00");return isNaN(a.getTime())?void 0:a}catch{return}})():void 0,onSelect:a=>{a&&d({...c,scheduledDate:(0,o.GP)(a,"yyyy-MM-dd")})},disabled:a=>a<new Date(new Date().setHours(0,0,0,0)),initialFocus:!0})})]})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(i.J,{className:"text-sm",children:"Start Time *"}),(0,e.jsxs)(m.AM,{children:[(0,e.jsx)(m.Wv,{asChild:!0,children:(0,e.jsxs)(g.$,{type:"button",variant:"outline",className:"relative w-full justify-start text-left font-normal h-11 pl-11",children:[(0,e.jsx)(r.A,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground/60"}),c.scheduledTime?(()=>{try{let[a,b]=c.scheduledTime.split(":"),d=parseInt(a,10);return`${0===d?12:d>12?d-12:d}:${b} ${d>=12?"PM":"AM"}`}catch{return c.scheduledTime}})():(0,e.jsx)("span",{className:"text-muted-foreground",children:"Pick a time"})]})}),(0,e.jsx)(m.hl,{className:"w-auto p-4",align:"start",children:(0,e.jsx)("div",{className:"space-y-4",children:(0,e.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,e.jsxs)(k.l6,{value:c.scheduledTime?(()=>{let[a]=c.scheduledTime.split(":"),b=parseInt(a,10);return(0===b?12:b>12?b-12:b).toString()})():"9",onValueChange:a=>{d(b=>{let c=b.scheduledTime&&b.scheduledTime.split(":")[1]||"00",d=(b.scheduledTime?parseInt(b.scheduledTime.split(":")[0],10):9)>=12,e="12"===a?12*!!d:d?parseInt(a,10)+12:parseInt(a,10);return{...b,scheduledTime:`${e.toString().padStart(2,"0")}:${c}`}})},children:[(0,e.jsx)(k.bq,{className:"w-full",children:(0,e.jsx)(k.yv,{placeholder:"Hour"})}),(0,e.jsx)(k.gC,{children:Array.from({length:12},(a,b)=>(0,e.jsx)(k.eb,{value:(b+1).toString(),children:b+1},b+1))})]}),(0,e.jsxs)(k.l6,{value:c.scheduledTime&&c.scheduledTime.split(":")[1]||"00",onValueChange:a=>{d(b=>{let c=b.scheduledTime?parseInt(b.scheduledTime.split(":")[0],10):9;return{...b,scheduledTime:`${c.toString().padStart(2,"0")}:${a.padStart(2,"0")}`}})},children:[(0,e.jsx)(k.bq,{className:"w-full",children:(0,e.jsx)(k.yv,{placeholder:"Minute"})}),(0,e.jsx)(k.gC,{children:[0,15,30,45].map(a=>(0,e.jsx)(k.eb,{value:a.toString().padStart(2,"0"),children:a.toString().padStart(2,"0")},a))})]}),(0,e.jsxs)(k.l6,{value:c.scheduledTime?(()=>{let[a]=c.scheduledTime.split(":");return parseInt(a,10)>=12?"PM":"AM"})():"AM",onValueChange:a=>{d(b=>{let c=b.scheduledTime&&b.scheduledTime.split(":")[1]||"00",d=b.scheduledTime?parseInt(b.scheduledTime.split(":")[0],10):9,e=0===d?12:d>12?d-12:d;return{...b,scheduledTime:`${("PM"===a?12===e?12:e+12:12===e?0:e).toString().padStart(2,"0")}:${c}`}})},children:[(0,e.jsx)(k.bq,{className:"w-full",children:(0,e.jsx)(k.yv,{placeholder:"AM/PM"})}),(0,e.jsxs)(k.gC,{children:[(0,e.jsx)(k.eb,{value:"AM",children:"AM"}),(0,e.jsx)(k.eb,{value:"PM",children:"PM"})]})]})]})})})]})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(i.J,{htmlFor:"duration",className:"text-sm",children:"Duration (minutes)"}),(0,e.jsx)(h.p,{id:"duration",type:"number",value:c.estimatedDuration,onChange:a=>{let b=""===a.target.value?"":parseInt(a.target.value);d({...c,estimatedDuration:""===b||isNaN(b)?120:b})},onBlur:a=>{let b=parseInt(a.target.value);(isNaN(b)||b<15)&&d({...c,estimatedDuration:15})},min:"15",step:"1",className:"h-11"})]})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(i.J,{className:"text-sm",children:"What media do you need? *"}),(0,e.jsx)(v.O,{type:"multiple",value:c.mediaType,onValueChange:a=>{d(b=>({...b,mediaType:a}))},className:"grid grid-cols-2 gap-3 w-full",children:w.H.map(a=>{let b=a.icon;return(0,e.jsxs)(v.d,{value:a.id,className:"flex items-center gap-3 p-4 h-auto data-[state=on]:bg-accent data-[state=on]:border-primary",children:[(0,e.jsx)("div",{className:"p-2.5 rounded-lg bg-primary",children:(0,e.jsx)(b,{className:"h-5 w-5 text-primary-foreground"})}),(0,e.jsx)("div",{className:"flex-1 text-left",children:(0,e.jsx)("div",{className:"text-sm font-medium",children:a.label})})]},a.id)})})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(i.J,{htmlFor:"requirements",className:"text-sm",children:"Special Requirements"}),(0,e.jsx)(j.T,{id:"requirements",value:c.requirements,onChange:a=>d({...c,requirements:a.target.value}),placeholder:"Any special instructions, access codes, or details the technician should know...",rows:4,className:"resize-none"})]}),(0,e.jsx)(g.$,{type:"submit",variant:"default",className:"w-full h-12",children:"Create Job Request"})]})}var A=c(1323),B=c(11534);function C({title:a,items:b,itemCount:c=6,searchPlaceholder:d="Search by address, client name...",searchFields:f,filterOptions:g,onFilterChange:h,renderItem:i,emptyMessage:j="No items",emptyIcon:k,emptyTitle:l,emptyDescription:m,emptyAction:n,className:o="",horizontalLayout:p=!1,itemWidth:q="320px",onNavigateToFullView:r,useGridLayout:s=!0,onScrollControlsReady:t}){return 0===b.length?(0,e.jsx)(B.pp,{icon:k,title:l||j,description:m||"",action:n}):(0,e.jsx)("div",{className:o,children:(0,e.jsx)(A.q,{title:a,items:b,itemCount:c,searchPlaceholder:d,searchFields:f,filterOptions:g,onFilterChange:h,renderItem:i,emptyMessage:j,horizontalLayout:p,itemWidth:q,onNavigateToFullView:r,useGridLayout:s,onScrollControlsReady:p?t:void 0})})}var D=c(21017),E=c(88285),F=c(81925),G=c(86773),H=c(82548),I=c(55705),J=c(99042),K=c(17677),L=c(77555);function M({items:a,renderItem:b,renderTableRow:c,onItemClick:d,searchPlaceholder:i="Search...",searchFields:j,filterOptions:l=[],onFilterChange:m,emptyMessage:n="No items found",emptyIcon:o,emptyTitle:p,emptyDescription:q,emptyAction:r,itemsPerPage:s=12}){let[t,u]=(0,f.useState)(""),[v,w]=(0,f.useState)("all"),[x,y]=(0,f.useState)("date-desc"),[z,A]=(0,f.useState)(1),[B,C]=(0,f.useState)(s),[M,N]=(0,f.useState)("grid"),O=(0,f.useMemo)(()=>{let b=[...a];if(t&&j){let a=t.toLowerCase();b=b.filter(b=>j(b).toLowerCase().includes(a))}if(m&&"all"!==v&&(b=m(v),t&&j)){let a=t.toLowerCase();b=b.filter(b=>j(b).toLowerCase().includes(a))}return b.sort((a,b)=>{switch(x){case"date-asc":if(a.scheduledDate&&b.scheduledDate)return new Date(a.scheduledDate).getTime()-new Date(b.scheduledDate).getTime();if(a.scheduledDate)return -1;if(b.scheduledDate)return 1;return 0;case"date-desc":if(a.scheduledDate&&b.scheduledDate)return new Date(b.scheduledDate).getTime()-new Date(a.scheduledDate).getTime();if(a.scheduledDate)return -1;if(b.scheduledDate)return 1;return 0;case"client-asc":if(a.clientName&&b.clientName)return a.clientName.localeCompare(b.clientName);return 0;case"client-desc":if(a.clientName&&b.clientName)return b.clientName.localeCompare(a.clientName);return 0;case"priority":let c={urgent:3,rush:2,standard:1},d=c[a.priority]||0;return(c[b.priority]||0)-d;default:return 0}}),b},[a,t,v,x,j,m]),P=Math.ceil(O.length/B),Q=(z-1)*B,R=Q+B,S=O.slice(Q,R);return(0,e.jsxs)("div",{className:"flex flex-col space-y-6",children:[(0,e.jsxs)("div",{className:"flex gap-3","data-tour":"jobs-filters",children:[(0,e.jsxs)("div",{className:"relative flex-1 min-w-0",children:[(0,e.jsx)(E.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground/60 "}),(0,e.jsx)(h.p,{type:"text",variant:"muted",placeholder:i,value:t,onChange:a=>{u(a.target.value),A(1)},className:"pl-10"})]}),l.length>0&&(0,e.jsxs)(k.l6,{value:v,onValueChange:a=>{w(a),A(1)},children:[(0,e.jsxs)(k.bq,{variant:"muted",className:"w-10 md:w-[180px] shrink-0 [&>svg:last-child]:hidden md:[&>svg:last-child]:block",children:[(0,e.jsx)(F.A,{className:"h-4 w-4 md:mr-2"}),(0,e.jsx)(k.yv,{placeholder:"All Items",className:"hidden md:inline"})]}),(0,e.jsxs)(k.gC,{children:[(0,e.jsx)(k.eb,{value:"all",children:"All Items"}),l.map(a=>(0,e.jsx)(k.eb,{value:a.value,children:a.label},a.value))]})]}),(0,e.jsxs)(k.l6,{value:x,onValueChange:a=>{y(a),A(1)},children:[(0,e.jsxs)(k.bq,{variant:"muted",className:"w-10 md:w-[180px] shrink-0 [&>svg:last-child]:hidden md:[&>svg:last-child]:block",children:[(0,e.jsx)(G.A,{className:"h-4 w-4 md:mr-2"}),(0,e.jsx)(k.yv,{placeholder:"Sort",className:"hidden md:inline"})]}),(0,e.jsxs)(k.gC,{children:[(0,e.jsx)(k.eb,{value:"date-asc",children:"Date (Earliest)"}),(0,e.jsx)(k.eb,{value:"date-desc",children:"Date (Latest)"}),(0,e.jsx)(k.eb,{value:"client-asc",children:"Client (A-Z)"}),(0,e.jsx)(k.eb,{value:"client-desc",children:"Client (Z-A)"}),(0,e.jsx)(k.eb,{value:"priority",children:"Priority"})]})]}),(0,e.jsxs)(L.e2,{className:"flex items-center shrink-0",children:[(0,e.jsx)(g.$,{variant:"grid"===M?"default":"muted",size:"sm",onClick:()=>N("grid"),className:"h-8 w-8 p-0","aria-label":"Grid view",children:(0,e.jsx)(H.A,{className:"h-4 w-4"})}),(0,e.jsx)(g.$,{variant:"list"===M?"default":"muted",size:"sm",onClick:()=>N("list"),className:"h-8 w-8 p-0","aria-label":"List view",children:(0,e.jsx)(I.A,{className:"h-4 w-4"})})]})]}),O.length>0&&(0,e.jsxs)(J.Oc,{className:"text-muted-foreground mb-4",children:["Showing ",Q+1,"-",Math.min(R,O.length)," of ",O.length," jobs"]}),S.length>0?(0,e.jsxs)(e.Fragment,{children:["grid"===M?(0,e.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6","data-tour":"jobs-list",children:S.map((a,c)=>(0,e.jsx)("div",{className:"h-full flex",onClick:()=>d?.(a),role:d?"button":void 0,children:(0,e.jsx)("div",{className:"w-full",children:b(a,Q+c,"grid")})},c))}):c?(0,e.jsxs)(K.XI,{"data-tour":"jobs-list",children:[(0,e.jsx)(K.A0,{children:(0,e.jsxs)(K.Hj,{children:[(0,e.jsx)(K.nd,{children:"Property"}),(0,e.jsx)(K.nd,{children:"Client"}),(0,e.jsx)(K.nd,{children:"Scheduled"}),(0,e.jsx)(K.nd,{children:"Media Types"}),(0,e.jsx)(K.nd,{children:"Priority"}),(0,e.jsx)(K.nd,{children:"Status"}),(0,e.jsx)(K.nd,{children:"Technician"}),(0,e.jsx)(K.nd,{className:"text-right",children:"Actions"})]})}),(0,e.jsx)(K.BF,{children:S.map((a,b)=>(0,e.jsx)(K.Hj,{onClick:()=>d?.(a),className:d?"cursor-pointer":void 0,children:c(a,Q+b)},b))})]}):(0,e.jsx)("div",{className:"space-y-3","data-tour":"jobs-list",children:S.map((a,c)=>(0,e.jsx)("div",{className:"w-full",onClick:()=>d?.(a),role:d?"button":void 0,children:b(a,Q+c,"list")},c))}),(0,e.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[P>1?(0,e.jsx)(D.dK,{children:(0,e.jsxs)(D.Iu,{children:[(0,e.jsx)(D.cU,{children:(0,e.jsx)(D.Eb,{onClick:()=>A(a=>Math.max(1,a-1)),className:1===z?"pointer-events-none opacity-50":"cursor-pointer"})}),(()=>{let a=[];if(P<=5)for(let b=1;b<=P;b++)a.push(b);else{a.push(1),z>3&&a.push("ellipsis");let b=Math.max(2,z-1),c=Math.min(P-1,z+1);for(let d=b;d<=c;d++)1!==d&&d!==P&&a.push(d);z<P-2&&a.push("ellipsis"),P>1&&a.push(P)}return a})().map((a,b)=>(0,e.jsx)(D.cU,{children:"ellipsis"===a?(0,e.jsx)(D.M_,{}):(0,e.jsx)(D.n$,{onClick:()=>A(a),isActive:z===a,className:"cursor-pointer",children:a})},b)),(0,e.jsx)(D.cU,{children:(0,e.jsx)(D.WA,{onClick:()=>A(a=>Math.min(P,a+1)),className:z===P?"pointer-events-none opacity-50":"cursor-pointer"})})]})}):(0,e.jsx)("div",{}),(0,e.jsxs)(k.l6,{value:B.toString(),onValueChange:a=>{C(Number(a)),A(1)},children:[(0,e.jsxs)(k.bq,{className:"w-10 md:w-[140px] shrink-0 [&>svg:last-child]:hidden md:[&>svg:last-child]:block",children:[(0,e.jsx)(I.A,{className:"h-4 w-4 md:mr-2"}),(0,e.jsx)(k.yv,{placeholder:"Per page",className:"hidden md:inline"})]}),(0,e.jsxs)(k.gC,{children:[(0,e.jsx)(k.eb,{value:"12",children:"12 per page"}),(0,e.jsx)(k.eb,{value:"24",children:"24 per page"}),(0,e.jsx)(k.eb,{value:"48",children:"48 per page"}),(0,e.jsx)(k.eb,{value:"100",children:"100 per page"})]})]})]})]}):(0,e.jsxs)("div",{className:"text-center py-12 text-muted-foreground","data-tour":"jobs-list",children:[o&&(0,e.jsx)(o,{className:"size-16 mx-auto mb-4 text-muted-foreground/40"}),(0,e.jsx)(J.H3,{className:"text-xl text-foreground mb-2",children:p||n}),(0,e.jsx)(J.QX,{className:"mb-6",children:q}),r&&(0,e.jsx)(g.$,{onClick:r.onClick,children:r.label})]})]})}var N=c(85948),O=c(26519),P=c(55224);function Q(){return(0,e.jsx)("div",{className:"grid grid-cols-1 gap-4",children:Array.from({length:4}).map((a,b)=>(0,e.jsxs)("div",{className:"border rounded-lg p-4 space-y-3 bg-card",children:[(0,e.jsx)(P.E,{className:"h-4 w-1/3"}),(0,e.jsx)(P.E,{className:"h-6 w-1/2"}),(0,e.jsx)(P.E,{className:"h-4 w-2/3"}),(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsx)(P.E,{className:"h-8 w-20"}),(0,e.jsx)(P.E,{className:"h-8 w-24"})]})]},`job-skeleton-${b}`))})}function R({children:a,fallback:b}){let{isLoadingJobs:c,jobsError:d,refreshJobs:f,jobs:h}=(0,N.w)(),i=h.length>0;return c&&!i?(0,e.jsx)(e.Fragment,{children:b??(0,e.jsx)(Q,{})}):d?(0,e.jsxs)(O.Fc,{variant:"destructive",children:[(0,e.jsx)(t.A,{className:"h-4 w-4"}),(0,e.jsx)(O.XL,{children:"Unable to load jobs"}),(0,e.jsxs)(O.TN,{className:"flex items-center justify-between gap-4",children:[(0,e.jsx)("span",{children:d.message}),(0,e.jsx)(g.$,{variant:"secondary",size:"sm",onClick:f,children:"Retry"})]})]}):(0,e.jsx)(e.Fragment,{children:a})}c(22544),c(36736)},22544:(a,b,c)=>{"use strict";c.d(b,{E:()=>i});var d=c(21124);c(38301);var e=c(96425),f=c(26691),g=c(15514);let h=(0,f.F)("inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground",flat:"text-foreground bg-none [a&]:hover:text-accent-foreground border-none",muted:"text-primary bg-muted border-none"}},defaultVariants:{variant:"default"}});function i({className:a,variant:b,asChild:c=!1,...f}){let i=c?e.DX:"span";return(0,d.jsx)(i,{"data-slot":"badge",className:(0,g.cn)(h({variant:b}),a),...f})}},26519:(a,b,c)=>{"use strict";c.d(b,{Fc:()=>h,TN:()=>j,XL:()=>i});var d=c(21124);c(38301);var e=c(26691),f=c(67442);let g=(0,e.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function h({className:a,variant:b,...c}){return(0,d.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,f.cn)(g({variant:b}),a),...c})}function i({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"alert-title",className:(0,f.cn)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",a),...b})}function j({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"alert-description",className:(0,f.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",a),...b})}},27176:(a,b,c)=>{"use strict";c.d(b,{p:()=>o});var d=c(21124),e=c(3991),f=c.n(e),g=c(38301),h=c(19217),i=c(674),j=c(22544),k=c(53199),l=c(99042),m=c(78583);c(79347);let n={PHOTOGRAPHY:{label:"Photography",icon:"\uD83D\uDCF7"},VIDEOGRAPHY:{label:"Videography",icon:"\uD83C\uDFAC"},DRONE_AERIAL:{label:"Drone/Aerial",icon:"\uD83D\uDE81"},VIRTUAL_TOURS:{label:"Virtual Tours",icon:"\uD83C\uDFE0"},FLOOR_PLANS:{label:"Floor Plans",icon:"\uD83D\uDCD0"},EDITING:{label:"Editing",icon:"\uD83D\uDDBC"},STAGING:{label:"Virtual Staging",icon:"\uD83D\uDECB"},MEASUREMENTS:{label:"Measurements",icon:"\uD83D\uDCCF"}};function o({provider:a,organizationSettingsPath:b}){let[c,e]=(0,g.useState)([]),[o,p]=(0,g.useState)(!0),q=(0,g.useMemo)(()=>{let{street:b,city:c,stateProvince:d,postalCode:e,country:f}=a.homeLocation?.address||{};return[b,c,d,e,f].filter(Boolean).join(", ")},[a.homeLocation?.address]);return(0,d.jsx)("main",{className:"container relative mx-auto",children:(0,d.jsx)("article",{className:"flex flex-col gap-2xl md:gap-3xl px-md",children:(0,d.jsxs)("div",{className:"@container w-full mt-md mb-md",children:[(0,d.jsx)("div",{className:"mb-md flex items-baseline justify-between",children:(0,d.jsx)(l.H2,{className:"text-lg border-0",children:"Profile"})}),(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"flex items-start gap-6",children:[(0,d.jsxs)(i.eu,{className:"size-24",children:[(0,d.jsx)(i.BK,{src:a.avatar}),(0,d.jsx)(i.q5,{className:"bg-primary text-primary-foreground text-2xl",children:a.name.split(" ").map(a=>a[0]).join("")})]}),(0,d.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,d.jsx)(l.H3,{className:"text-xl",children:a.name}),(0,d.jsx)(l.Oc,{className:"text-muted-foreground",children:a.email}),a.isIndependent?(0,d.jsx)(j.E,{variant:"outline",className:"border-primary text-foreground/90",children:"Independent Provider"}):(0,d.jsx)(j.E,{className:"bg-primary text-primary-foreground",children:a.companyName})]})]}),a.bio&&(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(k.J,{children:"About"}),(0,d.jsx)(l.Oc,{className:"text-muted-foreground",children:a.bio})]}),(0,d.jsxs)("div",{className:"space-y-3 pt-6 border-t",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)(k.J,{children:"Location"}),b&&(0,d.jsx)(h.$,{variant:"flat",size:"sm",className:"h-8 px-2 text-xs",asChild:!0,children:(0,d.jsxs)(f(),{href:b,children:["Workspace Settings",(0,d.jsx)(m.A,{className:"size-4 ml-1"})]})})]}),(0,d.jsxs)("div",{className:"space-y-1 text-sm text-muted-foreground",children:[a.phone&&(0,d.jsx)("div",{className:"text-foreground",children:a.phone}),(0,d.jsx)("div",{children:q||"No address available"})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-3 gap-4 pt-6 border-t",children:[(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(l.yE,{className:"mb-1",children:a.reliability.totalJobs}),(0,d.jsx)(l.Oc,{className:"text-muted-foreground",children:"Total Jobs"})]}),(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(l.yE,{className:"mb-1",children:a.rating.overall}),(0,d.jsx)(l.Oc,{className:"text-muted-foreground",children:"Rating"})]}),(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsxs)(l.yE,{className:"mb-1",children:[(100*a.reliability.onTimeRate).toFixed(0),"%"]}),(0,d.jsx)(l.Oc,{className:"text-muted-foreground",children:"On-Time"})]})]}),(0,d.jsxs)("div",{className:"space-y-3 pt-6 border-t",children:[(0,d.jsx)(k.J,{children:"Services"}),o?(0,d.jsx)(l.QX,{className:"text-sm",children:"Loading services..."}):c.length>0?(0,d.jsx)("div",{className:"flex flex-wrap gap-2",children:c.map(a=>{let b=n[a];return b?(0,d.jsxs)(j.E,{variant:"secondary",className:"flex items-center gap-1.5 px-3 py-1.5",children:[b.icon,(0,d.jsx)("span",{children:b.label})]},a):null})}):(0,d.jsx)(l.QX,{className:"text-sm",children:"No services listed"})]}),a.portfolio&&a.portfolio.length>0&&(0,d.jsxs)("div",{className:"space-y-3 pt-6 border-t",children:[(0,d.jsx)(k.J,{children:"Notable Works"}),(0,d.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:a.portfolio.map((a,b)=>(0,d.jsxs)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"group relative aspect-[4/3] rounded-lg overflow-hidden bg-muted border border-border hover:border-primary transition-colors",children:[(0,d.jsx)("img",{src:a,alt:`Portfolio item ${b+1}`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),(0,d.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center",children:(0,d.jsx)(m.A,{className:"h-5 w-5 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]},b))})]})]})]})})})}},27654:(a,b,c)=>{"use strict";c.d(b,{EL:()=>l,FK:()=>i,UD:()=>k,aJ:()=>j});let d=[{path:"/dashboard",label:"Dashboard",icon:"LayoutDashboard"},{path:"/calendar",label:"Calendar",icon:"Calendar"}],e=[{path:"/dashboard",label:"Dashboard",icon:"LayoutDashboard"},{path:"/jobs/all-jobs",label:"Jobs",icon:"Briefcase"},{path:"/map",label:"Map",icon:"Map"},{path:"/calendar",label:"Calendar",icon:"Calendar"}],f=[{path:"/dashboard",label:"Dashboard",icon:"LayoutDashboard"},{path:"/jobs/all-jobs",label:"My Jobs",icon:"Briefcase"},{path:"/map",label:"Map",icon:"Map"},{path:"/calendar",label:"Calendar",icon:"Calendar"}],g=[{path:"/dashboard",label:"Dashboard",icon:"LayoutDashboard"},{path:"/jobs/all-jobs",label:"My Jobs",icon:"Briefcase"},{path:"/jobs/job-management",label:"Job Board",icon:"Kanban"},{path:"/map",label:"Map",icon:"Map"},{path:"/calendar",label:"Calendar",icon:"Calendar"}],h=["OWNER","ADMIN","PROJECT_MANAGER","EDITOR"],i=a=>{let b=(a||"").toUpperCase();return"COMPANY"===b||h.includes(b)?"COMPANY":"TECHNICIAN"===b||"PROVIDER"===b?"TECHNICIAN":"AGENT"},j=(a,b,c)=>{if(!a)return null;let d=l(a,b,c);return d?d.showSidebar?"COMPANY":"AGENT"===d.accountType?"AGENT":"PERSONAL"===d.orgType?"COMPANY":"TECHNICIAN":null},k=a=>"COMPANY"===a;function l(a,b,c){if(!a)return null;let h=b.find(a=>a.orgId===c),i=h?.organization?.type||h?.organizationType||"PERSONAL",j="PERSONAL"===i?"PERSONAL_OWNER":h?.orgRole||h?.role||null,k=a.accountType||"PROVIDER",l=(j||"").toString().toUpperCase(),m="COMPANY"===i&&["OWNER","ADMIN","PROJECT_MANAGER"].includes(l),n=[],o=!1,p="New Job",q="",r=["OWNER","ADMIN","PERSONAL_OWNER"].includes(l)||"PERSONAL"===i;return m?(o=["OWNER","ADMIN"].includes(l),p="New Job",q=""):"AGENT"===k?(n=d,o=!0,p="Create Order",q="/booking"):"COMPANY"===i&&"EDITOR"===l?(n=g,o=!1):"COMPANY"===i&&"TECHNICIAN"===l?(n=f,o=!1):("PROVIDER"===k||"COMPANY"===k)&&(n=e,o=!1),{accountType:k,orgType:i,orgRole:j,showSidebar:m,isElevatedRole:m,navItems:n,canCreateOrder:o,createActionLabel:p,createActionPath:q,canManageCustomers:r}}},28241:(a,b,c)=>{"use strict";c.d(b,{bq:()=>n,eb:()=>p,gC:()=>o,l6:()=>k,yv:()=>l});var d=c(21124);c(38301);var e=c(19815),f=c(85351),g=c(71613),h=c(82042),i=c(26691),j=c(67442);function k({...a}){return(0,d.jsx)(e.bL,{"data-slot":"select",...a})}function l({...a}){return(0,d.jsx)(e.WT,{"data-slot":"select-value",...a})}let m=(0,i.F)("flex w-full items-center justify-between gap-2 whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 [&_svg:not([class*='text-'])]:text-muted-foreground data-[placeholder]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive cursor-pointer",{variants:{variant:{default:"border-input bg-input-background dark:bg-input/30 border px-3 py-1",outline:"border-2 bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",ghost:"border-0 bg-transparent hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",muted:"border-transparent bg-muted text-primary hover:bg-muted/80"},size:{default:"h-9 rounded-md px-3 py-2 text-sm",sm:"h-8 rounded-md px-2.5 py-1.5 text-sm",lg:"h-10 rounded-md px-4 py-2.5 text-base"}},defaultVariants:{variant:"default",size:"default"}});function n({className:a,variant:b,size:c,children:g,...h}){return(0,d.jsxs)(e.l9,{"data-slot":"select-trigger",className:(0,j.cn)(m({variant:b,size:c}),a),...h,children:[g,(0,d.jsx)(e.In,{asChild:!0,children:(0,d.jsx)(f.A,{className:"size-4 opacity-50"})})]})}function o({className:a,children:b,position:c="popper",...f}){return(0,d.jsx)(e.ZL,{children:(0,d.jsxs)(e.UC,{"data-slot":"select-content",className:(0,j.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===c&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:c,...f,children:[(0,d.jsx)(q,{}),(0,d.jsx)(e.LM,{className:(0,j.cn)("p-1","popper"===c&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:b}),(0,d.jsx)(r,{})]})})}function p({className:a,children:b,...c}){return(0,d.jsxs)(e.q7,{"data-slot":"select-item",className:(0,j.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-pointer items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",a),...c,children:[(0,d.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,d.jsx)(e.VF,{children:(0,d.jsx)(g.A,{className:"size-4"})})}),(0,d.jsx)(e.p4,{children:b})]})}function q({className:a,...b}){return(0,d.jsx)(e.PP,{"data-slot":"select-scroll-up-button",className:(0,j.cn)("flex cursor-pointer items-center justify-center py-1",a),...b,children:(0,d.jsx)(h.A,{className:"size-4"})})}function r({className:a,...b}){return(0,d.jsx)(e.wn,{"data-slot":"select-scroll-down-button",className:(0,j.cn)("flex cursor-pointer items-center justify-center py-1",a),...b,children:(0,d.jsx)(f.A,{className:"size-4"})})}},30429:(a,b,c)=>{"use strict";c.d(b,{II:()=>n,Nt:()=>o,at:()=>l});var d=c(21124),e=c(38301),f=c(44968),g=c(22743),h=c(43028),i=c(67442);let j={light:"",dark:".dark"},k=e.createContext(null);function l({id:a,className:b,children:c,config:g,...h}){let j=e.useId(),l=`chart-${a||j.replace(/:/g,"")}`;return(0,d.jsx)(k.Provider,{value:{config:g},children:(0,d.jsxs)("div",{"data-slot":"chart","data-chart":l,className:(0,i.cn)("[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",b),...h,children:[(0,d.jsx)(m,{id:l,config:g}),(0,d.jsx)(f.u,{children:c})]})})}let m=({id:a,config:b})=>{let c=Object.entries(b).filter(([,a])=>a.theme||a.color);return c.length?(0,d.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(j).map(([b,d])=>`
${d} [data-chart=${a}] {
${c.map(([a,c])=>{let d=c.theme?.[b]||c.color;return d?`  --color-${a}: ${d};`:null}).join("\n")}
}
`).join("\n")}}):null},n=g.m;function o({active:a,payload:b,className:c,indicator:f="dot",hideLabel:g=!1,hideIndicator:h=!1,label:j,labelFormatter:l,labelClassName:m,formatter:n,color:o,nameKey:q,labelKey:r}){let{config:s}=function(){let a=e.useContext(k);if(!a)throw Error("useChart must be used within a <ChartContainer />");return a}(),t=e.useMemo(()=>{if(g||!b?.length)return null;let[a]=b,c=`${r||a?.dataKey||a?.name||"value"}`,e=p(s,a,c),f=r||"string"!=typeof j?e?.label:s[j]?.label||j;return l?(0,d.jsx)("div",{className:(0,i.cn)("font-medium",m),children:l(f,b)}):f?(0,d.jsx)("div",{className:(0,i.cn)("font-medium",m),children:f}):null},[j,l,b,g,m,s,r]);if(!a||!b?.length)return null;let u=1===b.length&&"dot"!==f;return(0,d.jsxs)("div",{className:(0,i.cn)("border-border/50 bg-background grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl",c),children:[u?null:t,(0,d.jsx)("div",{className:"grid gap-1.5",children:b.map((a,b)=>{let c=`${q||a.name||a.dataKey||"value"}`,e=p(s,a,c),g=o||a.payload.fill||a.color;return(0,d.jsx)("div",{className:(0,i.cn)("[&>svg]:text-muted-foreground flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5","dot"===f&&"items-center"),children:n&&a?.value!==void 0&&a.name?n(a.value,a.name,a,b,a.payload):(0,d.jsxs)(d.Fragment,{children:[e?.icon?(0,d.jsx)(e.icon,{}):!h&&(0,d.jsx)("div",{className:(0,i.cn)("shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)",{"h-2.5 w-2.5":"dot"===f,"w-1":"line"===f,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===f,"my-0.5":u&&"dashed"===f}),style:{"--color-bg":g,"--color-border":g}}),(0,d.jsxs)("div",{className:(0,i.cn)("flex flex-1 justify-between leading-none",u?"items-end":"items-center"),children:[(0,d.jsxs)("div",{className:"grid gap-1.5",children:[u?t:null,(0,d.jsx)("span",{className:"text-muted-foreground",children:e?.label||a.name})]}),a.value&&(0,d.jsx)("span",{className:"text-foreground font-mono font-medium tabular-nums",children:a.value.toLocaleString()})]})]})},a.dataKey)})})]})}function p(a,b,c){if("object"!=typeof b||null===b)return;let d="payload"in b&&"object"==typeof b.payload&&null!==b.payload?b.payload:void 0,e=c;return c in b&&"string"==typeof b[c]?e=b[c]:d&&c in d&&"string"==typeof d[c]&&(e=d[c]),e in a?a[e]:a[c]}h.s},33305:(a,b,c)=>{"use strict";c.d(b,{Cf:()=>l,Es:()=>n,L3:()=>o,c7:()=>m,lG:()=>h,rr:()=>p,zM:()=>i});var d=c(21124);c(38301);var e=c(6843),f=c(47089),g=c(67442);function h({...a}){return(0,d.jsx)(e.bL,{"data-slot":"dialog",...a})}function i({...a}){return(0,d.jsx)(e.l9,{"data-slot":"dialog-trigger",...a})}function j({...a}){return(0,d.jsx)(e.ZL,{"data-slot":"dialog-portal",...a})}function k({className:a,...b}){return(0,d.jsx)(e.hJ,{"data-slot":"dialog-overlay",className:(0,g.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...b})}function l({className:a,children:b,...c}){return(0,d.jsxs)(j,{"data-slot":"dialog-portal",children:[(0,d.jsx)(k,{}),(0,d.jsxs)(e.UC,{"data-slot":"dialog-content",className:(0,g.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border-none p-6 shadow-lg duration-200 sm:max-w-lg",a),...c,children:[b,(0,d.jsxs)(e.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,d.jsx)(f.A,{}),(0,d.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function m({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"dialog-header",className:(0,g.cn)("flex flex-col gap-2 text-center sm:text-left",a),...b})}function n({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"dialog-footer",className:(0,g.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...b})}function o({className:a,...b}){return(0,d.jsx)(e.hE,{"data-slot":"dialog-title",className:(0,g.cn)("text-lg leading-none font-semibold",a),...b})}function p({className:a,...b}){return(0,d.jsx)(e.VY,{"data-slot":"dialog-description",className:(0,g.cn)("text-muted-foreground text-sm",a),...b})}},33847:(a,b,c)=>{"use strict";c.d(b,{T:()=>f});var d=c(21124);c(38301);var e=c(67442);function f({className:a,...b}){return(0,d.jsx)("textarea",{"data-slot":"textarea",className:(0,e.cn)("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...b})}},35210:(a,b,c)=>{"use strict";c.d(b,{U:()=>h,_:()=>i});var d=c(21124),e=c(38301),f=c(42830);let g=(0,e.createContext)(void 0);function h({children:a,defaultUserId:b,defaultOrganizationId:c,createJobHandler:h}){let[i,j]=(0,e.useState)(!1),[k,l]=(0,e.useState)(),[m,n]=(0,e.useState)(null),o=(0,e.useCallback)(()=>{j(!1),l(void 0)},[]),p=(0,e.useCallback)(async a=>{if(!a)return void f.oR.error("Invalid job data");if(h){await h(a),f.oR.success("Job created successfully"),o();return}let d=localStorage.getItem("dispatcherJobs"),e=d?JSON.parse(d):[],g=e.length,i={id:`job-${Date.now()}`,orderNumber:(g+1).toString().padStart(4,"0"),organizationId:c||"org-vx-001",clientName:a.clientName,propertyAddress:a.propertyAddress,location:a.location||{lat:51.0447,lng:-114.0719},scheduledDate:a.scheduledDate,scheduledTime:a.scheduledTime,mediaType:a.mediaType,priority:a.priority||"standard",status:"pending",estimatedDuration:a.estimatedDuration||120,requirements:a.requirements||"",createdBy:b||"user-001",createdAt:new Date,propertyImage:a.propertyImage||"https://images.unsplash.com/photo-1706808849780-7a04fbac83ef?w=800"},j=[i,...e];localStorage.setItem("dispatcherJobs",JSON.stringify(j)),window.dispatchEvent(new CustomEvent("jobCreated",{detail:i})),f.oR.success("Job created successfully"),o()},[b,c,h,o]),q=(0,e.useCallback)(async a=>{let b=m&&"function"==typeof m?m:p;await b(a)},[m,p]);return(0,d.jsx)(g.Provider,{value:{openJobCreationDialog:a=>{l(a),j(!0)},closeJobCreationDialog:o,setOnSubmit:n,handleJobCreate:q,isOpen:i,initialValues:k,onSubmit:m},children:a})}function i(){let a=(0,e.useContext)(g);if(void 0===a)throw Error("useJobCreation must be used within a JobCreationProvider");return a}},36736:(a,b,c)=>{"use strict";c.d(b,{Bc:()=>g,ZI:()=>j,k$:()=>i,m_:()=>h});var d=c(21124);c(38301);var e=c(85660),f=c(67442);function g({delayDuration:a=200,...b}){return(0,d.jsx)(e.Kq,{"data-slot":"tooltip-provider",delayDuration:a,...b})}function h({...a}){return(0,d.jsx)(g,{children:(0,d.jsx)(e.bL,{"data-slot":"tooltip",...a})})}function i({...a}){return(0,d.jsx)(e.l9,{"data-slot":"tooltip-trigger",...a})}function j({className:a,sideOffset:b=0,children:c,...g}){return(0,d.jsx)(e.ZL,{children:(0,d.jsxs)(e.UC,{"data-slot":"tooltip-content",sideOffset:b,className:(0,f.cn)("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[state=closed]:hidden data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",a),...g,children:[c,(0,d.jsx)(e.i3,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}},40804:(a,b,c)=>{"use strict";c.d(b,{o:()=>C});var d=c(21124),e=c(22544),f=c(19217),g=c(674),h=c(36734),i=c(87278),j=c(52647),k=c(39983),l=c(18310),m=c(46422),n=c(15303),o=c(78583),p=c(72567),q=c(59268),r=c(75535),s=c(67454),t=c(11534),u=c(36736),v=c(31115),w=c(15514),x=c(45119),y=c(99042),z=c(6544),A=c(38301);let B=({status:a,jobId:b,className:c})=>{let e=(a=>{switch(a){case"pending":return{base:"bg-amber-100 dark:bg-amber-900",primary:"bg-amber-400/60",secondary:"bg-orange-400/50",accent:"bg-yellow-300/45",highlight:"bg-amber-500/40"};case"assigned":return{base:"bg-blue-100 dark:bg-blue-900",primary:"bg-blue-400/60",secondary:"bg-indigo-400/50",accent:"bg-cyan-300/45",highlight:"bg-blue-500/40"};case"in_progress":return{base:"bg-violet-100 dark:bg-violet-900",primary:"bg-violet-400/60",secondary:"bg-purple-400/50",accent:"bg-fuchsia-300/45",highlight:"bg-indigo-500/40"};case"editing":return{base:"bg-pink-100 dark:bg-pink-900",primary:"bg-pink-400/60",secondary:"bg-rose-400/50",accent:"bg-fuchsia-300/45",highlight:"bg-pink-500/40"};case"delivered":return{base:"bg-emerald-100 dark:bg-emerald-900",primary:"bg-emerald-400/60",secondary:"bg-teal-400/50",accent:"bg-green-300/45",highlight:"bg-emerald-500/40"};default:return{base:"bg-slate-200 dark:bg-slate-800",primary:"bg-slate-400/60",secondary:"bg-gray-400/50",accent:"bg-zinc-300/45",highlight:"bg-slate-500/40"}}})(a),f=(0,A.useMemo)(()=>{let a=(a=>{let b=0;for(let c=0;c<a.length;c++){let d=a.charCodeAt(c);b=(b<<5)-b+d,b&=b}return()=>(b=((b=Math.imul((b=Math.imul(b^b>>>16,0x85ebca6b))^b>>>13,0xc2b2ae35))^b>>>16)>>>0)%1e3/1e3})(b),c=()=>({top:`${-30+80*a()}%`,left:`${-30+80*a()}%`});return{blob1:{...c(),width:`${65+15*a()}%`,height:`${65+15*a()}%`},blob2:{...c(),width:`${60+15*a()}%`,height:`${60+15*a()}%`},blob3:{...c(),width:`${40+15*a()}%`,height:`${40+15*a()}%`},blob4:{...c(),width:`${25+12*a()}%`,height:`${25+12*a()}%`},rotation1:60*a(),rotation2:60*a(),rotation3:60*a(),rotation4:60*a()}},[b]);return(0,d.jsxs)("div",{className:(0,w.cn)("absolute inset-0 overflow-hidden",e.base,c),children:[(0,d.jsx)("div",{className:(0,w.cn)("absolute rounded-full blur-3xl",e.primary),style:{top:f.blob1.top,left:f.blob1.left,width:f.blob1.width,height:f.blob1.height,transform:`rotate(${f.rotation1}deg)`}}),(0,d.jsx)("div",{className:(0,w.cn)("absolute rounded-full blur-3xl",e.secondary),style:{top:f.blob2.top,left:f.blob2.left,width:f.blob2.width,height:f.blob2.height,transform:`rotate(${f.rotation2}deg)`}}),(0,d.jsx)("div",{className:(0,w.cn)("absolute rounded-full blur-2xl",e.accent),style:{top:f.blob3.top,left:f.blob3.left,width:f.blob3.width,height:f.blob3.height,transform:`rotate(${f.rotation3}deg)`}}),(0,d.jsx)("div",{className:(0,w.cn)("absolute rounded-full blur-2xl",e.highlight),style:{top:f.blob4.top,left:f.blob4.left,width:f.blob4.width,height:f.blob4.height,transform:`rotate(${f.rotation4}deg)`}})]})};function C({job:a,technician:b,currentUserAccountType:c,onViewRankings:A,onClick:C,onViewInProjectManagement:D,selected:E,horizontal:F=!1,hideRequirements:G=!1}){let H=a=>{switch(a){case"photo":default:return h.A;case"video":return i.A;case"aerial":return j.A;case"twilight":return k.A}},I={projectManagerId:a.projectManagerId??void 0,technicianId:a.assignedTechnicianId??void 0,editorId:a.editorId??void 0},{canAssignTechnician:J}=(0,z.FT)(I),K=(a=>{switch(a){case"urgent":return{priority:"urgent",icon:l.A,label:"Urgent"};case"rush":return{priority:"rush",icon:m.A,label:"Rush"};default:return{priority:"standard",icon:n.A,label:"Standard"}}})(a.priority),L=(a=>{switch(a){case"pending":return{label:"Pending",status:"pending"};case"assigned":return{label:"Assigned",status:"assigned"};case"in_progress":return{label:"In Progress",status:"in_progress"};case"editing":return{label:"Editing",status:"editing"};case"delivered":return{label:"Delivered",status:"delivered"};case"cancelled":return{label:"Cancelled",status:"cancelled"};default:return{label:a,status:"default"}}})(a.status),M=K.icon,N=a.scheduledDate;try{let[b,c,d]=a.scheduledDate.split("-").map(Number),e=new Date(b,c-1,d);isNaN(e.getTime())||(N=(0,v.GP)(e,"MMM d, yyyy"))}catch(a){}return F?(0,d.jsx)(s.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileHover:{y:-2},transition:{duration:.2},className:"h-full",children:(0,d.jsxs)(x.Zp,{className:(0,w.cn)("group relative bg-transparent rounded-md border-none overflow-hidden transition-all duration-200 w-full h-40",C?"cursor-pointer":"",E&&"ring-0"),onClick:C,children:[(0,d.jsx)("div",{className:"absolute inset-0",children:a.propertyImage&&"delivered"===a.status?(0,d.jsx)(t.oX,{src:a.propertyImage,alt:a.propertyAddress,className:"size-full object-cover group-hover:scale-[1.02] transition-transform duration-300"}):(0,d.jsx)(B,{status:a.status,jobId:a.id,className:"group-hover:scale-[1.02] transition-transform duration-300 pointer-events-none"})}),(0,d.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-card/90 via-card/70 to-transparent"}),(0,d.jsxs)("div",{className:"relative z-10 flex flex-col justify-between h-full p-3",children:[(0,d.jsxs)("div",{className:"relative flex items-start justify-between gap-2",children:[(0,d.jsxs)("div",{className:"flex items-center gap-1.5 h-full",children:[(0,d.jsxs)(e.E,{variant:"secondary",className:(0,w.cn)("flex items-center gap-1 rounded-full backdrop-blur-md! bg-card/60! group-hover:bg-card! transition-colors duration-200","urgent"===K.priority&&"bg-priority-urgent/10 text-priority-urgent","rush"===K.priority&&"bg-priority-rush/10 text-priority-rush","standard"===K.priority&&"bg-priority-standard/10 text-priority-standard"),children:[(0,d.jsx)(M,{className:(0,w.cn)("size-3","urgent"===K.priority&&"text-priority-urgent","rush"===K.priority&&"text-priority-rush","standard"===K.priority&&"text-priority-standard")}),(0,d.jsx)("span",{className:(0,w.cn)("text-[10px] font-medium","urgent"===K.priority&&"text-priority-urgent","rush"===K.priority&&"text-priority-rush","standard"===K.priority&&"text-priority-standard"),children:K.label})]}),a.orderNumber&&(0,d.jsx)(e.E,{variant:"secondary",className:(0,w.cn)("rounded-full backdrop-blur-md! bg-card/60! group-hover:bg-card! transition-colors duration-200","urgent"===K.priority&&"bg-priority-urgent/10 text-priority-urgent","rush"===K.priority&&"bg-priority-rush/10 text-priority-rush","standard"===K.priority&&"bg-priority-standard/10 text-priority-standard"),children:(0,d.jsxs)("span",{className:"text-[10px] font-medium",children:["#",a.orderNumber]})})]}),(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsxs)(e.E,{variant:"secondary",className:"flex items-center gap-1.5 rounded-full backdrop-blur-md! bg-card/60! group-hover:bg-card! transition-colors duration-200",children:[(0,d.jsx)("div",{className:(0,w.cn)("size-1.5 rounded-full","pending"===L.status&&"bg-status-pending","assigned"===L.status&&"bg-status-assigned","in_progress"===L.status&&"bg-status-in-progress","editing"===L.status&&"bg-status-editing","delivered"===L.status&&"bg-status-delivered",("cancelled"===L.status||"default"===L.status)&&"bg-status-cancelled")}),(0,d.jsx)("span",{className:(0,w.cn)("text-[10px] font-medium","pending"===L.status&&"text-status-pending","assigned"===L.status&&"text-status-assigned","in_progress"===L.status&&"text-status-in-progress","editing"===L.status&&"text-status-editing","delivered"===L.status&&"text-status-delivered",("cancelled"===L.status||"default"===L.status)&&"text-status-cancelled"),children:L.label})]}),D&&(0,d.jsxs)(e.E,{onClick:a=>{a.stopPropagation(),D()},className:"items-center gap-1.5 rounded-full px-1! bg-primary/10! text-primary-foreground hidden! group-hover:block! hover:bg-primary/50! active:bg-primary/80 active:scale-[0.97]",children:[(0,d.jsx)(o.A,{className:"size-3 text-primary-foreground"}),(0,d.jsx)("span",{className:"sr-only",children:"View in job management"})]})]})]}),(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)(u.m_,{children:[(0,d.jsx)(u.k$,{asChild:!0,children:(0,d.jsx)("h3",{className:"text-sm font-semibold text-foreground leading-tight line-clamp-1",children:a.propertyAddress})}),(0,d.jsx)(u.ZI,{side:"top",className:"max-w-xs",children:(0,d.jsx)(y.P,{className:"wrap-break-word",children:a.propertyAddress})})]}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground",children:a.clientName}),(0,d.jsxs)("div",{className:"flex items-center justify-between pt-1",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[(0,d.jsxs)("div",{className:"inline-flex items-center gap-1",children:[(0,d.jsx)(p.A,{className:"size-3"}),(0,d.jsx)("span",{children:N})]}),(0,d.jsxs)("div",{className:"inline-flex items-center gap-1",children:[(0,d.jsx)(n.A,{className:"size-3"}),(0,d.jsx)("span",{children:a.scheduledTime})]})]}),(0,d.jsx)("div",{className:"flex items-center gap-1.5",children:a.mediaType.map(a=>{let b=H(a);return(0,d.jsxs)(u.m_,{children:[(0,d.jsx)(u.k$,{asChild:!0,children:(0,d.jsx)("div",{className:"p-1 rounded-full backdrop-blur-md! bg-card/60! group-hover:bg-card! transition-colors duration-200",children:(0,d.jsx)(b,{className:"size-3 text-muted-foreground"})})}),(0,d.jsx)(u.ZI,{side:"top",className:"capitalize",children:a})]},a)})})]})]})]})]})}):(0,d.jsx)(s.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileHover:{y:-2},transition:{duration:.2},className:(0,w.cn)("h-full cursor-pointer!"),children:(0,d.jsxs)(x.Zp,{className:(0,w.cn)("group relative flex flex-col bg-transparent rounded-md border-none overflow-hidden transition-all duration-200 size-full"),onClick:C,children:[(0,d.jsxs)(x.aR,{className:"relative flex flex-col justify-between w-full aspect-video shrink-0 overflow-hidden p-2! rounded-b-md",children:[a.propertyImage&&"delivered"===a.status?(0,d.jsx)(t.oX,{src:a.propertyImage,alt:a.propertyAddress,className:"size-full object-cover absolute top-0 left-0 pointer-events-none group-hover:scale-[1.04] transition-transform duration-200"}):(0,d.jsx)(B,{status:a.status,jobId:a.id,className:"group-hover:scale-[1.04] transition-transform duration-300 pointer-events-none"}),(0,d.jsxs)("div",{className:"flex relative w-full z-10",children:[(0,d.jsxs)(e.E,{variant:"secondary",className:(0,w.cn)("flex items-center rounded-full backdrop-blur-md! bg-card/60! group-hover:bg-card! transition-colors duration-200","urgent"===K.priority&&"bg-priority-urgent/10 text-priority-urgent","rush"===K.priority&&"bg-priority-rush/10 text-priority-rush","standard"===K.priority&&"bg-priority-standard/10 text-priority-standard"),children:[(0,d.jsx)(M,{className:(0,w.cn)("size-3.5","urgent"===K.priority&&"text-priority-urgent","rush"===K.priority&&"text-priority-rush","standard"===K.priority&&"text-priority-standard")}),(0,d.jsx)("span",{className:(0,w.cn)("text-[11px] font-medium hidden sm:inline","urgent"===K.priority&&"text-priority-urgent","rush"===K.priority&&"text-priority-rush","standard"===K.priority&&"text-priority-standard"),children:K.label})]}),a.orderNumber&&(0,d.jsx)(e.E,{variant:"secondary",className:(0,w.cn)("flex items-center rounded-full backdrop-blur-md! bg-card/60! group-hover:bg-card! transition-colors duration-200","urgent"===K.priority&&"bg-priority-urgent/10 text-priority-urgent","rush"===K.priority&&"bg-priority-rush/10 text-priority-rush","standard"===K.priority&&"bg-priority-standard/10 text-priority-standard"),children:(0,d.jsxs)("span",{className:"text-[11px] font-medium",children:["#",a.orderNumber]})}),D&&(0,d.jsx)("div",{className:"flex absolute right-0 z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:(0,d.jsxs)(f.$,{size:"icon",className:"rounded-full bg-primary text-primary-foreground hover:bg-primary/90 active:bg-primary/80 active:scale-[0.97]",onClick:a=>{a.stopPropagation(),D()},children:[(0,d.jsx)(o.A,{className:"size-3.5"}),(0,d.jsx)("span",{className:"sr-only",children:"View in job management"})]})})]}),(b||J)&&(0,d.jsx)("div",{className:"flex z-10 self-center w-full",children:b?(0,d.jsxs)("div",{className:"flex items-center gap-3 pl-1 pr-3 py-1 backdrop-blur-md! bg-card/60! group-hover:bg-card! transition-colors duration-200 rounded-full max-w-[80%] mx-auto h-auto",children:[(0,d.jsxs)(g.eu,{className:"size-8",children:[(0,d.jsx)(g.BK,{src:b.avatar,alt:b.name}),(0,d.jsx)(g.q5,{className:"bg-muted-foreground/20 text-foreground text-xs",children:b.name.split(" ").map(a=>a[0]).join("")})]}),(0,d.jsx)("div",{className:"flex flex-col gap-0.5 min-w-0 flex-1",children:(0,d.jsxs)("div",{className:"inline-flex items-center gap-1.5",children:[(0,d.jsx)("span",{className:"text-sm font-semibold leading-[1.4] text-foreground truncate",children:b.name}),(0,d.jsx)(q.A,{className:"h-3.5 w-3.5 text-primary shrink-0"})]})})]}):J&&A&&(0,d.jsxs)(f.$,{onClick:a=>{a.stopPropagation(),A()},className:"w-full h-auto max-w-[80%] mx-auto px-4 py-2.5 bg-primary text-primary-foreground rounded-3xl shadow-lg hover:bg-primary/90 border-0",children:[(0,d.jsx)("span",{className:"text-sm font-semibold",children:"Find Technician"}),(0,d.jsx)(r.A,{className:"size-4 ml-2"})]})})]}),(0,d.jsxs)(x.Wu,{className:"px-4! py-4! flex flex-col gap-2 relative",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between w-full gap-2",children:[(0,d.jsxs)(e.E,{variant:"flat",className:"flex items-center gap-1.5 mb-1 px-0",children:[(0,d.jsx)("div",{className:(0,w.cn)("size-1.5 rounded-full","pending"===L.status&&"bg-status-pending","assigned"===L.status&&"bg-status-assigned","in_progress"===L.status&&"bg-status-in-progress","editing"===L.status&&"bg-status-editing","delivered"===L.status&&"bg-status-delivered",("cancelled"===L.status||"default"===L.status)&&"bg-status-cancelled")}),(0,d.jsx)("span",{className:(0,w.cn)("text-[13px] font-medium leading-[1.4]","pending"===L.status&&"text-status-pending","assigned"===L.status&&"text-status-assigned","in_progress"===L.status&&"text-status-in-progress","editing"===L.status&&"text-status-editing","delivered"===L.status&&"text-status-delivered",("cancelled"===L.status||"default"===L.status)&&"text-status-cancelled"),children:L.label})]}),(0,d.jsx)("div",{className:"flex items-center gap-2",children:a.mediaType.map(a=>{let b=H(a);return(0,d.jsx)("div",{className:"inline-flex items-center gap-1",children:(0,d.jsxs)(u.m_,{children:[(0,d.jsx)(u.k$,{asChild:!0,children:(0,d.jsx)(b,{className:"h-4 w-4 text-muted-foreground"})}),(0,d.jsx)(u.ZI,{side:"top",className:"max-w-xs capitalize",children:a})]})},a)})})]}),(0,d.jsxs)("div",{className:"space-y-1 mb-2",children:[(0,d.jsx)(y.P,{className:"text-[13px] leading-[1.4] text-muted-foreground line-clamp-2",children:a.propertyAddress}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground",children:a.clientName})]}),(0,d.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,d.jsxs)("div",{className:"inline-flex items-center gap-1.5",children:[(0,d.jsx)(p.A,{className:"h-4 w-4 text-muted-foreground"}),(0,d.jsx)("span",{className:"text-[13px] leading-[1.4] text-muted-foreground",children:N})]}),(0,d.jsxs)("div",{className:"inline-flex items-center gap-1.5",children:[(0,d.jsx)(n.A,{className:"h-4 w-4 text-muted-foreground"}),(0,d.jsx)("span",{className:"text-[13px] leading-[1.4] text-muted-foreground",children:a.scheduledTime})]})]}),!G&&a.requirements&&(0,d.jsx)("div",{className:"mt-2 pt-2 border-t border-border",children:(0,d.jsx)(y.P,{className:"text-[13px] leading-[1.4] text-muted-foreground line-clamp-2",children:a.requirements})})]})]})})}},44303:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>aJ});var d=c(21124),e=c(85956),f=c(55224),g=c(35210),h=c(52962),i=c(85948),j=c(56663),k=c(49037),l=c(65749),m=c(45523),n=c(42378),o=c(19217),p=c(674),q=c(57991),r=c(9188),s=c(8849),t=c(10578),u=c(94684),v=c(70175),w=c(60988),x=c(34487),y=c(19710),z=c(33201),A=c(45334),B=c(30728),C=c(71613),D=c(78733),E=c(74331),F=c(99035),G=c(76577),H=c(38301),I=c(42830),J=c(22544);function K({variant:a="sidebar",onOrgHome:b}){let{user:c}=(0,z.A)(),{memberships:e,isLoading:f,setActiveOrganization:g}=(0,F.G)(),{activeOrganizationId:h}=(0,G.Q)(),i=(0,n.useRouter)(),j=a=>a.organization?.type==="PERSONAL",k=(0,H.useMemo)(()=>e.find(a=>j(a)),[e]),m=(0,H.useMemo)(()=>[...k?[k]:[],...e.filter(a=>{if(j(a))return!1;if(c?.accountType==="AGENT"){let b=a.organization?.type==="COMPANY",c="CUSTOMER"===String(a.role||a.orgRole||"")||"customer"===a.relationship;if(b&&c)return!1}return!0})],[e,k,c?.accountType]),s="expanded";try{s=(0,l.cL)()?.state}catch{s="expanded"}let t=(0,H.useMemo)(()=>e.find(a=>a.orgId===h)?.organization,[e,h]),v=(0,H.useMemo)(()=>e.find(a=>a.orgId===h),[e,h]),w=(0,H.useMemo)(()=>{if(!v?.organization)return!1;let a=v.organization.type,b=v.orgRole||v.role||"";return"COMPANY"===a?"OWNER"===b||"ADMIN"===b:"PERSONAL"===a&&"OWNER"===b},[v]),x="header"===a||"collapsed"!==s;return(0,d.jsxs)(r.rI,{children:[(0,d.jsx)(r.ty,{asChild:!0,children:(0,d.jsx)(o.$,{variant:"ghost",className:"h-auto justify-between text-left pl-1.5! pr-2.5! py-0!",children:(0,d.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer w-full",children:[(0,d.jsxs)(p.eu,{className:"size-8",children:[(0,d.jsx)(p.BK,{src:t?.logoUrl,alt:t?.name}),(0,d.jsx)(p.q5,{children:(0,d.jsx)(A.A,{className:"size-3"})})]}),x&&(0,d.jsx)("div",{className:"flex flex-col items-start",children:(0,d.jsx)("span",{className:"text-sm font-medium",children:h?t?.name||"Select organization":"Personal workspace"})}),x&&(0,d.jsx)(B.A,{className:"size-3 text-muted-foreground ml-auto"})]})})}),(0,d.jsxs)(r.SQ,{className:"w-72 max-h-[400px]",align:"start",side:(0,q.a)()?"bottom":"right",children:[(0,d.jsx)(r.lp,{children:"Organizations"}),(0,d.jsx)(r.mB,{}),(0,d.jsxs)(r.I,{children:[f&&(0,d.jsx)("div",{className:"px-2 py-1.5 text-sm text-muted-foreground",children:"Loading..."}),!f&&0===e.length&&(0,d.jsx)("div",{className:"px-2 py-1.5 text-sm text-muted-foreground",children:"No organizations found"}),!f&&m.map(a=>{let b=j(a);return(0,d.jsxs)(r._2,{onClick:()=>{var b;g(b=a.orgId),null!==b&&i.push("/dashboard")},className:"flex items-center gap-2 cursor-pointer",children:[(0,d.jsxs)(p.eu,{className:"size-8",children:[!b&&(0,d.jsx)(p.BK,{src:a.organization?.logoUrl}),(0,d.jsx)(p.q5,{children:b?(0,d.jsx)(B.A,{className:"size-4"}):(0,d.jsx)(A.A,{className:"size-4"})})]}),(0,d.jsxs)("div",{className:"flex flex-col flex-1 min-w-0",children:[(0,d.jsx)("span",{className:"text-sm font-medium truncate",children:b?"Personal workspace":a.organization?.name||a.orgId}),!b&&(0,d.jsx)(J.E,{variant:"muted",className:"truncate",children:a.role?.replaceAll("_"," ")||"Member"})]}),a.orgId===h&&(0,d.jsx)(C.A,{className:"size-4 text-primary ml-auto shrink-0"})]},a.orgId)})]}),(0,d.jsx)(r.mB,{}),(0,d.jsxs)(r.I,{children:[b&&(0,d.jsxs)(r._2,{onClick:b,children:[(0,d.jsx)(D.A,{className:"size-4 mr-2"}),e.find(a=>a.orgId===h)?.organization?.type==="COMPANY"?"Company home":"Workspace home"]}),w&&(0,d.jsxs)(r._2,{onClick:()=>{let a=h||k?.orgId;a?i.push(`/organization/${a}/settings`):i.push("/organization")},children:[(0,d.jsx)(u.A,{className:"size-4 mr-2"}),v?.organization?.type==="COMPANY"?"Company settings":"Workspace settings"]}),c?.accountType==="PROVIDER"&&v&&j(v)&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(r.mB,{}),(0,d.jsxs)(r._2,{onClick:()=>{I.oR.info("Join request sent (mock)")},disabled:!0,children:[(0,d.jsx)(E.A,{className:"size-4 mr-2"}),"Join company",(0,d.jsx)("span",{className:"ml-auto text-xs text-muted-foreground",children:"Coming soon"})]})]})]})]})]})}var L=c(11489),M=c(44688),N=c(75219),O=c(70045),P=c(16945),Q=c(71179),R=c(47268),S=c(4492),T=c(47089),U=c(59405),V=c(9212),W=c(16636),X=c(78583),Y=c(88020),Z=c(72966),$=c(60874),_=c(49315),aa=c(15514),ab=c(73009);function ac(a){return"GROUPED_MESSAGES"===a.type}function ad({className:a}){let b=(0,n.useRouter)(),{activeOrganizationId:c,switchOrganization:e,user:f,memberships:g}=(0,z.A)(),{notifications:h,unreadCount:i,isLoading:j,markAsRead:l,markAllAsRead:m,acceptInvitation:p,declineInvitation:q,refetch:s}=(0,ab.E)(),{status:t,getOverallProgress:u,resetProgress:v,dismissGuide:w,refetchStatus:x}=(0,k.Mw)(),[y,B]=(0,H.useState)(!1),[D,E]=(0,H.useState)(new Set),[F,G]=(0,H.useState)(!1),[I,K]=(0,H.useState)(!1),ad=(0,H.useCallback)(a=>{B(a),a&&s()},[s]),ae=async a=>{if(a.invitationId){E(b=>new Set(b).add(a.id));try{await p(a.id,a.invitationId),window.location.reload()}catch(a){console.error("Failed to accept invitation:",a)}finally{E(b=>{let c=new Set(b);return c.delete(a.id),c})}}},af=async a=>{if(a.invitationId){E(b=>new Set(b).add(a.id));try{await q(a.id,a.invitationId)}catch(a){console.error("Failed to decline invitation:",a)}finally{E(b=>{let c=new Set(b);return c.delete(a.id),c})}}},ag=async a=>{b.push(`/organization/${a.orgId}/preview`),B(!1)},ah=async a=>{if(!a.projectId)return;try{await l(a.id)}catch(a){console.error("Failed to mark notification as read:",a)}if("PROJECT_DELIVERED"===a.type&&a.deliveryToken){b.push(`/delivery/${a.deliveryToken}`),B(!1);return}a.orgId&&a.orgId!==c&&e(a.orgId);let d=`/jobs/${a.projectId}`,f=new URLSearchParams;"NEW_MESSAGE"===a.type&&(f.set("tab","discussion"),a.messageChannel&&f.set("chat","CUSTOMER"===a.messageChannel?"client":"team")),f.toString()&&(d+=`?${f.toString()}`),b.push(d),B(!1)},ai=async a=>{try{await Promise.all(a.notifications.filter(a=>!a.readAt).map(a=>l(a.id)))}catch(a){console.error("Failed to mark notifications as read:",a)}let d=a.latestNotification.orgId;d&&d!==c&&e(d);let f=`/jobs/${a.projectId}`,g=new URLSearchParams;g.set("tab","discussion");let h=a.latestNotification.messageChannel;h&&g.set("chat","CUSTOMER"===h?"client":"team"),f+=`?${g.toString()}`,b.push(f),B(!1)},aj=(0,H.useMemo)(()=>{let a=new Map,b=[];for(let c of h)if("NEW_MESSAGE"===c.type&&c.projectId){let b=a.get(c.projectId)||[];b.push(c),a.set(c.projectId,b)}else b.push(c);let c=[...b];for(let[b,d]of a)if(1===d.length)c.push(d[0]);else{let a=d.sort((a,b)=>new Date(b.createdAt).getTime()-new Date(a.createdAt).getTime())[0];c.push({type:"GROUPED_MESSAGES",projectId:b,projectAddress:a.projectAddress,notifications:d,messageCount:d.length,unreadCount:d.filter(a=>!a.readAt).length,latestNotification:a})}return c.sort((a,b)=>{let c=ac(a)?new Date(a.latestNotification.createdAt).getTime():new Date(a.createdAt).getTime();return(ac(b)?new Date(b.latestNotification.createdAt).getTime():new Date(b.createdAt).getTime())-c})},[h]),ak=u(),al=t?.hasCompletedSetup??!1,am=t?.dismissedGuide??!1,an=f?.accountType?.toUpperCase()==="COMPANY",ao=(0,H.useMemo)(()=>g.find(a=>a.organization?.type==="PERSONAL"||a.organization?.type==="PERSONAL"),[g]),ap=(0,H.useCallback)(()=>{ao?.orgId&&ao.orgId!==c&&e(ao.orgId),b.push("/dashboard"),setTimeout(()=>{let a=document.querySelector('[data-tour="setup-guide"]');a&&a.scrollIntoView({behavior:"smooth",block:"start"})},500)},[ao,c,e,b]),aq=async()=>{G(!0);try{await v(),await x(),B(!1),ap()}catch(a){console.error("Failed to reset tour:",a)}finally{G(!1)}},ar=async()=>{try{await w(),await x()}catch(a){console.error("Failed to dismiss tour:",a)}},as=async()=>{K(!0);try{await m()}catch(a){console.error("Failed to mark all as read:",a)}finally{K(!1)}};return(0,d.jsxs)(r.rI,{open:y,onOpenChange:ad,children:[(0,d.jsx)(r.ty,{asChild:!0,children:(0,d.jsxs)(o.$,{variant:"ghost",size:"icon",className:(0,aa.cn)("relative",a),"aria-label":"Notifications",children:[(0,d.jsx)(R.A,{className:"h-5 w-5"}),i>0&&(0,d.jsx)(J.E,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-xs",children:i>9?"9+":i})]})}),(0,d.jsxs)(r.SQ,{align:"end",className:"w-80",children:[!am&&!an&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"p-3",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,d.jsx)(S.A,{className:"h-4 w-4 text-primary"}),(0,d.jsx)("span",{className:"text-sm font-medium",children:"Setup Guide"}),al&&(0,d.jsx)(J.E,{variant:"secondary",className:"ml-auto text-xs",children:"Complete"}),(0,d.jsx)(o.$,{size:"sm",variant:"ghost",className:(0,aa.cn)("h-6 w-6 p-0",al?"":"ml-auto"),onClick:ar,title:"Dismiss guide",children:(0,d.jsx)(T.A,{className:"h-3 w-3"})})]}),!al&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,d.jsx)(Y.k,{value:ak.percentage,className:"h-1.5 flex-1"}),(0,d.jsxs)("span",{className:"text-xs text-muted-foreground",children:[ak.completed,"/",ak.total]})]}),(0,d.jsxs)(o.$,{size:"sm",variant:"outline",className:"w-full h-8 text-xs",onClick:()=>{B(!1),ap()},children:["Continue Setup",(0,d.jsx)(U.A,{className:"h-3 w-3 ml-1"})]})]}),al&&(0,d.jsx)("div",{className:"flex gap-2",children:(0,d.jsxs)(o.$,{size:"sm",variant:"ghost",className:"flex-1 h-8 text-xs",onClick:aq,disabled:F,children:[F?(0,d.jsx)($.y,{className:"h-3 w-3 mr-1"}):(0,d.jsx)(V.A,{className:"h-3 w-3 mr-1"}),"Restart Guide"]})}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"You can always restart the guide from Settings."})]}),(0,d.jsx)(r.mB,{})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between px-2 py-1.5",children:[(0,d.jsx)(r.lp,{className:"font-semibold p-0",children:"Notifications"}),i>0&&(0,d.jsx)(o.$,{size:"sm",variant:"ghost",className:"h-6 text-xs text-muted-foreground hover:text-foreground",onClick:as,disabled:I,children:I?(0,d.jsx)($.y,{className:"h-3 w-3"}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(W.A,{className:"h-3 w-3 mr-1"}),"Mark all read"]})})]}),(0,d.jsx)(r.mB,{}),j&&0===h.length?(0,d.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,d.jsx)($.y,{className:"h-6 w-6"})}):0===aj.length?(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[(0,d.jsx)(R.A,{className:"h-8 w-8 mb-2 opacity-50"}),(0,d.jsx)("p",{className:"text-sm",children:"All caught up!"})]}):(0,d.jsx)(Z.F,{className:"max-h-[400px]",children:(0,d.jsx)("div",{className:"flex flex-col",children:aj.map(a=>{let b;if(ac(a)){let b=a.projectAddress||`Project ${a.projectId.substring(0,8)}...`;return(0,d.jsxs)("div",{className:(0,aa.cn)("flex flex-col gap-2 p-3 border-b last:border-b-0 hover:bg-muted/50 transition-colors",a.unreadCount>0&&"bg-muted/30"),children:[(0,d.jsxs)("div",{className:"flex items-start gap-3",children:[(0,d.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(0,d.jsx)(M.A,{className:"h-4 w-4 text-green-500"})}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsxs)("p",{className:"text-sm font-medium leading-tight",children:[a.messageCount," new messages"]}),a.unreadCount>0&&(0,d.jsxs)(J.E,{variant:"secondary",className:"h-5 text-xs px-1.5",children:[a.unreadCount," unread"]})]}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground mt-0.5",children:b}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:(0,_.m)(a.latestNotification.createdAt,{addSuffix:!0})})]})]}),(0,d.jsx)("div",{className:"flex items-center gap-2 ml-7",children:(0,d.jsxs)(o.$,{size:"sm",variant:"outline",className:"h-7 text-xs",onClick:()=>ai(a),children:[(0,d.jsx)(X.A,{className:"h-3 w-3 mr-1"}),"View Project"]})})]},`grouped-${a.projectId}`)}let c=D.has(a.id);return(0,d.jsxs)("div",{className:(0,aa.cn)("flex flex-col gap-2 p-3 border-b last:border-b-0 hover:bg-muted/50 transition-colors",!a.readAt&&"bg-muted/30"),children:[(0,d.jsxs)("div",{className:"flex items-start gap-3",children:[(0,d.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(a=>{switch(a){case"PROJECT_ASSIGNED":return(0,d.jsx)(L.A,{className:"h-4 w-4 text-blue-500"});case"NEW_MESSAGE":return(0,d.jsx)(M.A,{className:"h-4 w-4 text-green-500"});case"PROJECT_APPROVED":return(0,d.jsx)(N.A,{className:"h-4 w-4 text-emerald-500"});case"PROJECT_DELIVERED":return(0,d.jsx)(O.A,{className:"h-4 w-4 text-primary"});case"CHANGES_REQUESTED":return(0,d.jsx)(P.A,{className:"h-4 w-4 text-amber-500"});case"DELIVERY_COMMENT":return(0,d.jsx)(Q.A,{className:"h-4 w-4 text-blue-500"});default:return(0,d.jsx)(A.A,{className:"h-4 w-4 text-purple-500"})}})(a.type)}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("p",{className:"text-sm font-medium leading-tight",children:(a=>{switch(a.type){case"INVITATION_MEMBER":return`Invited to join ${a.orgName}`;case"INVITATION_CUSTOMER":return`Invited as customer of ${a.orgName}`;case"PROJECT_ASSIGNED":return"Assigned to project";case"NEW_MESSAGE":return"New message in project";case"PROJECT_APPROVED":return"Project approved";case"PROJECT_DELIVERED":return"Your media is ready";case"CHANGES_REQUESTED":return"Changes requested";case"DELIVERY_COMMENT":return"New delivery comment";default:return"Notification"}})(a)}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground mt-0.5 line-clamp-2",children:(a=>{switch(a.type){case"INVITATION_MEMBER":return a.role?`Role: ${a.role}`:"Join as a team member";case"INVITATION_CUSTOMER":return"Become a customer of this organization";case"PROJECT_ASSIGNED":let b=a.assignedRole?a.assignedRole.replace("_"," ").toLowerCase():"team member";return a.projectAddress?`As ${b} at ${a.projectAddress}`:`As ${b}`;case"NEW_MESSAGE":let c="CUSTOMER"===a.messageChannel?"Customer":"Team",d=a.projectAddress||(a.projectId?`Project ${a.projectId.substring(0,8)}...`:"");if(a.messagePreview){let b=a.messagePreview.replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/<[^>]*>/g,"").trim(),e=b.substring(0,50),f=d?`${d}  `:"";return`${f}${c}: "${e}${b.length>50?"...":""}"`}return d?`${d}  New message in ${c} channel`:`New message in ${c} channel`;case"PROJECT_APPROVED":return a.approverName?`Approved by ${a.approverName}${a.projectAddress?` - ${a.projectAddress}`:""}`:a.projectAddress||"Project delivery approved";case"PROJECT_DELIVERED":return a.projectAddress?`${a.orgName} has delivered your media for ${a.projectAddress}`:`${a.orgName} has delivered your media`;case"CHANGES_REQUESTED":return a.projectAddress?`Customer requested changes for ${a.projectAddress}`:"Customer requested changes on the delivery";case"DELIVERY_COMMENT":return a.messagePreview?`"${a.messagePreview.substring(0,50)}${a.messagePreview.length>50?"...":""}"`:a.projectAddress||"New comment on delivery";default:return""}})(a)}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:(0,_.m)(a.createdAt,{addSuffix:!0})})]})]}),(0,d.jsx)("div",{className:"flex items-center gap-2 ml-7",children:"INVITATION_MEMBER"===(b=a.type)||"INVITATION_CUSTOMER"===b?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(o.$,{size:"sm",variant:"default",className:"h-7 text-xs",onClick:()=>ae(a),disabled:c,children:c?(0,d.jsx)($.y,{className:"h-3 w-3"}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(C.A,{className:"h-3 w-3 mr-1"}),"Accept"]})}),(0,d.jsxs)(o.$,{size:"sm",variant:"outline",className:"h-7 text-xs",onClick:()=>af(a),disabled:c,children:[(0,d.jsx)(T.A,{className:"h-3 w-3 mr-1"}),"Decline"]}),(0,d.jsxs)(o.$,{size:"sm",variant:"ghost",className:"h-7 text-xs",onClick:()=>ag(a),children:[(0,d.jsx)(X.A,{className:"h-3 w-3 mr-1"}),"View"]})]}):(0,d.jsxs)(o.$,{size:"sm",variant:"outline",className:"h-7 text-xs",onClick:()=>ah(a),children:[(0,d.jsx)(X.A,{className:"h-3 w-3 mr-1"}),"PROJECT_DELIVERED"===a.type?"View Delivery":"View Project"]})})]},a.id)})})})]})]})}function ae(){try{(0,l.cL)()}catch{return null}return(0,d.jsx)(l.x2,{})}function af({user:a,showNewJobButton:b=!1,onNewJobClick:c,uiContext:e}){let{theme:f,setTheme:h}=(0,m.D)(),{logout:i,activeOrganizationId:j}=(0,z.A)(),k=(0,g._)(),l=(0,n.useRouter)(),A=(0,n.usePathname)(),B=(0,q.a)(),{showSidebar:C,navItems:D,canCreateOrder:E,createActionLabel:F,createActionPath:G,accountType:H}=e||{showSidebar:!1,navItems:[],canCreateOrder:!1,createActionLabel:"New Job",createActionPath:"/jobs/new",accountType:"AGENT"},I=()=>{"AGENT"===H?l.push(G):c?c():k.openJobCreationDialog()},J=()=>{l.push(j?`/organization/${j}`:"/organization")};return(0,d.jsx)("header",{className:"sticky top-0 z-50 flex items-center border-none! border-b bg-card/80 backdrop-blur-xl w-full pl-2 pr-4 h-header-h",children:(0,d.jsx)("div",{className:"w-full max-w-full",children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("div",{className:"flex items-center gap-3",children:C?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(K,{variant:"header",onOrgHome:J}),!B&&(0,d.jsx)(ae,{})]}):(0,d.jsx)(K,{variant:"header",onOrgHome:J})}),(0,d.jsxs)("div",{className:"flex items-center gap-4",children:[!C&&!B&&D.length>0&&(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[D.map(a=>{var b;return(0,d.jsx)(o.$,{variant:("/dashboard"===(b=a.path)?"/dashboard"===A:"/orders"===b?"/orders"===A||A?.startsWith("/orders/"):"/jobs/all-jobs"===b?A?.startsWith("/jobs"):A?.startsWith(b))?"activeFlat":"mutedFlat",size:"sm",onClick:()=>l.push(a.path),children:a.label},a.path)}),E&&(0,d.jsxs)(o.$,{variant:A===G?"activeFlat":"mutedFlat",size:"sm",onClick:I,className:"gap-1",children:[(0,d.jsx)(s.A,{className:"h-4 w-4"}),F]})]}),C&&!B&&b&&(0,d.jsxs)(o.$,{onClick:I,size:"sm",className:"gap-2",variant:"mutedFlat",children:[(0,d.jsx)(s.A,{className:"h-4 w-4"}),F]}),("AGENT"===H||"PROVIDER"===H||"COMPANY"===H)&&(0,d.jsx)(ad,{}),(0,d.jsxs)(r.rI,{children:[(0,d.jsx)(r.ty,{asChild:!0,children:(0,d.jsx)(o.$,{variant:"ghost",className:"flex items-center gap-3 h-auto p-0",children:(0,d.jsxs)(p.eu,{className:"size-9 border-2 border-border",children:[(0,d.jsx)(p.BK,{src:a?.avatarUrl||""}),(0,d.jsx)(p.q5,{className:"bg-primary text-primary-foreground text-xs",children:a?.name?a.name.split(" ").map(a=>a[0]).join(""):"U"})]})})}),(0,d.jsxs)(r.SQ,{align:"end",className:"w-56",children:[(0,d.jsx)(r.lp,{children:(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"text-sm",children:a?.name||"User"}),(0,d.jsx)("div",{className:"text-xs text-muted-foreground",children:a?.email||"email@example.com"})]})}),(0,d.jsx)(r.mB,{}),(0,d.jsxs)(r._2,{onClick:()=>l.push("/profile"),children:[(0,d.jsx)(t.A,{className:"h-4 w-4 mr-2"}),"Profile"]}),(0,d.jsxs)(r._2,{onClick:()=>{l.push("/settings")},children:[(0,d.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Settings"]}),(0,d.jsx)(r.mB,{}),(0,d.jsx)(r.lp,{children:"Theme"}),(0,d.jsxs)(r.Hr,{value:f,onValueChange:h,children:[(0,d.jsxs)(r.Ht,{value:"light",children:[(0,d.jsx)(v.A,{className:"h-4 w-4 mr-2"}),"Light"]}),(0,d.jsxs)(r.Ht,{value:"dark",children:[(0,d.jsx)(w.A,{className:"h-4 w-4 mr-2"}),"Dark"]}),(0,d.jsxs)(r.Ht,{value:"system",children:[(0,d.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"System"]})]}),(0,d.jsx)(r.mB,{}),(0,d.jsxs)(r._2,{onClick:()=>{localStorage.removeItem("accountType"),i()},children:[(0,d.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Log out"]})]})]})]})]})})})}c(99042);var ag=c(77850),ah=c(69957),ai=c(72567),aj=c(67442);let ak={LayoutDashboard:ag.A,Briefcase:L.A,MapPin:ah.A,Calendar:ai.A,Package:O.A,MessageSquare:M.A},al=[{path:"/dashboard",icon:"LayoutDashboard",label:"Dashboard"},{path:"/jobs",icon:"Briefcase",label:"Jobs"},{path:"/map",icon:"MapPin",label:"Map"},{path:"/calendar",icon:"Calendar",label:"Calendar"}];function am({uiContext:a}){let b=(0,n.usePathname)(),c=(0,n.useRouter)(),e=(0,g._)(),{showSidebar:f=!0,navItems:h=[],canCreateOrder:i=!1,createActionPath:j="/jobs/new",accountType:k="AGENT"}=a||{},l=(f?al:h.length>0?h:al).slice(0,4),m=a=>"/dashboard"===a?"/dashboard"===b:"/orders"===a?"/orders"===b||b?.startsWith("/orders/"):"/jobs"===a||"/jobs/all-jobs"===a?b?.startsWith("/jobs"):b?.startsWith(a);return(0,d.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 z-50 md:hidden border-t bg-card/95 backdrop-blur-xl shadow-lg",style:{height:"var(--dock-h)",paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:(0,d.jsxs)("div",{className:"flex items-center justify-around px-2 py-2 max-w-screen-sm mx-auto",children:[l.slice(0,2).map(a=>{let b=ak[a.icon]||ag.A,e=m(a.path);return(0,d.jsxs)("button",{type:"button",className:(0,aj.cn)("flex flex-col items-center justify-center gap-1 size-16 rounded-lg transition-colors relative",e?"bg-primary/10 text-primary":"text-muted-foreground hover:text-foreground hover:bg-accent/50"),onClick:()=>c.push(a.path),"aria-label":a.label,children:[(0,d.jsx)(b,{className:"h-5 w-5"}),(0,d.jsx)("span",{className:"text-xs font-medium",children:a.label})]},a.path)}),(i||"AGENT"===k)&&(0,d.jsx)("button",{type:"button",className:"size-14 rounded-full bg-primary text-primary-foreground shadow-lg hover:shadow-xl transition-all hover:scale-105 flex items-center justify-center",onClick:()=>{"AGENT"===k?c.push(j):e.openJobCreationDialog()},"aria-label":"AGENT"===k?"Create order":"Create new job",children:(0,d.jsx)(s.A,{className:"h-6 w-6"})}),l.slice(2,4).map(a=>{let b=ak[a.icon]||ag.A,e=m(a.path);return(0,d.jsxs)("button",{type:"button",className:(0,aj.cn)("flex flex-col items-center justify-center gap-1 size-16 rounded-lg transition-colors relative",e?"bg-primary/10 text-primary":"text-muted-foreground hover:text-foreground hover:bg-accent/50"),onClick:()=>c.push(a.path),"aria-label":a.label,children:[(0,d.jsx)(b,{className:"h-5 w-5"}),(0,d.jsx)("span",{className:"text-xs font-medium",children:a.label})]},a.path)})]})})}var an=c(3991),ao=c.n(an),ap=c(14910),aq=c(65893),ar=c(74224),as=c(3663),at=c(68324),au=c(46262),av=c(62949);function aw(){let a=(0,n.usePathname)(),{state:b}=(0,l.cL)(),{activeMembership:c}=(0,G.Q)(),e=(c?.role||c?.orgRole||"").toUpperCase(),f=c?.organization?.type||c?.organizationType||"",g="PROJECT_MANAGER"===e&&"PERSONAL"!==f||"EDITOR"===e&&"PERSONAL"!==f,h=(b,c=!1)=>{if("/dashboard"===b)return"/dashboard"===a;if(c&&b.startsWith("/settings")){if("/settings/account"===b)return a?.startsWith("/settings/account")||a?.startsWith("/settings/notifications")||"/settings/profile"===a;let c=b.split("/").slice(0,3).join("/");return a?.startsWith(c)}return c?a===b:a?.startsWith(b)};a?.startsWith("/jobs");let[i,j]=(0,H.useState)(!1);a?.startsWith("/settings");let[k,m]=(0,H.useState)(!1),o=[{path:"/dashboard",icon:ag.A,label:"Dashboard",tooltip:"Dashboard"},{path:"/jobs/all-jobs",icon:L.A,label:"Jobs",tooltip:"Jobs",defaultPath:"/jobs/all-jobs",submenu:[{path:"/jobs/all-jobs",icon:L.A,label:"All Jobs"},{path:"/jobs/job-management",icon:ap.A,label:"Job Management"}]},{path:"/team",icon:aq.A,label:"Team",tooltip:"Team"},{path:"/customers",icon:ar.A,label:"Customers",tooltip:"Customers"},{path:"/audit",icon:as.A,label:"Audit Log",tooltip:"Audit Log"},{path:"/map",icon:ah.A,label:"Map",tooltip:"Map"},{path:"/calendar",icon:ai.A,label:"Calendar",tooltip:"Calendar"},{path:"/settings",icon:u.A,label:"Settings",tooltip:"Settings",defaultPath:"/settings/account",submenu:[{path:"/settings/account",icon:t.A,label:"Personal"},{path:"/settings/organization/general",icon:A.A,label:"Organization"},{path:"/settings/product/features",icon:O.A,label:"Product"},{path:"/settings/security/password",icon:at.A,label:"Security"},{path:"/settings/preferences/appearance",icon:u.A,label:"Preferences"},{path:"/settings/support/help-center",icon:au.A,label:"Support"}]}].filter(a=>!(g&&("Customers"===a.label||"Audit Log"===a.label))).map(a=>{if(!a.submenu)return a;let b=g?a.submenu.filter(a=>"Organization"!==a.label&&"Product"!==a.label):a.submenu;return{...a,submenu:b}}).filter(a=>!(a.submenu&&0===a.submenu.length));return(0,d.jsx)(l.Bx,{collapsible:"icon",variant:"sidebar",style:{"--header-height":"var(--header-h)"},className:"**:data-[slot=sidebar-container]:top-(--header-height)! **:data-[slot=sidebar-container]:h-[calc(100vh-var(--header-height))]! **:data-[slot=sidebar-container]:bottom-auto! mt-[var(--header-h)] h-[calc(100vh-var(--header-h))] border-none! bg-card/80! backdrop-blur-xl!",children:(0,d.jsx)(l.Yv,{className:"pl-1.5",children:(0,d.jsx)(l.Cn,{children:(0,d.jsx)(l.rQ,{children:(0,d.jsx)(l.wZ,{children:o.map(a=>{let c=a.icon,e=a.submenu&&a.submenu.length>0,f=h(a.path),g=a.defaultPath||a.path,n=e&&a.submenu?.some(a=>h(a.path,!0)),o=e&&(n||"/jobs"===a.path&&i||"/settings"===a.path&&k);if(e){let e="/jobs"===a.path,i="/settings"===a.path;return(0,d.jsx)(av.Nt,{open:o,onOpenChange:a=>{e?j(a):i&&m(a)},children:(0,d.jsxs)(l.FX,{children:[(0,d.jsx)(l.Uj,{asChild:!0,isActive:n||f,tooltip:a.tooltip,children:(0,d.jsxs)(ao(),{href:g,children:[(0,d.jsx)(c,{}),(0,d.jsx)("span",{children:a.label}),"expanded"===b&&(0,d.jsx)(av.R6,{asChild:!0,className:"ml-auto z-50",children:(0,d.jsx)(U.A,{className:(0,aj.cn)("h-3.5 w-3.5 transition-transform duration-200","text-sidebar-foreground/50 group-hover/menu-item:text-sidebar-accent-foreground/70",(n||f)&&"text-sidebar-accent-foreground/70",o&&"rotate-90")})})]})}),(0,d.jsx)(av.Ke,{children:(0,d.jsx)(l.q9,{className:"w-full translate-x-0 mx-0 px-0 border-none",children:a.submenu.map(a=>{let b=a.icon;return(0,d.jsx)(l.Fg,{className:"ml-3",children:(0,d.jsx)(l.Cp,{asChild:!0,isActive:h(a.path,!0),children:(0,d.jsxs)(ao(),{href:a.path,children:[(0,d.jsx)(b,{}),(0,d.jsx)("span",{children:a.label})]})})},a.path)})})})]})},a.path)}return(0,d.jsx)(l.FX,{children:(0,d.jsx)(l.Uj,{asChild:!0,isActive:f,tooltip:a.tooltip,children:(0,d.jsxs)(ao(),{href:a.path,children:[(0,d.jsx)(c,{}),(0,d.jsx)("span",{children:a.label})]})})},a.path)})})})})})})}var ax=c(33305),ay=c(46762),az=c(21411),aA=c(71870);function aB({open:a,onOpenChange:b,selectedJob:c,technicians:e,onJobAssign:f}){return(0,d.jsx)(ax.lG,{open:a,onOpenChange:b,children:(0,d.jsxs)(ax.Cf,{className:"md:min-w-[90vw] min-w-[calc(100vw-1rem)] md:max-w-[90vw] md:h-[90vh] h-[calc(100vh-1rem)] md:max-h-[90vh] p-0 gap-0 overflow-hidden flex flex-col",children:[(0,d.jsx)(ax.L3,{className:"sr-only",children:c?`Technician Rankings for ${c.propertyAddress}`:"Technician Rankings"}),c&&(0,d.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden h-full",children:(0,d.jsx)(aA.n,{jobs:[c],providers:e,selectedJob:c,onSelectJob:()=>{},onJobAssign:f,className:"size-full",fullScreen:!0,initialSidebarView:"rankings",initialJobForRankings:c,onGoBack:()=>b(!1),isDispatcherView:!0})})]})})}var aC=c(26519),aD=c(59378),aE=c(18310);function aF(){let{issues:a,clearIssue:b,clearAllIssues:c,hasPersistentIssues:e}=(0,aD.i)();if(!e)return null;let f=a.filter(a=>"api"===a.type),g=a.filter(a=>"websocket"===a.type),h=[];if(f.length>0){let a=Array.from(new Set(f.map(a=>a.message)));h.push(...a.map(a=>`API: ${a}`))}if(g.length>0){let a=Array.from(new Set(g.map(a=>a.message)));h.push(...a.map(a=>`WebSocket: ${a}`))}return(0,d.jsx)("div",{className:"fixed bottom-4 left-4 z-50 animate-in slide-in-from-bottom-5",children:(0,d.jsxs)(aC.Fc,{variant:"destructive",className:"h-full",children:[(0,d.jsx)(aE.A,{className:"h-4 w-4"}),(0,d.jsxs)(aC.XL,{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{children:"Backend Connection Issues"}),(0,d.jsx)(o.$,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:c,children:(0,d.jsx)(T.A,{className:"h-4 w-4"})})]}),(0,d.jsx)(aC.TN,{children:(0,d.jsx)("ul",{className:"list-disc list-inside space-y-1 mt-2 max-w-[80ch]",children:h.map((a,b)=>(0,d.jsx)("li",{className:"text-sm",children:a},b))})})]})})}var aG=c(79347);c(61848);var aH=c(27654);function aI({children:a,user:b,memberships:c,activeOrgId:e,uiContext:f}){let h=(0,g._)(),j=(0,i.w)(),k=(0,q.a)(),[m,n]=(0,H.useState)([]),[,o]=(0,H.useState)(!1),{showSidebar:p,canCreateOrder:r,navItems:s,accountType:t}=f,u=c.find(a=>a?.orgId===e),v=(u?.role||u?.orgRole||"").toUpperCase(),w=p&&r&&!("PROJECT_MANAGER"===v&&p||"EDITOR"===v&&p),x=(0,d.jsx)(az.RV,{initialValues:h.initialValues,onSubmit:h.handleJobCreate});return p?(0,d.jsxs)(l.GB,{children:[(0,d.jsx)("div",{className:"fixed top-0 left-0 right-0 z-50",children:(0,d.jsx)(af,{user:b,showNewJobButton:w,uiContext:f})}),(0,d.jsx)(aw,{}),(0,d.jsx)(l.sF,{className:"min-w-0 pt-header-h pb-dock-h md:pb-0!",children:a}),(0,d.jsx)(am,{uiContext:f}),w&&(k?(0,d.jsx)(ay._s,{open:h.isOpen,onOpenChange:a=>{a||h.closeJobCreationDialog()},children:(0,d.jsxs)(ay.zj,{children:[(0,d.jsx)(ay.BE,{className:"sr-only",children:(0,d.jsx)(ay.gk,{children:"Create New Job"})}),(0,d.jsx)("div",{className:"overflow-y-auto px-4 pb-4",children:x})]})}):(0,d.jsx)(ax.lG,{open:h.isOpen,onOpenChange:a=>{a||h.closeJobCreationDialog()},children:(0,d.jsxs)(ax.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,d.jsx)(ax.c7,{children:(0,d.jsx)(ax.L3,{children:"Create New Job"})}),x]})})),(0,d.jsx)(aB,{open:j.showRankings,onOpenChange:a=>{a||j.closeRankings()},selectedJob:j.selectedJob,technicians:aa.e?[]:m,onJobAssign:j.assignJob})]}):(0,d.jsxs)("div",{className:"flex h-screen w-full flex-col overflow-y-scroll",children:[(0,d.jsx)("div",{className:"fixed top-0 left-0 right-0 z-50",children:(0,d.jsx)(af,{user:b,showNewJobButton:!1,uiContext:f})}),(0,d.jsx)("main",{className:"pt-header-h pb-dock-h md:pb-0! size-full flex-1",children:a}),(0,d.jsx)(am,{uiContext:f})]})}function aJ({children:a}){let{user:b,isLoading:c,organizationId:g,memberships:m}=(0,e.l)(["AGENT","TECHNICIAN","COMPANY"]),[n,o]=(0,H.useState)(null),p=(0,H.useMemo)(()=>(0,aH.EL)(b,m,g),[b,m,g]),q=m.find(a=>a.orgId===g),r=q?.orgRole||q?.role||null;return c?(0,d.jsxs)(l.GB,{children:[(0,d.jsx)("div",{className:"fixed top-0 left-0 right-0 z-50 border-b bg-card/80 backdrop-blur-xl shadow-sm",children:(0,d.jsx)("div",{className:"w-full max-w-full py-3 px-4",children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)(f.E,{className:"h-6 w-24"}),(0,d.jsx)(f.E,{className:"h-8 w-8"})]}),(0,d.jsxs)("div",{className:"flex items-center gap-4",children:[(0,d.jsx)(f.E,{className:"h-8 w-20"}),(0,d.jsx)(f.E,{className:"h-9 w-9 rounded-full"})]})]})})}),(0,d.jsxs)("div",{className:"p-6 pt-header-h",children:[(0,d.jsx)(f.E,{className:"h-8 w-48 mb-6"}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)(f.E,{className:"h-32 w-full"}),(0,d.jsx)(f.E,{className:"h-32 w-full"}),(0,d.jsx)(f.E,{className:"h-32 w-full"})]})]})]}):b&&p?(0,d.jsx)(i.s,{defaultUserId:b?.id,defaultOrganizationId:g||void 0,initialProjects:n||void 0,userRole:p.accountType,memberRole:r,children:(0,d.jsx)(aK,{defaultUserId:b?.id,defaultOrganizationId:g||void 0,userRole:p.accountType,children:(0,d.jsx)(h.w,{defaultUserId:b?.id,defaultUserName:b?.name,defaultUserAvatar:b?.avatarUrl,children:(0,d.jsxs)(j.H,{children:[(0,d.jsx)(k.AY,{children:(0,d.jsx)(aI,{user:b,memberships:m,activeOrgId:g,uiContext:p,children:a})}),(0,d.jsx)(aF,{})]})})})}):null}function aK({children:a,defaultUserId:b,defaultOrganizationId:c,userRole:e}){let f=(0,i.w)(),h=async a=>{let d={address:{unparsed_address:a.propertyAddress||"",latitude:a.location?.lat,longitude:a.location?.lng},scheduledTime:a.scheduledDate&&a.scheduledTime?new Date(`${a.scheduledDate}T${a.scheduledTime}`):void 0,notes:a.requirements,customerId:a.customerId,orgId:a.organizationId||c,projectManagerId:a.createdBy||("AGENT"===e?b:void 0)},g=await f.createJob(d);return aG.F.mapProjectToJobCard(g)};return(0,d.jsx)(g.U,{defaultUserId:b,defaultOrganizationId:c,createJobHandler:h,children:a})}},44560:(a,b,c)=>{"use strict";c.d(b,{O:()=>j,d:()=>k});var d=c(21124),e=c(38301),f=c(78092),g=c(67442);let h=(0,c(26691).F)("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-2 min-w-9",sm:"h-8 px-1.5 min-w-8",lg:"h-10 px-2.5 min-w-10"}},defaultVariants:{variant:"default",size:"default"}}),i=e.createContext({size:"default",variant:"default"});function j({className:a,variant:b,size:c,children:e,...h}){return(0,d.jsx)(f.bL,{"data-slot":"toggle-group","data-variant":b,"data-size":c,className:(0,g.cn)("group/toggle-group flex w-fit items-center rounded-md data-[variant=outline]:shadow-xs",a),...h,children:(0,d.jsx)(i.Provider,{value:{variant:b,size:c},children:e})})}function k({className:a,children:b,variant:c,size:j,...k}){let l=e.useContext(i);return(0,d.jsx)(f.q7,{"data-slot":"toggle-group-item","data-variant":l.variant||c,"data-size":l.size||j,className:(0,g.cn)(h({variant:l.variant||c,size:l.size||j}),"min-w-0 flex-1 shrink-0 rounded-none shadow-none first:rounded-l-md last:rounded-r-md focus:z-10 focus-visible:z-10 data-[variant=outline]:border-l-0 data-[variant=outline]:first:border-l",a),...k,children:b})}},45119:(a,b,c)=>{"use strict";c.d(b,{BT:()=>k,Wu:()=>l,ZB:()=>j,Zp:()=>h,aR:()=>i,wL:()=>m});var d=c(21124);c(38301);var e=c(26691),f=c(67442);let g=(0,e.F)("bg-card text-card-foreground flex flex-col gap-0 rounded-xl",{variants:{variant:{default:"border",outline:"border-2",ghost:"border-0 shadow-none",elevated:"border shadow-lg",bordered:"border-2 border-border",flat:"border-0 bg-transparent",muted:"border-none bg-muted"},size:{default:"rounded-md",sm:"rounded-lg",lg:"rounded-2xl"}},defaultVariants:{variant:"default",size:"default"}});function h({className:a,variant:b,size:c,...e}){return(0,d.jsx)("div",{"data-slot":"card",className:(0,f.cn)(g({variant:b,size:c}),a),...e})}function i({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"card-header",className:(0,f.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-0 px-6 pt-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...b})}function j({className:a,...b}){return(0,d.jsx)("h4",{"data-slot":"card-title",className:(0,f.cn)("leading-none",a),...b})}function k({className:a,...b}){return(0,d.jsx)("p",{"data-slot":"card-description",className:(0,f.cn)("text-muted-foreground",a),...b})}function l({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"card-content",className:(0,f.cn)("px-6 [&:last-child]:pb-6",a),...b})}function m({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"card-footer",className:(0,f.cn)("flex items-center px-6 pb-6 [.border-t]:pt-6",a),...b})}},46762:(a,b,c)=>{"use strict";c.d(b,{BE:()=>l,Uz:()=>h,_s:()=>g,gk:()=>m,zj:()=>k});var d=c(21124);c(38301);var e=c(3171),f=c(67442);function g({direction:a="bottom",...b}){return(0,d.jsx)(e._s.Root,{"data-slot":"drawer",...b})}function h({...a}){return(0,d.jsx)(e._s.Trigger,{"data-slot":"drawer-trigger",...a})}function i({...a}){return(0,d.jsx)(e._s.Portal,{"data-slot":"drawer-portal",...a})}function j({className:a,...b}){return(0,d.jsx)(e._s.Overlay,{"data-slot":"drawer-overlay",className:(0,f.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...b})}function k({className:a,children:b,...c}){return(0,d.jsxs)(i,{"data-slot":"drawer-portal",children:[(0,d.jsx)(j,{}),(0,d.jsxs)(e._s.Content,{"data-slot":"drawer-content",className:(0,f.cn)("group/drawer-content bg-background fixed z-50 flex h-auto flex-col","data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b","data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t","data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm","data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm",a),...c,children:[(0,d.jsx)("div",{className:"bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block"}),b]})]})}function l({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"drawer-header",className:(0,f.cn)("flex flex-col gap-1.5 p-4",a),...b})}function m({className:a,...b}){return(0,d.jsx)(e._s.Title,{"data-slot":"drawer-title",className:(0,f.cn)("text-foreground font-semibold",a),...b})}},49037:(a,b,c)=>{"use strict";c.d(b,{AY:()=>o,Mw:()=>p,Wo:()=>k,ue:()=>m});var d=c(21124),e=c(38301),f=c(42378),g=c(41827);c(28888);var h=c(79347),i=c(42830),j=c(33201);let k={DASHBOARD_OVERVIEW:{title:"Dashboard Overview",description:"Learn how to navigate your dashboard and understand key metrics",icon:"\uD83D\uDCCA",route:"/dashboard"},JOB_MANAGEMENT:{title:"Job Management",description:"Master viewing and tracking jobs",icon:"\uD83D\uDCCB",route:"/jobs/all-jobs"},MESSAGING_CHAT:{title:"Messaging & Chat",description:"Communicate with your team and customers",icon:"\uD83D\uDCAC",route:"/jobs/all-jobs"},SETTINGS_INTEGRATIONS:{title:"Settings & Integrations",description:"Configure your account and connect external services",icon:"",route:"/settings/account"}},l=(0,e.createContext)(void 0);function m(a,b){let c=n[a];if(!b?.accountType)return c;let{accountType:d,orgType:e,orgRole:f}=b,g="PERSONAL"===e&&"COMPANY"===d?"PROVIDER":d;return c.filter(a=>!a.allowedAccountTypes||(1===a.allowedAccountTypes.length&&"COMPANY"===a.allowedAccountTypes[0]?"PERSONAL"!==e&&"COMPANY"===e&&("OWNER"===f||"ADMIN"===f):a.allowedAccountTypes.includes(g)))}let n={DASHBOARD_OVERVIEW:[{id:"agent-welcome",targetSelector:'[data-tour="dashboard-article"]',title:"Welcome to Your Dashboard!",description:"This is your central hub for ordering and tracking real estate media. Let's take a quick tour.",placement:"bottom",allowedAccountTypes:["AGENT"]},{id:"agent-create-order",targetSelector:'[data-tour="jobs-create-button"]',title:"Create New Orders",description:"Click here to order photography, videography, or other media services for your listings.",placement:"bottom",allowedAccountTypes:["AGENT"]},{id:"agent-stats",targetSelector:'[data-tour="agent-stats"]',title:"Order Status",description:"Track the status of all your orders at a glance - pending, in progress, and completed.",placement:"bottom",allowedAccountTypes:["AGENT"]},{id:"agent-jobs-tabs",targetSelector:'[data-tour="jobs-tabs"]',title:"Filter Your Orders",description:"Use these tabs to filter orders by status. Quickly find pending, assigned, in-progress, or completed jobs.",placement:"bottom",allowedAccountTypes:["AGENT"]},{id:"agent-jobs-list",targetSelector:'[data-tour="agent-jobs-list"]',title:"Your Orders",description:"View all your media orders here. Click any order to see details, track progress, or communicate with your provider.",placement:"top",allowedAccountTypes:["AGENT"]},{id:"dashboard-welcome",targetSelector:'[data-tour="dashboard-article"]',title:"Welcome to Your Dashboard!",description:"This is your central hub for managing all your real estate media projects. Let's take a quick tour.",placement:"bottom",allowedAccountTypes:["PROVIDER"]},{id:"dashboard-metrics",targetSelector:'[data-tour="dashboard-metrics"]',title:"Key Metrics",description:"Track your performance with real-time statistics including active jobs, completed projects, and ratings.",placement:"bottom",allowedAccountTypes:["PROVIDER"]},{id:"dashboard-calendar",targetSelector:'[data-tour="dashboard-calendar"]',title:"Your Schedule",description:"View your upcoming jobs on the calendar. Click any event to see job details.",placement:"top",allowedAccountTypes:["PROVIDER"]},{id:"dashboard-map",targetSelector:'[data-tour="dashboard-map"]',title:"Live Job Map",description:"See all your scheduled jobs on an interactive map. Click pins to view job details and get directions.",placement:"top",allowedAccountTypes:["PROVIDER"]},{id:"dashboard-jobs",targetSelector:'[data-tour="dashboard-jobs"]',title:"Active Jobs",description:"Quick access to your current projects. Click any job to view details or update status.",placement:"top",allowedAccountTypes:["PROVIDER"]}],JOB_MANAGEMENT:[{id:"agent-jobs-intro",targetSelector:'[data-tour="agent-jobs-list"]',title:"Your Orders",description:"Here you can see all your media orders. We've created a demo order to show you around.",placement:"top",allowedAccountTypes:["AGENT"]},{id:"agent-jobs-open-demo",targetSelector:'[data-tour="agent-jobs-list"]',title:"View Order Details",description:"Click on the demo order to see its full details, track progress, and communicate with your provider.",placement:"top",allowedAccountTypes:["AGENT"],openDemoProject:!0,requiresInteraction:!0,actionText:"Click the demo order card to continue"},{id:"agent-job-details",targetSelector:'[data-tour="job-task-view"]',title:"Order Details",description:"This panel shows all information about your order including status, scheduled time, and property details.",placement:"left",allowedAccountTypes:["AGENT"]},{id:"agent-job-status",targetSelector:'[data-tour="job-status-section"]',title:"Track Order Status",description:"Watch your order progress through each stage: Booked  Shooting  Editing  Delivered.",placement:"left",allowedAccountTypes:["AGENT"]},{id:"agent-job-chat",targetSelector:'[data-tour="messaging-section"], [data-tour="messaging-compose"]',title:"Message Your Provider",description:"Use the chat to communicate directly with your media provider about this order.",placement:"top",allowedAccountTypes:["AGENT"]},{id:"jobs-overview",targetSelector:'[data-tour="jobs-header"], [data-tour="jobs-view"]',title:"Job Management",description:"This is where you view and manage all your photography and videography jobs.",placement:"bottom",allowedAccountTypes:["PROVIDER"]},{id:"jobs-filters",targetSelector:'[data-tour="jobs-filters"]',title:"Search & Filter",description:"Search for jobs by address or client name, filter by status or priority, and sort by date or client.",placement:"bottom",allowedAccountTypes:["PROVIDER"]},{id:"jobs-list",targetSelector:'[data-tour="jobs-list"]',title:"Job Cards",description:"Each card shows key job info including address, status, and scheduled time. Click any job to see full details.",placement:"top",allowedAccountTypes:["PROVIDER"]},{id:"jobs-status-provider",targetSelector:'[data-tour="jobs-list"]',title:"Update Job Status",description:"As you complete work, update the job status to keep everyone informed. Jobs progress from Assigned  In Progress  Editing  Delivered.",placement:"top",allowedAccountTypes:["PROVIDER"]},{id:"jobs-assign",targetSelector:'[data-tour="jobs-list"]',title:"Assign Team Members",description:"Assign photographers, videographers, and editors to jobs. They'll receive automatic notifications.",placement:"top",allowedAccountTypes:["COMPANY"]}],MESSAGING_CHAT:[{id:"messaging-intro",targetSelector:'[data-tour="jobs-list"]',title:"Job Messaging",description:"Every job has built-in messaging. Click on the demo job to see the chat feature.",placement:"top",allowedAccountTypes:["PROVIDER"],openDemoProject:!0,requiresInteraction:!0,actionText:"Click the demo job card to continue"},{id:"messaging-task-view",targetSelector:'[data-tour="job-task-view"]',title:"Job Details & Chat",description:"This is the job detail view where you can see all job information and communicate via chat.",placement:"left",allowedAccountTypes:["PROVIDER"]},{id:"messaging-channels",targetSelector:'[data-tour="messaging-tabs"]',title:"Message Channels",description:"Each job has two channels: Team Chat (internal discussions) and Customer Chat (client-facing messages).",placement:"bottom",allowedAccountTypes:["COMPANY"]},{id:"messaging-customer-chat",targetSelector:'[data-tour="messaging-section"], [data-tour="messaging-compose"]',title:"Customer Chat",description:"Use the chat to communicate with your customers about this job. All messages are saved for your reference.",placement:"top",allowedAccountTypes:["PROVIDER"]},{id:"messaging-compose",targetSelector:'[data-tour="messaging-compose"]',title:"Send Messages",description:"Type your message and press Enter to send. You can also attach files and images.",placement:"top",allowedAccountTypes:["PROVIDER"]}],SETTINGS_INTEGRATIONS:[{id:"settings-welcome",targetSelector:'[data-tour="settings-header"]',title:"Settings & Preferences",description:"Configure your account, connect calendars, and manage your preferences here.",placement:"bottom",route:"/settings/account"},{id:"settings-navigation",targetSelector:'[data-tour="settings-nav"]',title:"Settings Navigation",description:"Use the sidebar to navigate between different settings sections: Personal, Organization, Security, and more.",placement:"right"},{id:"settings-account",targetSelector:'[data-tour="settings-content"]',title:"Account Settings",description:"Update your name, email, and profile information. Changes are saved automatically.",placement:"left"},{id:"settings-tour-restart",targetSelector:'[data-tour="settings-tour-section"]',title:"Restart the Tour Anytime",description:"You can always come back here to restart the setup guide and revisit any of the tutorials whenever you need a refresher.",placement:"top"},{id:"settings-calendar",targetSelector:'[data-tour="settings-calendar-link"]',title:"Calendar Integration",description:"Connect your Google or Outlook calendar to automatically sync your job schedule.",placement:"right",route:"/settings/calendar",allowedAccountTypes:["PROVIDER"]},{id:"settings-notifications",targetSelector:'[data-tour="settings-notifications-link"]',title:"Notification Preferences",description:"Control how and when you receive notifications about jobs, messages, and updates.",placement:"right"},{id:"settings-org",targetSelector:'[data-tour="settings-org-section"]',title:"Organization Settings",description:"Manage your company profile, team members, and billing information.",placement:"right",allowedAccountTypes:["COMPANY"]}]};function o({children:a}){let b=(0,f.useRouter)(),c=(0,f.usePathname)(),{user:n,activeOrganizationId:o,memberships:p}=(0,j.A)(),q=(0,e.useMemo)(()=>{if(!n||!o||!p)return{accountType:n?.accountType};let a=p.find(a=>a.orgId===o);if(!a)return{accountType:n.accountType};let b=a.organization?.type||"PERSONAL",c=a.orgRole||a.role||"MEMBER";return{accountType:n.accountType,orgType:b,orgRole:c}},[n,o,p]),[r,s]=(0,e.useState)(null),[t,u]=(0,e.useState)(!0),[v,w]=(0,e.useState)(null),[x,y]=(0,e.useState)(null),[z,A]=(0,e.useState)(0),[B,C]=(0,e.useState)(!1),D=(0,e.useRef)(null),E=(0,e.useRef)(0),F=(0,e.useRef)(!1),G=(0,e.useRef)(null),H=(0,e.useRef)(null),I=(0,e.useRef)(!1),J=(0,e.useRef)(null),K=["JOB_MANAGEMENT","MESSAGING_CHAT"],L=(0,e.useCallback)(()=>{G.current&&window.dispatchEvent(new CustomEvent("openJobTaskView",{detail:{id:G.current}}))},[]),M=(0,e.useCallback)(async()=>{try{u(!0),w(null);let a=await h.F.tours.getStatus();if(s(a),a.hasDemoProject&&!B&&!F.current){console.log("Found orphaned demo project, cleaning up..."),a.demoProjectId;try{await h.F.tours.deleteDemoProject()}catch(a){console.error("Failed to cleanup orphaned demo project:",a)}}}catch(a){console.error("Failed to fetch tour status:",a),w(a.message||"Failed to load tour status")}finally{u(!1)}},[B]);(0,e.useRef)(!1);let N=(0,e.useCallback)(a=>r?.trackProgress?.[a]??null,[r]),O=["DASHBOARD_OVERVIEW","JOB_MANAGEMENT","MESSAGING_CHAT","SETTINGS_INTEGRATIONS"],P=(0,e.useCallback)(()=>{let a=O.reduce((a,b)=>{let c=m(b,q);if(0===c.length)return a;let d=r?.trackProgress?.[b];return{completed:a.completed+(d?.completed??0),total:a.total+c.length}},{completed:0,total:0});return{...a,percentage:a.total>0?Math.round(a.completed/a.total*100):0}},[r,q]),Q=(0,e.useCallback)(a=>a.map(a=>{let b=a.requiresInteraction||a.openDemoProject,c=a.description;if(b){let b=a.actionText||"Click the highlighted element to continue";c=`${a.description}

 **${b}**`}return{element:a.targetSelector,popover:{title:a.title,description:c,side:a.placement||"bottom",align:"center",showButtons:b?["previous","close"]:["next","previous","close"],popoverClass:b?"vrem-tour-popover vrem-tour-requires-interaction":"vrem-tour-popover"}}}),[]),R=(0,e.useCallback)(()=>{},[]),S=(0,e.useCallback)(async()=>{if(F.current){G.current;try{await h.F.tours.deleteDemoProject(),F.current=!1,G.current=null,R()}catch(a){console.error("Failed to delete demo project:",a)}}},[R]),T=(0,e.useCallback)((a,d=0)=>{let e=m(a,q);if(!e||0===e.length)return void i.oR.error("Tour steps not configured");let f=Math.min(Math.max(0,d),e.length-1);y(a),A(f),C(!0),J.current=a,setTimeout(()=>{let d=(0,g.B)({showProgress:!0,animate:!0,allowClose:!0,overlayColor:"rgba(0, 0, 0, 0.75)",stagePadding:10,popoverClass:"vrem-tour-popover",steps:Q(e),onDestroyStarted:()=>{S(),J.current=null,I.current=!1,C(!1),y(null),A(0)},onHighlightStarted:(b,c,d)=>{let f=e[d.state.activeIndex||0];f&&(h.F.tours.updateProgress({tourTrack:a,stepId:f.id,completed:!1}).catch(console.error),f.requiresInteraction||f.openDemoProject?I.current=!0:I.current=!1)},onNextClick:(f,j,l)=>{let m=l.state.activeIndex||0,n=e[m],o=e[m+1],p=m===e.length-1;if(n&&h.F.tours.updateProgress({tourTrack:a,stepId:n.id,completed:!0}).catch(console.error),p){h.F.tours.completeTrack(a).catch(console.error),S(),d.destroy(),C(!1),y(null),A(0),M(),i.oR.success(`${k[a].title} completed!`);return}if(n?.openDemoProject&&G.current){L();let a=()=>{document.querySelector('[data-tour="job-task-view"]')?(A(m+1),d.moveNext()):setTimeout(a,100)};setTimeout(a,300);return}if(o?.route&&c!==o.route){d.destroy(),A(m+1),b.push(o.route),setTimeout(()=>{let b=e.slice(m+1);if(b.length>0){let c=(0,g.B)({showProgress:!0,animate:!0,allowClose:!0,overlayColor:"rgba(0, 0, 0, 0.75)",stagePadding:10,popoverClass:"vrem-tour-popover",steps:Q(b),onDestroyStarted:()=>{S(),J.current=null,I.current=!1,C(!1),y(null),A(0)},onNextClick:(d,e,f)=>{let g=f.state.activeIndex||0,j=g===b.length-1,l=b[g];if(l&&h.F.tours.updateProgress({tourTrack:a,stepId:l.id,completed:!0}).catch(console.error),j){h.F.tours.completeTrack(a).catch(console.error),S(),c.destroy(),C(!1),y(null),A(0),M(),i.oR.success(`${k[a].title} completed!`);return}c.moveNext()}});H.current=c,c.drive()}},500);return}A(m+1),d.moveNext()},onPrevClick:(a,b,c)=>{A(Math.max(0,(c.state.activeIndex||0)-1)),d.movePrevious()},onCloseClick:()=>{d.destroy()}});H.current=d,d.drive(f)},300)},[Q,c,b,n?.accountType,S,M,L]),U=(0,e.useCallback)(async(a,d=0)=>{let e=k[a].route;if(n?.accountType?.toUpperCase()==="AGENT"&&("JOB_MANAGEMENT"===a||"MESSAGING_CHAT"===a)&&(e="/dashboard"),K.includes(a))if(o)try{h.F.organizations.setActiveOrganization(o);let a=await h.F.tours.createDemoProject();F.current=!0,G.current=a.id,R(),await new Promise(a=>setTimeout(a,500))}catch(a){console.error("Failed to create demo project:",a),i.oR.error(`Failed to create demo project: ${a?.message||"Unknown error"}`)}else i.oR.error("No organization selected. Please select an organization first.");c!==e?(D.current=a,E.current=d,b.push(e)):T(a,d)},[c,b,T,R,o,n?.accountType]),V=(0,e.useCallback)((a,b)=>{U(a,b)},[U]),W=(0,e.useCallback)(()=>{H.current&&H.current.moveNext()},[]),X=(0,e.useCallback)(()=>{H.current&&H.current.movePrevious()},[]),Y=(0,e.useCallback)(()=>{if(H.current&&x){let a=m(x,q)[z];a&&h.F.tours.updateProgress({tourTrack:x,stepId:a.id,skipped:!0}).catch(console.error),H.current.moveNext()}},[x,z,n?.accountType]),Z=(0,e.useCallback)(async()=>{H.current&&H.current.destroy(),D.current=null,E.current=0,J.current=null,I.current=!1,await S(),C(!1),y(null),A(0)},[S]),$=(0,e.useCallback)(async a=>{try{await h.F.tours.completeTrack(a),await M(),i.oR.success(`${k[a].title} completed!`)}catch(a){console.error("Failed to complete track:",a),i.oR.error("Failed to mark track as complete")}},[M]),_=(0,e.useCallback)(async()=>{try{H.current&&H.current.destroy(),await S(),C(!1),y(null),A(0),J.current=null,I.current=!1,await h.F.tours.dismissGuide(),await M()}catch(a){console.error("Failed to dismiss guide:",a),i.oR.error("Failed to dismiss guide")}},[M,S]),aa=(0,e.useCallback)(async()=>{try{H.current&&H.current.destroy(),C(!1),y(null),A(0),J.current=null,I.current=!1,F.current=!1,G.current=null,await h.F.tours.resetProgress(),await M(),i.oR.success("Tour progress has been reset")}catch(a){console.error("Failed to reset progress:",a),i.oR.error("Failed to reset progress")}},[M]),ab=!t&&!v&&!r?.dismissedGuide&&!r?.hasCompletedSetup;return(0,d.jsx)(l.Provider,{value:{status:r,isLoading:t,error:v,activeTour:x,activeStepIndex:z,isTourActive:B,shouldShowGuide:ab,tourStepContext:q,getTrackProgress:N,getOverallProgress:P,startTour:U,startTourFromStep:V,nextStep:W,prevStep:X,skipStep:Y,exitTour:Z,completeTrack:$,dismissGuide:_,resetProgress:aa,refetchStatus:M},children:a})}function p(){let a=(0,e.useContext)(l);if(void 0===a)throw Error("useTour must be used within a TourProvider");return a}},52962:(a,b,c)=>{"use strict";c.d(b,{w:()=>l,I:()=>m});var d=c(21124),e=c(38301),f=c(79347),g=c(66013);class h{connect(a){this.socket&&this.socket.connected||(this.socket=(0,g.io)("http://localhost:3001/chat",{autoConnect:!0,transports:["websocket"],auth:{token:a||void 0}}),this.socket.on("connect_error",a=>{}),this.socket.on("connect",()=>{}),this.socket.on("disconnect",a=>{}),this.socket.on("messageCreated",a=>{let b=this.mapIncomingMessage(a);b&&this.messageHandlers.forEach(a=>a(b))}),this.socket.on("userTyping",a=>{this.typingHandlers.forEach(b=>b(a))}),this.socket.on("presenceUpdate",a=>{this.presenceUpdateHandlers.forEach(b=>b(a))}),this.socket.on("presenceList",a=>{this.presenceListHandlers.forEach(b=>b(a))}),this.socket.on("messagesRead",a=>{this.messagesReadHandlers.forEach(b=>b(a))}))}disconnect(){this.socket&&(this.socket.removeAllListeners(),this.socket.disconnect(),this.socket=null),this.typingDebounceTimers.forEach(a=>clearTimeout(a)),this.typingDebounceTimers.clear(),this.typingState.clear()}async joinProject(a,b="TEAM"){return this.socket||this.connect(),new Promise((c,d)=>{this.socket?.emit("joinProject",{projectId:a,channel:b},a=>{a?.error?d(Error(a.error)):c()})})}async sendMessage(a,b,c="TEAM",d){return this.socket||this.connect(),new Promise((e,f)=>{this.socket?.emit("sendMessage",{projectId:a,content:b,channel:c,thread:d},a=>{if(a?.error)f(Error(a.error));else{let b=this.mapIncomingMessage(a);b?e(b):f(Error("Malformed message payload"))}})})}onMessage(a){this.messageHandlers.add(a)}offMessage(a){this.messageHandlers.delete(a)}emitTyping(a,b,c){let d=`${a}:${b}`,e=this.typingState.get(d),f=this.typingDebounceTimers.get(d);if(f&&(clearTimeout(f),this.typingDebounceTimers.delete(d)),c){e||(this.typingState.set(d,!0),this.socket?.emit("typing",{projectId:a,channel:b,isTyping:!0}));let c=setTimeout(()=>{this.typingState.set(d,!1),this.socket?.emit("typing",{projectId:a,channel:b,isTyping:!1}),this.typingDebounceTimers.delete(d)},2e3);this.typingDebounceTimers.set(d,c)}else e&&(this.typingState.set(d,!1),this.socket?.emit("typing",{projectId:a,channel:b,isTyping:!1}))}stopTyping(a,b){this.emitTyping(a,b,!1)}onTyping(a){this.typingHandlers.add(a)}offTyping(a){this.typingHandlers.delete(a)}onPresenceUpdate(a){this.presenceUpdateHandlers.add(a)}offPresenceUpdate(a){this.presenceUpdateHandlers.delete(a)}onPresenceList(a){this.presenceListHandlers.add(a)}offPresenceList(a){this.presenceListHandlers.delete(a)}async markMessagesRead(a,b,c){return this.socket||this.connect(),new Promise((d,e)=>{this.socket?.emit("markRead",{messageIds:b,projectId:a,channel:c},a=>{a?.error?e(Error(a.error)):d({success:a.success,markedCount:a.markedCount})})})}onMessagesRead(a){this.messagesReadHandlers.add(a)}offMessagesRead(a){this.messagesReadHandlers.delete(a)}mapIncomingMessage(a){if(!a)return null;let b=a.channel||(a.user?.accountType==="AGENT"||a.user?.account_type==="AGENT"?"CUSTOMER":"TEAM");return{id:a.id,jobId:a.projectId,userId:a.userId,userName:a.user?.name||"Unknown User",userAvatar:a.user?.avatarUrl,content:a.content,createdAt:new Date(a.timestamp||a.createdAt||new Date),channel:b,thread:a.thread??null,threadId:a.thread??null,chatType:"CUSTOMER"===b?"client":"team"}}constructor(){this.socket=null,this.messageHandlers=new Set,this.typingHandlers=new Set,this.presenceUpdateHandlers=new Set,this.presenceListHandlers=new Set,this.messagesReadHandlers=new Set,this.typingDebounceTimers=new Map,this.typingState=new Map}}let i=new h;var j=c(42830);let k=(0,e.createContext)(void 0);function l({children:a,defaultUserId:b,defaultUserName:c,defaultUserAvatar:g}){let[h,l]=(0,e.useState)([]),[m,n]=(0,e.useState)(b),[o,p]=(0,e.useState)(c),[q,r]=(0,e.useState)(g),[s,t]=(0,e.useState)(!1),[u,v]=(0,e.useState)(new Set),w=(0,e.useRef)(new Map),x=(0,e.useRef)(new Set),[y,z]=(0,e.useState)(new Map),[A,B]=(0,e.useState)(new Map),[C,D]=(0,e.useState)(new Map),E=(0,e.useCallback)(a=>h.filter(b=>b.jobId===a),[h]),F=(0,e.useCallback)(a=>u.has(a),[u]),G=(0,e.useCallback)(async(a,b="TEAM",c)=>{let d=`${a}:${b}`,e=Date.now(),g=w.current.get(d);if((!g||!(e-g<5e3))&&!x.current.has(d)){x.current.add(d),v(b=>new Set(b).add(a));try{c&&f.F.organizations.setActiveOrganization(c);let e=await f.F.chat.getMessages(a,b);w.current.set(d,Date.now());let g=e.map(a=>({...a,createdAt:new Date(a.createdAt),channel:a.channel||b,chatType:"CUSTOMER"===(a.channel||b)?"client":"team"}));l(c=>[...c.filter(c=>c.jobId!==a||c.channel!==b),...g]),s&&i.joinProject(a,b).catch(()=>{})}catch(a){console.error("Error fetching messages:",a)}finally{x.current.delete(d),v(b=>{let c=new Set(b);return c.delete(a),c})}}},[s]),H=(0,e.useCallback)(async(a,b,c,d)=>{if(!m||!o)return void console.warn("Cannot send message: user info not set");try{let e=null;if(s)e=await i.sendMessage(a,b,c,d);else{let g=await f.F.chat.sendMessage(a,b,c,d);e={...g,jobId:a,userId:m,userName:o,userAvatar:q,content:b,channel:c,chatType:"CUSTOMER"===c?"client":"team",thread:d||null,threadId:d||void 0,createdAt:new Date(g.createdAt||new Date)}}e&&(l(a=>[...a,e]),window.dispatchEvent(new CustomEvent("messageCreated",{detail:e})))}catch(a){console.error("Error sending message:",a),j.oR.error("Failed to send message")}},[s,m,o,q]),I=(0,e.useCallback)((a,b)=>{l(c=>c.map(c=>c.id===a?{...c,content:b}:c));let c=localStorage.getItem("chatMessages");if(c){let d=JSON.parse(c).map(c=>c.id===a?{...c,content:b}:c);localStorage.setItem("chatMessages",JSON.stringify(d))}window.dispatchEvent(new CustomEvent("messageUpdated",{detail:{messageId:a,content:b}}))},[]),J=(0,e.useCallback)(async a=>{l(b=>b.filter(b=>b.id!==a));let b=localStorage.getItem("chatMessages");if(b){let c=JSON.parse(b).filter(b=>b.id!==a);localStorage.setItem("chatMessages",JSON.stringify(c))}try{await f.F.messages.delete(a)}catch(a){console.error("Failed to delete message on backend",a)}window.dispatchEvent(new CustomEvent("messageDeleted",{detail:{messageId:a}}))},[]),K=(0,e.useCallback)((a,b,c)=>{n(a),p(b),r(c)},[]),L=(0,e.useCallback)((a,b)=>{let c=`${a}:${b}`,d=y.get(c);return d?Array.from(d.values()):[]},[y]),M=(0,e.useCallback)((a,b)=>{i.emitTyping(a,b,!0)},[]),N=(0,e.useCallback)((a,b)=>{i.stopTyping(a,b)},[]),O=(0,e.useCallback)(a=>{let b=A.get(a);return b?Array.from(b.values()):[]},[A]),P=(0,e.useCallback)((a,b)=>{let c=A.get(a);return c?.has(b)??!1},[A]),Q=(0,e.useCallback)(a=>C.get(a)||[],[C]),R=(0,e.useCallback)((a,b,c)=>{s&&0!==b.length&&i.markMessagesRead(a,b,c).catch(a=>{console.error("Failed to mark messages as read:",a)})},[s]);return(0,d.jsx)(k.Provider,{value:{messages:h,getMessagesForJob:E,fetchMessages:G,isLoadingMessages:F,sendMessage:H,editMessage:I,deleteMessage:J,getTypingUsers:L,emitTyping:M,stopTyping:N,getOnlineUsers:O,isUserOnline:P,getMessageReadReceipts:Q,markMessagesAsRead:R,currentUserId:m,currentUserName:o,currentUserAvatar:q,setUserInfo:K},children:a})}function m(){let a=(0,e.useContext)(k);if(void 0===a)throw Error("useMessaging must be used within a MessagingProvider");return a}},53199:(a,b,c)=>{"use strict";c.d(b,{J:()=>g});var d=c(21124);c(38301);var e=c(71538),f=c(15514);function g({className:a,...b}){return(0,d.jsx)(e.b,{"data-slot":"label",className:(0,f.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...b})}},55224:(a,b,c)=>{"use strict";c.d(b,{E:()=>f});var d=c(21124),e=c(67442);function f({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"skeleton",className:(0,e.cn)("bg-accent animate-pulse rounded-md",a),...b})}},56663:(a,b,c)=>{"use strict";c.d(b,{$:()=>i,H:()=>h});var d=c(21124),e=c(38301),f=c(42378);let g=(0,e.createContext)(void 0);function h({children:a}){let b=(0,f.useRouter)(),c=(0,e.useCallback)(()=>{b.push("/jobs/all-jobs")},[b]),h=(0,e.useCallback)(()=>{b.push("/map")},[b]),i=(0,e.useCallback)(()=>{b.push("/calendar")},[b]),j=(0,e.useCallback)(a=>{b.push(`/jobs/${a.id}`)},[b]);return(0,d.jsx)(g.Provider,{value:{navigateToJobsView:c,navigateToMapView:h,navigateToCalendarView:i,navigateToJobInProjectManagement:j},children:a})}function i(){let a=(0,e.useContext)(g);if(void 0===a)throw Error("useDispatcherNavigation must be used within a DispatcherNavigationProvider");return a}},57991:(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c(38301);function e(){let[a,b]=(0,d.useState)(void 0);return!!a}},60127:(a,b,c)=>{"use strict";c.d(b,{$K:()=>k,BO:()=>p,Ib:()=>r,Kh:()=>g,ZZ:()=>j,aN:()=>i,jC:()=>h,lN:()=>o,mR:()=>n,nS:()=>m,qc:()=>q});let d=["PERSONAL_OWNER","OWNER","ADMIN"],e=["PERSONAL_OWNER","OWNER","ADMIN","PROJECT_MANAGER"],f=["PERSONAL_OWNER","OWNER","ADMIN"];function g(a,b,c){return!!a&&"NONE"!==a&&!!b&&(!!d.includes(a)||"PROJECT_MANAGER"===a&&b.projectManagerId===c)}function h(a){return!!a&&"NONE"!==a&&d.includes(a)}function i(a){return!!a&&"NONE"!==a&&d.includes(a)}function j(a,b,c){return g(a,b,c)}function k(a){return!!a&&"NONE"!==a&&e.includes(a)}function l(a){return!!a&&"NONE"!==a}function m(a){return!!a&&"NONE"!==a&&"EDITOR"!==a&&"TECHNICIAN"!==a&&["PERSONAL_OWNER","OWNER","ADMIN","PROJECT_MANAGER"].includes(a)}function n(a,b,c,e){return!!(e?.userAccountType==="AGENT"&&e?.customerUserId)&&e.customerUserId===c||!!a&&"NONE"!==a&&!!b&&(!!d.includes(a)||"PROJECT_MANAGER"===a&&b.projectManagerId===c)}function o(a){return!!a&&"NONE"!==a&&f.includes(a)}function p(a){return!!a&&"NONE"!==a&&["PERSONAL_OWNER","OWNER","ADMIN","PROJECT_MANAGER"].includes(a)}function q(a){return!!a&&"NONE"!==a&&d.includes(a)}function r(a,b,c){return{canViewProject:!!a&&"NONE"!==a&&(!!["PERSONAL_OWNER","OWNER","ADMIN","PROJECT_MANAGER"].includes(a)||("TECHNICIAN"===a?b?.technicianId===c:"EDITOR"===a&&b?.editorId===c)),canEditProject:g(a,b,c),canDeleteProject:h(a),canChangeCustomer:i(a),canAssignTechnician:"PERSONAL_OWNER"!==a&&g(a,b,c),canAssignEditor:"PERSONAL_OWNER"!==a&&g(a,b,c),canChangeStatus:g(a,b,c),canReschedule:g(a,b,c),canWriteTeamChat:l(a),canReadTeamChat:l(a),canWriteCustomerChat:n(a,b,c),canReadCustomerChat:m(a),isAssignedPM:!!b&&!!c&&b.projectManagerId===c,isAssignedTechnician:!!b&&!!c&&b.technicianId===c,isAssignedEditor:!!b&&!!c&&b.editorId===c}}},60874:(a,b,c)=>{"use strict";c.d(b,{y:()=>g});var d=c(21124),e=c(14263),f=c(15514);function g({className:a,...b}){return(0,d.jsx)(e.A,{role:"status","aria-label":"Loading",className:(0,f.cn)("size-4 animate-spin",a),...b})}},60958:(a,b,c)=>{Promise.resolve().then(c.bind(c,44303))},61010:(a,b,c)=>{"use strict";c.d(b,{AM:()=>g,Wv:()=>h,hl:()=>i});var d=c(21124);c(38301);var e=c(93958),f=c(67442);function g({...a}){return(0,d.jsx)(e.bL,{"data-slot":"popover",...a})}function h({...a}){return(0,d.jsx)(e.l9,{"data-slot":"popover-trigger",...a})}function i({className:a,align:b="center",sideOffset:c=4,...g}){return(0,d.jsx)(e.ZL,{children:(0,d.jsx)(e.UC,{"data-slot":"popover-content",align:b,sideOffset:c,className:(0,f.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",a),...g})})}},61848:(a,b,c)=>{"use strict";c.d(b,{NV:()=>i,ft:()=>g});var d=c(79347);let e={lat:51.0447,lng:-114.0719},f=new Map;async function g(a){let b="pk.eyJ1IjoiZHVyb2RwIiwiYSI6ImNtaHplcW53cDA4dHQycnB6dnhqeGtveXgifQ.6GR-s3V7vfGRsoVlhSTFhg";if(!b||!a)return null;try{let c=`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(a)}.json?access_token=${b}&limit=1`,d=await fetch(c);if(!d.ok)return null;let e=await d.json(),f=e?.features?.[0];if(f?.center?.length===2){let[a,b]=f.center;return{lat:b,lng:a}}}catch(a){console.error("Failed to geocode address",a)}return null}async function h(a){if(!a.user)return null;let b=a.user,c=a.personalOrg,d=c?[c.addressLine1,c.addressLine2,c.city,c.region,c.postalCode,c.countryCode].filter(Boolean).join(", "):"",h=c?.lat!==void 0&&c?.lng!==void 0?{lat:c.lat,lng:c.lng}:e;if(d){let a=f.get(d);if(a)h=a;else{let a=await g(d);a&&(h=a,f.set(d,a))}}return{id:b.id,userId:b.id,orgMemberId:a.id,orgId:a.orgId,memberId:a.id,role:a.role||a.orgRole||"TECHNICIAN",name:b.name||"Unnamed",email:b.email||"",phone:c?.phone||"",organizationId:b.organizationId||void 0,isIndependent:!0,companyId:void 0,companyName:void 0,homeLocation:{lat:h.lat,lng:h.lng,address:{street:c?.addressLine1||"",city:c?.city||"",stateProvince:c?.region||"",country:c?.countryCode||"",postalCode:c?.postalCode||""}},availability:[],reliability:{totalJobs:0,noShows:0,lateDeliveries:0,onTimeRate:0,averageDeliveryTime:0},skills:{residential:0,commercial:0,aerial:0,twilight:0,video:0},rating:{overall:0,count:0,recent:[]},preferredClients:[],status:"active",createdAt:a.createdAt?new Date(a.createdAt):new Date,avatar:b.avatarUrl,bio:"",services:{photography:!0,video:!1,aerial:!1,floorplan:!1,measurement:!1,twilight:!1,editing:!1,virtualStaging:!1},portfolio:[],certifications:[]}}async function i(){let a=await d.F.organizations.listMembers();return a&&0!==a.length?(await Promise.all(a.map(a=>h(a)))).filter(a=>!!a):[]}},62857:(a,b,c)=>{"use strict";c.d(b,{hq:()=>e,in:()=>f,zE:()=>g});var d=c(27654);let e=(a,b)=>{if(!a)return(0,d.FK)(b);if("PERSONAL"===(a.organization?.type||a.organizationType||""))return"COMPANY";let c=a.orgRole||a.role||a?.organizationRole||b;return(0,d.FK)(c)},f=(a,b)=>{let c=a.find(a=>a.orgId===b),d=c?.orgRole??c?.role??null;return d?d.toUpperCase():null},g=a=>{let b=(0,d.FK)(a);return"COMPANY"===b||"AGENT"===b||"TECHNICIAN"===b?"/dashboard":"/"}},62949:(a,b,c)=>{"use strict";c.d(b,{Ke:()=>h,Nt:()=>f,R6:()=>g});var d=c(21124),e=c(59147);function f({...a}){return(0,d.jsx)(e.bL,{"data-slot":"collapsible",...a})}function g({...a}){return(0,d.jsx)(e.R6,{"data-slot":"collapsible-trigger",...a})}function h({...a}){return(0,d.jsx)(e.Ke,{"data-slot":"collapsible-content",...a})}},65686:(a,b,c)=>{Promise.resolve().then(c.bind(c,95555))},65749:(a,b,c)=>{"use strict";c.d(b,{Bx:()=>q,Cn:()=>u,Cp:()=>C,FX:()=>x,Fg:()=>B,GB:()=>p,Uj:()=>z,Yv:()=>t,cL:()=>o,q9:()=>A,rQ:()=>v,sF:()=>s,wZ:()=>w,x2:()=>r});var d=c(21124),e=c(38301),f=c(96425),g=c(26691),h=c(23593),i=c(57991),j=c(67442),k=c(19217);c(7629),c(8044);var l=c(86276);c(55224);var m=c(36736);let n=e.createContext(null);function o(){let a=e.useContext(n);if(!a)throw Error("useSidebar must be used within a SidebarProvider.");return a}function p({defaultOpen:a=!0,open:b,onOpenChange:c,className:f,style:g,children:h,...k}){let l=(0,i.a)(),[o,p]=e.useState(!1),[q,r]=e.useState(a),s=b??q,t=e.useCallback(a=>{let b="function"==typeof a?a(s):a;c?c(b):r(b),document.cookie=`sidebar_state=${b}; path=/; max-age=604800`},[c,s]),u=e.useCallback(()=>l?p(a=>!a):t(a=>!a),[l,t,p]);e.useEffect(()=>{let a=a=>{"b"===a.key&&(a.metaKey||a.ctrlKey)&&(a.preventDefault(),u())};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[u]);let v=s?"expanded":"collapsed",w=e.useMemo(()=>({state:v,open:s,setOpen:t,isMobile:l,openMobile:o,setOpenMobile:p,toggleSidebar:u}),[v,s,t,l,o,p,u]);return(0,d.jsx)(n.Provider,{value:w,children:(0,d.jsx)(m.Bc,{delayDuration:0,children:(0,d.jsx)("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3.438rem",...g},className:(0,j.cn)("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",f),...k,children:h})})})}function q({side:a="left",variant:b="sidebar",collapsible:c="offcanvas",className:e,children:f,...g}){let{isMobile:h,state:i,openMobile:k,setOpenMobile:m}=o();return"none"===c?(0,d.jsx)("div",{"data-slot":"sidebar",className:(0,j.cn)("bg-sidebar text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col",e),...g,children:f}):h?(0,d.jsx)(l.cj,{open:k,onOpenChange:m,...g,children:(0,d.jsxs)(l.h,{"data-sidebar":"sidebar","data-slot":"sidebar","data-mobile":"true",className:"bg-sidebar text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden",style:{"--sidebar-width":"18rem"},side:a,children:[(0,d.jsxs)(l.Fm,{className:"sr-only",children:[(0,d.jsx)(l.qp,{children:"Sidebar"}),(0,d.jsx)(l.Qs,{children:"Displays the mobile sidebar."})]}),(0,d.jsx)("div",{className:"flex size-full flex-col",children:f})]})}):(0,d.jsxs)("div",{className:"group peer text-sidebar-foreground hidden md:block","data-state":i,"data-collapsible":"collapsed"===i?c:"","data-variant":b,"data-side":a,"data-slot":"sidebar",children:[(0,d.jsx)("div",{"data-slot":"sidebar-gap",className:(0,j.cn)("relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180","floating"===b||"inset"===b?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon)")}),(0,d.jsx)("div",{"data-slot":"sidebar-container",className:(0,j.cn)("fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex","left"===a?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]","floating"===b||"inset"===b?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r group-data-[side=right]:border-l",e),...g,children:(0,d.jsx)("div",{"data-sidebar":"sidebar","data-slot":"sidebar-inner",className:"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex size-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm",children:f})})]})}function r({className:a,onClick:b,...c}){let{toggleSidebar:e}=o();return(0,d.jsxs)(k.$,{"data-sidebar":"trigger","data-slot":"sidebar-trigger",variant:"ghost",size:"icon",className:(0,j.cn)("size-7",a),onClick:a=>{b?.(a),e()},...c,children:[(0,d.jsx)(h.A,{}),(0,d.jsx)("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function s({className:a,...b}){return(0,d.jsx)("main",{"data-slot":"sidebar-inset",className:(0,j.cn)("bg-background relative flex w-full flex-1 flex-col","md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2",a),...b})}function t({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"sidebar-content","data-sidebar":"content",className:(0,j.cn)("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",a),...b})}function u({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"sidebar-group","data-sidebar":"group",className:(0,j.cn)("relative flex w-full min-w-0 flex-col p-2",a),...b})}function v({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"sidebar-group-content","data-sidebar":"group-content",className:(0,j.cn)("w-full text-sm",a),...b})}function w({className:a,...b}){return(0,d.jsx)("ul",{"data-slot":"sidebar-menu","data-sidebar":"menu",className:(0,j.cn)("flex w-full min-w-0 flex-col gap-1",a),...b})}function x({className:a,...b}){return(0,d.jsx)("li",{"data-slot":"sidebar-menu-item","data-sidebar":"menu-item",className:(0,j.cn)("group/menu-item relative",a),...b})}let y=(0,g.F)("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent/50 hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent/50 data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 cursor-pointer",{variants:{variant:{default:"hover:bg-sidebar-accent/50 hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent/50 hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function z({asChild:a=!1,isActive:b=!1,variant:c="default",size:e="default",tooltip:g,className:h,...i}){let k=a?f.DX:"button",{isMobile:l,state:n}=o(),p=(0,d.jsx)(k,{"data-slot":"sidebar-menu-button","data-sidebar":"menu-button","data-size":e,"data-active":b,className:(0,j.cn)(y({variant:c,size:e}),h),...i});return g?("string"==typeof g&&(g={children:g}),(0,d.jsxs)(m.m_,{children:[(0,d.jsx)(m.k$,{asChild:!0,children:p}),(0,d.jsx)(m.ZI,{side:"right",align:"center",hidden:"collapsed"!==n||l,...g})]})):p}function A({className:a,...b}){return(0,d.jsx)("ul",{"data-slot":"sidebar-menu-sub","data-sidebar":"menu-sub",className:(0,j.cn)("border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-1","group-data-[collapsible=icon]:hidden",a),...b})}function B({className:a,...b}){return(0,d.jsx)("li",{"data-slot":"sidebar-menu-sub-item","data-sidebar":"menu-sub-item",className:(0,j.cn)("group/menu-sub-item relative",a),...b})}function C({asChild:a=!1,size:b="md",isActive:c=!1,className:e,...g}){let h=a?f.DX:"a";return(0,d.jsx)(h,{"data-slot":"sidebar-menu-sub-button","data-sidebar":"menu-sub-button","data-size":b,"data-active":c,className:(0,j.cn)("text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent/50 hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground","sm"===b&&"text-xs","md"===b&&"text-sm","group-data-[collapsible=icon]:hidden",e),...g})}},67442:(a,b,c)=>{"use strict";c.d(b,{cn:()=>f});var d=c(43249),e=c(58829);function f(...a){return(0,e.QP)((0,d.$)(a))}},69643:(a,b,c)=>{"use strict";c.d(b,{V:()=>m});var d=c(21124),e=c(38301),f=c(8294),g=c(59405),h=c(85351),i=c(46084),j=c(62416),k=c(15514),l=c(19217);function m({className:a,classNames:b,showOutsideDays:c=!0,captionLayout:e="label",buttonVariant:m="ghost",formatters:o,components:p,...q}){let r=(0,i.a)();return(0,d.jsx)(j.h,{showOutsideDays:c,className:(0,k.cn)("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,a),captionLayout:e,formatters:{formatMonthDropdown:a=>a.toLocaleString("default",{month:"short"}),...o},classNames:{root:(0,k.cn)("w-fit",r.root),months:(0,k.cn)("flex gap-4 flex-col md:flex-row relative",r.months),month:(0,k.cn)("flex flex-col w-full gap-4",r.month),nav:(0,k.cn)("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",r.nav),button_previous:(0,k.cn)((0,l.r)({variant:m}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",r.button_previous),button_next:(0,k.cn)((0,l.r)({variant:m}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",r.button_next),month_caption:(0,k.cn)("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",r.month_caption),dropdowns:(0,k.cn)("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",r.dropdowns),dropdown_root:(0,k.cn)("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",r.dropdown_root),dropdown:(0,k.cn)("absolute bg-popover inset-0 opacity-0",r.dropdown),caption_label:(0,k.cn)("select-none font-medium","label"===e?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",r.caption_label),table:"w-full border-collapse",weekdays:(0,k.cn)("flex",r.weekdays),weekday:(0,k.cn)("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",r.weekday),week:(0,k.cn)("flex w-full mt-2",r.week),week_number_header:(0,k.cn)("select-none w-(--cell-size)",r.week_number_header),week_number:(0,k.cn)("text-[0.8rem] select-none text-muted-foreground",r.week_number),day:(0,k.cn)("relative size-full p-0 text-center [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",q.showWeekNumber?"[&:nth-child(2)[data-selected=true]_button]:rounded-l-md":"[&:first-child[data-selected=true]_button]:rounded-l-md",r.day),range_start:(0,k.cn)("rounded-l-md bg-accent",r.range_start),range_middle:(0,k.cn)("rounded-none",r.range_middle),range_end:(0,k.cn)("rounded-r-md bg-accent",r.range_end),today:(0,k.cn)("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",r.today),outside:(0,k.cn)("text-muted-foreground aria-selected:text-muted-foreground",r.outside),disabled:(0,k.cn)("text-muted-foreground opacity-50",r.disabled),hidden:(0,k.cn)("invisible",r.hidden),...b},components:{Root:({className:a,rootRef:b,...c})=>(0,d.jsx)("div",{"data-slot":"calendar",ref:b,className:(0,k.cn)(a),...c}),Chevron:({className:a,orientation:b,...c})=>"left"===b?(0,d.jsx)(f.A,{className:(0,k.cn)("size-4",a),...c}):"right"===b?(0,d.jsx)(g.A,{className:(0,k.cn)("size-4",a),...c}):(0,d.jsx)(h.A,{className:(0,k.cn)("size-4",a),...c}),DayButton:n,WeekNumber:({children:a,...b})=>(0,d.jsx)("td",{...b,children:(0,d.jsx)("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:a})}),...p},...q})}function n({className:a,day:b,modifiers:c,...f}){let g=(0,i.a)(),h=e.useRef(null);return e.useEffect(()=>{c.focused&&h.current?.focus()},[c.focused]),(0,d.jsx)(l.$,{ref:h,variant:"ghost",size:"icon","data-day":b.date.toLocaleDateString(),"data-selected-single":c.selected&&!c.range_start&&!c.range_end&&!c.range_middle,"data-range-start":c.range_start,"data-range-end":c.range_end,"data-range-middle":c.range_middle,className:(0,k.cn)("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",g.day,a),...f})}},71870:(a,b,c)=>{"use strict";c.d(b,{n:()=>ae});var d=c(21124),e=c(38301),f=c(47331),g=c(67454),h=c(57991);c(26134),c(2529),c(78733),c(10578);var i=c(18310),j=c(99042),k=c(45119),l=c(60874),m=c(15514),n=c(65749),o=c(45523);function p({jobs:a,technicians:b,selectedJob:c,selectedTechnician:f,disablePopovers:g=!1}){let h=(0,e.useRef)(null);(0,e.useRef)(null),(0,e.useRef)([]),(0,e.useRef)([]),(0,e.useRef)(new Map),(0,e.useRef)(new Map),(0,e.useRef)(new Map),(0,e.useRef)(null),(0,e.useRef)(null);let[k,m]=(0,e.useState)(!1),[p,q]=(0,e.useState)(null);(0,e.useRef)(null);let{resolvedTheme:r}=(0,o.D)();try{(0,n.cL)().state}catch{}return p?(0,d.jsx)("div",{className:"flex items-center justify-center h-full bg-muted/50 rounded-lg",children:(0,d.jsxs)("div",{className:"text-center p-6",children:[(0,d.jsx)(i.A,{className:"h-8 w-8 text-destructive mx-auto mb-2"}),(0,d.jsx)(j.QX,{children:p})]})}):(0,d.jsxs)("div",{className:"relative size-full md:min-h-[400px]",children:[(0,d.jsx)("div",{ref:h,className:"size-full min-h-[400px]"}),!k&&(0,d.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-muted/50 rounded-lg z-10",children:(0,d.jsxs)("div",{className:"text-center p-6",children:[(0,d.jsx)(l.y,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),(0,d.jsx)(j.QX,{children:"Loading map..."})]})}),!1]})}var q=c(674),r=c(22544),s=c(88020),t=c(19217),u=c(36736),v=c(69596),w=c(30733),x=c(82042),y=c(85351),z=c(45334),A=c(23673),B=c(69957),C=c(71117),D=c(11489),E=c(67748),F=c(30429),G=c(31196),H=c(70599),I=c(11227),J=c(85904),K=c(77254),L=c(8044);let M={score:{label:"Score"}};function N({technician:a,ranking:b,score:c,recommended:h,onClick:i,onAssign:l,selected:n,isAssigning:o=!1,onCollapse:p,allowOverride:N=!1}){let O=n??!1;(0,e.useRef)(O);let P=!b||100===b.availability,Q=(0,m.w)(a.homeLocation.address,!0),R=void 0!==c?[{name:"score",value:c,fill:c>=80?"hsl(142, 76%, 36%)":c>=60?"hsl(38, 92%, 50%)":"hsl(0, 84%, 60%)"}]:[];return(0,d.jsxs)("div",{className:"relative rounded-lg border transition-all overflow-hidden w-full",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3 p-3 cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>{O&&p?p():i&&i()},children:[(0,d.jsxs)("div",{className:"relative shrink-0",children:[(0,d.jsxs)(q.eu,{className:"size-12 border-2 border-background",children:[(0,d.jsx)(q.BK,{src:a.avatar,alt:a.name}),(0,d.jsx)(q.q5,{className:"bg-primary text-primary-foreground text-sm",children:a.name.split(" ").map(a=>a[0]).join("")})]}),(0,d.jsx)("div",{className:`absolute -bottom-0.5 -right-0.5 w-3.5 h-3.5 rounded-full border-2 border-background ${P?"bg-emerald-500":"bg-gray-400"}`})]}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsxs)("div",{className:"flex items-center gap-1.5 mb-1",children:[(0,d.jsx)("span",{className:"font-medium text-sm truncate",children:a.name}),h&&(0,d.jsx)(v.A,{className:"h-3.5 w-3.5 text-emerald-600 shrink-0"})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,d.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,d.jsx)(w.A,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),(0,d.jsx)("span",{className:"text-xs text-foreground",children:a.rating.overall})]}),b&&(0,d.jsxs)("span",{className:"text-xs text-muted-foreground",children:[b.distanceKm.toFixed(1),"km"]}),void 0!==c&&(0,d.jsx)(r.E,{variant:"outline",className:"text-xs h-5 px-1.5",children:c.toFixed(0)})]})]}),(0,d.jsx)("div",{className:"shrink-0",children:O?(0,d.jsx)(x.A,{className:"h-4 w-4 text-muted-foreground"}):(0,d.jsx)(y.A,{className:"h-4 w-4 text-muted-foreground"})})]}),(0,d.jsx)(f.N,{children:O&&(0,d.jsx)(g.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,d.jsxs)(k.Zp,{className:"px-3 pb-3 space-y-4 border-t border-border pt-3 gap-0 rounded-none shadow-none border-x-0 border-b-0 min-w-0",children:[(0,d.jsxs)(k.aR,{className:"space-y-3 min-w-0 w-full p-0 gap-0",children:[!a.isIndependent&&a.companyName&&(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(z.A,{className:"h-3.5 w-3.5 text-primary"}),(0,d.jsx)("span",{className:"text-xs text-primary",children:a.companyName})]}),a.isIndependent&&(0,d.jsx)(r.E,{variant:"outline",className:"text-xs h-5 w-fit",children:"Independent"}),b&&b.preferredRelationship>0&&(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(A.A,{className:"h-3.5 w-3.5 fill-red-500 text-red-500"}),(0,d.jsx)("span",{className:"text-xs text-destructive",children:"Preferred Vendor"})]}),(0,d.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground min-w-0 w-full overflow-hidden",children:[(0,d.jsx)(B.A,{className:"h-3.5 w-3.5 shrink-0"}),(0,d.jsx)("div",{className:"min-w-0 flex-1 overflow-hidden",children:(0,d.jsx)("span",{className:"truncate block w-full",children:Q})})]})]}),(0,d.jsxs)(k.Wu,{className:"space-y-2.5 p-0 gap-0 ",children:[b&&(0,d.jsxs)("div",{className:"space-y-2.5",children:[(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted/50 rounded-lg",children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Distance"}),(0,d.jsxs)("span",{className:"text-foreground",children:[b.distanceKm.toFixed(1),"km"]})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted/50 rounded-lg",children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Reliability"}),(0,d.jsxs)("span",{className:"text-foreground",children:[(100*a.reliability.onTimeRate).toFixed(0),"%"]})]})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Skill Match"}),(0,d.jsxs)(u.m_,{children:[(0,d.jsx)(u.k$,{asChild:!0,children:(0,d.jsx)(C.A,{className:"h-3 w-3 text-muted-foreground/60 hover:text-muted-foreground cursor-help"})}),(0,d.jsx)(u.ZI,{side:"top",className:"max-w-xs",children:(0,d.jsx)(j.P,{className:"text-xs",children:"Calculated by averaging the technician's skill ratings (1-5 scale) for each media type required by the job. The average is converted to a percentage (multiplied by 20)."})})]})]}),(0,d.jsxs)("span",{className:"text-foreground",children:[b.skillMatch.toFixed(0),"%"]})]}),(0,d.jsx)(s.k,{value:b.skillMatch,className:"h-1.5"})]})]}),(0,d.jsxs)("div",{className:"relative flex size-full items-center",children:[void 0!==c&&(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("div",{className:"text-center flex-1",children:(0,d.jsx)("div",{className:"flex items-center justify-center",children:(0,d.jsxs)(u.m_,{children:[(0,d.jsx)(u.k$,{asChild:!0,children:(0,d.jsx)("div",{children:(0,d.jsx)(F.at,{config:M,className:"size-16 cursor-help",children:(0,d.jsxs)(G.D,{data:R,startAngle:90,endAngle:90-c/100*360,innerRadius:25,outerRadius:30,children:[(0,d.jsx)(H.z,{gridType:"circle",radialLines:!1,stroke:"none",className:"first:fill-muted last:fill-background",polarRadius:[24,30]}),(0,d.jsx)(I.ZB,{dataKey:"value",background:!0,cornerRadius:10,fill:R[0]?.fill}),(0,d.jsx)(J.E,{tick:!1,tickLine:!1,axisLine:!1,children:(0,d.jsx)(K.JU,{content:({viewBox:a})=>{if(a&&"cx"in a&&"cy"in a)return(0,d.jsx)("text",{x:a.cx,y:a.cy,textAnchor:"middle",dominantBaseline:"middle",children:(0,d.jsx)("tspan",{x:a.cx,y:a.cy,className:"fill-foreground text-lg font-semibold",children:c.toFixed(0)})})}})})]})})})}),(0,d.jsx)(u.ZI,{children:(0,d.jsx)(j.P,{className:"max-w-xs",children:"Overall match score calculated from availability, distance, skill match, and reliability. Higher scores indicate better fit for the job."})})]})})})}),(0,d.jsx)(L.w,{orientation:"vertical",className:""}),(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center flex-1",children:[(0,d.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,d.jsx)(D.A,{className:"h-3.5 w-3.5 fill-muted-foreground/60 text-muted-foreground/60"}),(0,d.jsx)("span",{className:"text-sm font-semibold text-foreground",children:a.reliability.totalJobs})]}),(0,d.jsx)("div",{className:"text-xs text-muted-foreground/80 mt-0.5",children:"jobs"})]}),(0,d.jsx)(L.w,{orientation:"vertical",className:""}),(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center flex-1",children:[(0,d.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,d.jsx)(E.A,{className:"h-3.5 w-3.5 fill-muted-foreground/60 text-muted-foreground/60"}),(0,d.jsxs)("span",{className:"text-sm font-semibold text-foreground",children:[a.reliability.averageDeliveryTime,"h"]})]}),(0,d.jsx)("div",{className:"text-xs text-muted-foreground/80 mt-0.5",children:"avg delivery"})]})]})]}),(0,d.jsx)(k.wL,{className:"p-0 gap-0",children:l&&(0,d.jsxs)(u.m_,{children:[(0,d.jsx)(u.k$,{asChild:!0,children:(0,d.jsx)("span",{className:"w-full",children:(0,d.jsxs)(t.$,{onClick:a=>{a.stopPropagation(),l()},disabled:!P&&!N||o,className:`w-full ${h?"bg-emerald-600 hover:bg-emerald-700":"bg-primary"} shadow-md disabled:opacity-50 disabled:cursor-not-allowed`,children:[h&&(0,d.jsx)(v.A,{className:"h-4 w-4 mr-2"}),h?"Assign (Recommended)":"Assign Technician"]})})}),!P&&!N&&(0,d.jsx)(u.ZI,{children:(0,d.jsx)(j.P,{children:"This technician is not available for assignment"})})]})})]})})}),o&&(0,d.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-background/80 rounded-lg z-10",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("div",{className:"h-4 w-4 border-2 border-primary border-t-transparent rounded-full animate-spin"}),(0,d.jsx)("span",{className:"text-sm text-foreground",children:"Assigning..."})]})})]})}var O=c(40804),P=c(72966),Q=c(67442),R=c(59268),S=c(79944),T=c(8849),U=c(47089),V=c(3368),W=c(12125),X=c(28681),Y=c(7629),Z=c(88285),$=c(46762),_=c(28241),aa=c(88226),ab=c(62857),ac=c(33201);let ad=a=>"TECHNICIAN"===a.role;function ae({jobs:a,providers:b,selectedJob:c,onSelectJob:i,onNavigateToJobInProjectManagement:l,onJobAssign:m,className:n,fullScreen:o=!1,initialSidebarView:q="pending",initialJobForRankings:r=null,onGoBack:s,isDispatcherView:u=!0}){let[v,w]=(0,e.useState)(q),[x,y]=(0,e.useState)(r),[z,A]=(0,e.useState)(""),[C,D]=(0,e.useState)(!1),[F,G]=(0,e.useState)(["availability","distance","score"]),[H,I]=(0,e.useState)(null),[J,K]=(0,e.useState)(!1),L=(0,e.useMemo)(()=>b.filter(ad),[b]),[M,ae]=(0,e.useState)(null),[af,ag]=(0,e.useState)(null),{memberships:ah,activeOrganizationId:ai}=(0,ac.A)(),aj=(0,ab.in)(ah,ai),ak="OWNER"===aj||"ADMIN"===aj,al=a.filter(a=>"pending"===a.status),am=al.filter(a=>{if(!z)return!0;let b=z.toLowerCase();return a.propertyAddress.toLowerCase().includes(b)||a.clientName.toLowerCase().includes(b)||a.scheduledDate.toLowerCase().includes(b)}),an=()=>{s?s():(ae(null),w("pending"),y(null))},ao=(0,e.useMemo)(()=>x?[...L.filter(a=>"active"===a.status).map(a=>{let b=function(a,b,c,d){let e=(c-a)*Math.PI/180,f=(d-b)*Math.PI/180,g=Math.sin(e/2)*Math.sin(e/2)+Math.cos(a*Math.PI/180)*Math.cos(c*Math.PI/180)*Math.sin(f/2)*Math.sin(f/2);return 2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g))*6371}(a.homeLocation.lat,a.homeLocation.lng,x.location.lat,x.location.lng),c=a.availability.find(a=>a.date===x.scheduledDate),d=c?.available||!1,e=0;b<=5?e=100:b<=15?e=75:b<=30?e=50:b<=50&&(e=25);let{onTimeRate:f,noShows:g,totalJobs:h}=a.reliability,i=50;h>0&&(i=Math.max(0,Math.min(100,100*f-g/h*100)));let j={photo:"residential",video:"video",aerial:"aerial",twilight:"twilight"},k=0,l=0;for(let b of x.mediaType){let c=j[b];c&&void 0!==a.skills[c]&&(k+=a.skills[c],l++)}let m=l>0?k/l*20:50,n=0;a.preferredClients.includes(x.organizationId)&&(n=100);let o=100*!!d*.3+.25*n+.2*i+.15*e+.1*m;return{provider:a,isAvailable:d,distanceKm:b,distanceScore:e,reliabilityScore:i,skillScore:m,preferredScore:n,overallScore:o}})].sort((a,b)=>{for(let c of F){let d=0;if("availability"===c)d=!!b.isAvailable-!!a.isAvailable;else if("distance"===c)d=Math.round(10*a.distanceKm)/10-Math.round(10*b.distanceKm)/10;else if("score"===c){let c=Math.round(a.overallScore);d=Math.round(b.overallScore)-c}if(0!==d)return d}return 0}).map((a,b)=>({provider:a.provider,score:a.overallScore,factors:{availability:100*!!a.isAvailable,distance:a.distanceScore,distanceKm:a.distanceKm,reliability:a.reliabilityScore,skillMatch:a.skillScore,preferredRelationship:a.preferredScore},recommended:0===b&&a.isAvailable&&a.overallScore>=60,rank:b+1})):[],[x,L,F]),ap=async(a,b)=>{I(a);try{await new Promise(a=>setTimeout(a,500)),x&&m&&(m(x.id,a,b),an())}catch(a){console.error("Failed to assign technician:",a)}finally{I(null)}},aq=()=>{ag(null)},ar=(a,b)=>{let c=[...F],d=c.indexOf(b);if(-1!==d&&d!==a){let e=c[a];c[a]=b,c[d]=e}else c[a]=b;G(c)},as=()=>{if(F.length>=3)return;let a=["availability","distance","score"].find(a=>!F.includes(a));a&&G([...F,a])},at=a=>{if(F.length<=1)return;let b=[...F];b.splice(a,1),G(b)},au="rankings"===v&&x?[x]:a,av="rankings"===v&&x?ao.map(a=>a.provider):L,aw=(0,d.jsx)(d.Fragment,{children:"pending"===v?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(k.aR,{className:"py-4 px-4 md:px-0! space-y-3 gap-0! md:relative sticky top-0 z-50 md:z-10 bg-background",children:[(0,d.jsx)("div",{className:"flex items-center justify-between",children:(0,d.jsxs)("div",{children:[(0,d.jsx)(j.H3,{className:"text-lg border-0",children:u?"Pending Assignments":"Pending Jobs"}),(0,d.jsxs)(j.QX,{className:"text-xs",children:[al.length," ",1===al.length?"job":"jobs"]})]})}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(Z.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,d.jsx)(Y.p,{placeholder:"Search by address, client name...",value:z,onChange:a=>A(a.target.value),className:"pl-9 h-9"})]})]}),(0,d.jsx)(k.Wu,{className:`relative flex-1 p-0! min-h-0 overflow-hidden flex flex-col w-full min-w-0 max-w-full ${o?"py-4 px-4 md:px-0!":""}`,children:(0,d.jsx)(P.F,{className:"size-full min-w-0 max-w-full overflow-x-hidden",children:(0,d.jsx)("div",{className:"px-4 pb-4 md:px-0! md:pb-0 space-y-3 min-w-0 w-full max-w-full box-border",children:0===am.length?(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center py-12",children:[(0,d.jsx)(R.A,{className:"size-12 text-muted-foreground mb-4"}),(0,d.jsx)(j.H3,{className:"text-lg mb-2",children:"All caught up!"}),(0,d.jsx)(j.QX,{children:u?"No pending assignments":"No pending jobs"})]}):am.map(a=>(0,d.jsx)("div",{className:"w-full min-w-0 max-w-full box-border",children:(0,d.jsx)(O.o,{job:a,horizontal:!0,hideRequirements:!0,onClick:()=>{if("EDITOR"!==aj&&"TECHNICIAN"!==aj)ae(null),y(a),w("rankings");else i(a)},onViewInProjectManagement:l?()=>l(a):void 0,selected:c?.id===a.id})},a.id))})})})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(k.aR,{className:"py-4 px-4 md:px-0! space-y-3 gap-0! md:relative sticky top-0 z-50 md:z-10 bg-background",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,d.jsx)(t.$,{variant:"ghost",size:"icon",onClick:an,className:"h-8 w-8",children:(0,d.jsx)(S.A,{className:"h-4 w-4"})}),(0,d.jsx)(j.H3,{className:"text-lg border-0",children:"Ranked Technicians"})]}),x&&(0,d.jsx)(j.QX,{className:"text-xs mb-2",children:x.propertyAddress}),(0,d.jsx)("div",{children:(0,d.jsxs)(j.QX,{className:"text-xs",children:[ao.length," available"]})}),(0,d.jsx)("div",{className:"bg-background py-4 px-0! md:hidden block",children:(0,d.jsx)("div",{className:"space-y-3",children:(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)(j.Oc,{className:"text-xs font-semibold text-muted-foreground",children:"Sort Priority"}),F.length<3&&(0,d.jsxs)("button",{onClick:as,className:"flex items-center gap-1 text-xs text-primary hover:text-primary/80 transition-colors",type:"button",children:[(0,d.jsx)(T.A,{className:"h-3 w-3"}),"Add"]})]}),(0,d.jsx)("div",{className:"space-y-2",children:F.map((a,b)=>(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("div",{className:"flex items-center justify-center rounded bg-muted text-xs font-semibold w-6 h-6",children:b+1}),(0,d.jsxs)(_.l6,{value:a,onValueChange:a=>ar(b,a),children:[(0,d.jsx)(_.bq,{className:"text-xs flex-1 h-8",children:(0,d.jsx)(_.yv,{})}),(0,d.jsxs)(_.gC,{children:[(0,d.jsx)(_.eb,{value:"availability",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(R.A,{className:"h-3 w-3"}),"Availability"]})}),(0,d.jsx)(_.eb,{value:"distance",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(B.A,{className:"h-3 w-3"}),"Distance"]})}),(0,d.jsx)(_.eb,{value:"score",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(E.A,{className:"h-3 w-3"}),"Overall Score"]})})]})]}),F.length>1&&(0,d.jsx)("button",{onClick:()=>at(b),className:"flex items-center justify-center w-6 h-6 rounded hover:bg-muted transition-colors text-muted-foreground hover:text-foreground",type:"button","aria-label":"Remove priority",children:(0,d.jsx)(U.A,{className:"h-3 w-3"})})]},b))})]})})})]}),(0,d.jsx)(k.Wu,{className:`relative flex-1 p-0! min-h-0 overflow-hidden flex flex-col ${o?"py-4 px-4 md:px-0!":""}`,children:x&&(0,d.jsx)("div",{className:"flex-1 min-h-0",children:(0,d.jsx)(P.F,{className:"h-full",children:(0,d.jsxs)("div",{className:"space-y-0",children:[(0,d.jsx)("div",{className:"bg-background py-4 px-4 md:px-0! md:block hidden",children:(0,d.jsx)("div",{className:"space-y-3",children:(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)(j.Oc,{className:"text-xs font-semibold text-muted-foreground",children:"Sort Priority"}),F.length<3&&(0,d.jsxs)("button",{onClick:as,className:"flex items-center gap-1 text-xs text-primary hover:text-primary/80 transition-colors",type:"button",children:[(0,d.jsx)(T.A,{className:"h-3 w-3"}),"Add"]})]}),(0,d.jsx)("div",{className:"space-y-2",children:F.map((a,b)=>(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("div",{className:"flex items-center justify-center rounded bg-muted text-xs font-semibold w-6 h-6",children:b+1}),(0,d.jsxs)(_.l6,{value:a,onValueChange:a=>ar(b,a),children:[(0,d.jsx)(_.bq,{className:"text-xs flex-1 h-8",children:(0,d.jsx)(_.yv,{})}),(0,d.jsxs)(_.gC,{children:[(0,d.jsx)(_.eb,{value:"availability",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(R.A,{className:"h-3 w-3"}),"Availability"]})}),(0,d.jsx)(_.eb,{value:"distance",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(B.A,{className:"h-3 w-3"}),"Distance"]})}),(0,d.jsx)(_.eb,{value:"score",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(E.A,{className:"h-3 w-3"}),"Overall Score"]})})]})]}),F.length>1&&(0,d.jsx)("button",{onClick:()=>at(b),className:"flex items-center justify-center w-6 h-6 rounded hover:bg-muted transition-colors text-muted-foreground hover:text-foreground",type:"button","aria-label":"Remove priority",children:(0,d.jsx)(U.A,{className:"h-3 w-3"})})]},b))})]})})}),(0,d.jsx)("div",{className:"py-4 px-4 md:px-0! space-y-3",children:0===ao.length?(0,d.jsx)("div",{className:"text-center py-8",children:(0,d.jsx)(j.QX,{children:"No technicians available"})}):ao.map(a=>{let b=M===a.provider.userId,c=H===a.provider.userId;return(0,d.jsx)(N,{technician:a.provider,ranking:a.factors,score:a.score,recommended:a.recommended,selected:b,isAssigning:c,allowOverride:ak,onClick:()=>ae(a.provider.userId),onCollapse:()=>{M===a.provider.userId&&ae(null)},onAssign:()=>((a,b)=>{let c=ao.find(b=>b.provider.userId===a);if(c?.factors.availability!==100&&ak)return void ag({technicianId:a,technicianName:c?.provider.name||"this technician",score:b});ap(a,b)})(a.provider.userId,a.score)},a.provider.userId)})})]})},`technician-list-${x?.id||"none"}`)})})]})}),ax=(0,h.a)(),ay=(0,d.jsxs)("div",{className:"flex size-full overflow-hidden relative",children:[(0,d.jsx)("div",{className:`flex-1 min-w-0 overflow-hidden ${o?"":"rounded-md"}`,children:(0,d.jsx)(p,{jobs:au,technicians:av,selectedJob:"rankings"===v?x:c,selectedTechnician:"rankings"===v&&M&&av.find(a=>a.id===M)||null,disablePopovers:ax})}),ax?(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)($._s,{open:C,onOpenChange:D,children:[(0,d.jsx)($.Uz,{asChild:!0,children:(0,d.jsx)(t.$,{variant:"default",size:"icon",className:"fixed bottom-[calc(var(--dock-h)+0.5rem)] right-2 z-50 rounded-full size-12 p-0",children:(0,d.jsx)(V.A,{className:"size-5"})})}),(0,d.jsxs)($.zj,{className:"max-h-[90vh]",children:[(0,d.jsx)($.gk,{className:"sr-only",children:"pending"===v?u?"Pending Assignments":"Pending Jobs":"Ranked Technicians"}),(0,d.jsx)("div",{className:"overflow-y-auto size-full",children:(0,d.jsx)(k.Zp,{className:"border-0 shadow-none",children:aw})})]})]})}):(0,d.jsxs)(d.Fragment,{children:[o&&(0,d.jsx)(t.$,{variant:"secondary",size:"icon",onClick:()=>K(!J),className:(0,Q.cn)("absolute top-4 z-20 h-8 w-8 rounded-full shadow-md transition-[right] duration-200 ease-in-out",J?"right-4":"right-[calc(20rem+1rem)] xl:right-[calc(24rem+1rem)]"),title:J?"Show sidebar":"Hide sidebar",children:J?(0,d.jsx)(W.A,{className:"h-4 w-4"}):(0,d.jsx)(X.A,{className:"h-4 w-4"})}),(0,d.jsx)(f.N,{initial:!1,children:!J&&(0,d.jsx)(g.P.div,{initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},exit:{width:0,opacity:0},transition:{duration:.2,ease:"easeInOut"},className:"h-full overflow-hidden",children:(0,d.jsx)(k.Zp,{className:`relative w-80 xl:w-96 bg-background border-l border-border flex flex-col shrink-0 rounded-none border-x-0! border-y-0! gap-0 h-full overflow-hidden ${o?"px-4":"pl-4"}`,children:aw})})})]}),(0,d.jsx)(aa.Lt,{open:!!af,onOpenChange:a=>!a&&aq(),children:(0,d.jsxs)(aa.EO,{children:[(0,d.jsxs)(aa.wd,{children:[(0,d.jsx)(aa.r7,{children:"Assign Unavailable Technician?"}),(0,d.jsxs)(aa.$v,{children:[(0,d.jsx)("strong",{children:af?.technicianName})," is currently marked as unavailable for this date. Are you sure you want to override and assign them to this job?"]})]}),(0,d.jsxs)(aa.ck,{children:[(0,d.jsx)(aa.Zr,{onClick:aq,children:"Cancel"}),(0,d.jsx)(aa.Rx,{onClick:()=>{af&&(ap(af.technicianId,af.score),ag(null))},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Assign Anyway"})]})]})})]});return o?(0,d.jsx)("div",{className:`${n||"size-full"} overflow-hidden flex flex-col h-full`,children:ay}):(0,d.jsx)(g.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:n||"w-full aspect-video max-h-[65vh]",children:ay})}},72966:(a,b,c)=>{"use strict";c.d(b,{$:()=>h,F:()=>g});var d=c(21124);c(38301);var e=c(84550),f=c(67442);function g({className:a,children:b,...c}){return(0,d.jsxs)(e.bL,{"data-slot":"scroll-area",className:(0,f.cn)("relative",a),...c,children:[(0,d.jsx)(e.LM,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:b}),(0,d.jsx)(h,{}),(0,d.jsx)(e.OK,{})]})}function h({className:a,orientation:b="vertical",...c}){return(0,d.jsx)(e.VM,{"data-slot":"scroll-area-scrollbar",orientation:b,className:(0,f.cn)("flex touch-none p-px transition-colors select-none","vertical"===b&&"h-full w-2.5 border-l border-l-transparent","horizontal"===b&&"h-2.5 flex-col border-t border-t-transparent",a),...c,children:(0,d.jsx)(e.lr,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}},76577:(a,b,c)=>{"use strict";c.d(b,{Q:()=>f});var d=c(38301),e=c(33201);function f(){let{memberships:a,activeOrganizationId:b,switchOrganization:c}=(0,e.A)(),f=(0,d.useMemo)(()=>b&&a.find(a=>a.orgId===b)||null,[b,a]);return{memberships:a,activeOrganizationId:b,activeMembership:f,setActiveOrganization:c}}},77555:(a,b,c)=>{"use strict";c.d(b,{e2:()=>h});var d=c(21124),e=c(26691),f=c(15514);c(8044);let g=(0,e.F)("flex w-fit items-stretch [&>*]:focus-visible:z-10 [&>*]:focus-visible:relative [&>[data-slot=select-trigger]:not([class*='w-'])]:w-fit [&>input]:flex-1 has-[select[aria-hidden=true]:last-child]:[&>[data-slot=select-trigger]:last-of-type]:rounded-r-md has-[>[data-slot=button-group]]:gap-2",{variants:{orientation:{horizontal:"[&>*:not(:first-child)]:rounded-l-none [&>*:not(:first-child)]:border-l-0 [&>*:not(:last-child)]:rounded-r-none",vertical:"flex-col [&>*:not(:first-child)]:rounded-t-none [&>*:not(:first-child)]:border-t-0 [&>*:not(:last-child)]:rounded-b-none"}},defaultVariants:{orientation:"horizontal"}});function h({className:a,orientation:b,...c}){return(0,d.jsx)("div",{role:"group","data-slot":"button-group","data-orientation":b,className:(0,f.cn)(g({orientation:b}),a),...c})}},81676:(a,b,c)=>{"use strict";c.d(b,{H:()=>i});var d=c(36734),e=c(4173),f=c(87278),g=c(52647),h=c(39983);let i=[{id:"photo",label:"Photography",icon:d.A,color:""},{id:"measurement",label:"Measurements",icon:e.A,color:""},{id:"video",label:"Video",icon:f.A,color:""},{id:"aerial",label:"Aerial/Drone",icon:g.A,color:""},{id:"twilight",label:"Twilight",icon:h.A,color:""}]},85948:(a,b,c)=>{"use strict";c.d(b,{s:()=>i,w:()=>j});var d=c(21124),e=c(38301),f=c(79347),g=c(42830);let h=(0,e.createContext)(void 0);function i({children:a,defaultUserId:b,defaultOrganizationId:c,initialProjects:i,userRole:j,memberRole:k}){let l=(0,e.useCallback)(a=>a.map(a=>({...a,createdAt:new Date(a.createdAt),updatedAt:new Date(a.updatedAt),scheduledTime:new Date(a.scheduledTime)})),[]),[m,n]=(0,e.useState)(()=>i?l(i):[]),[o,p]=(0,e.useState)(!i),[q,r]=(0,e.useState)(null),[s,t]=(0,e.useState)(null),[u,v]=(0,e.useState)(!1),[w,x]=(0,e.useState)(!1),[y,z]=(0,e.useState)(!1),A=(0,e.useCallback)(async()=>{p(!0),r(null),!f.F.organizations.getActiveOrganization()&&c&&j?.toUpperCase()!=="AGENT"&&f.F.organizations.setActiveOrganization(c);try{let a=[];try{a=await f.F.projects.listForCurrentUser()}catch(b){console.warn("Failed to fetch user projects:",b?.message),a=[]}let b=l(a);n(b)}catch(a){console.error("Error fetching jobs:",a),r(a),String(a).includes("org")||g.oR.error("Failed to load jobs")}finally{p(!1)}},[c,k,l,j]),B=(0,e.useCallback)(a=>{n(b=>b.some(b=>b.id===a.id)?b.map(b=>b.id===a.id?a:b):[a,...b])},[]),C=(0,e.useMemo)(()=>m.map(a=>f.F.mapProjectToJobCard(a)),[m]),D=(0,e.useCallback)(a=>C.find(b=>b.id===a),[C]),E=(0,e.useCallback)(a=>m.find(b=>b.id===a),[m]),F=(0,e.useCallback)((a,b)=>{n(c=>c.map(c=>c.id===a?{...c,...b}:c))},[]),G=(0,e.useCallback)((a,b,c)=>{(async()=>{try{let d=await f.F.projects.assignTechnician(a,b);F(a,d),v(!1),t(null),g.oR.success("Technician assigned successfully"),window.dispatchEvent(new CustomEvent("jobAssigned",{detail:{jobId:a,technicianId:b,score:c}}))}catch(a){console.error("Failed to assign technician",a),g.oR.error("Failed to assign technician")}})()},[F]),H=(0,e.useCallback)((a,b)=>{(async()=>{try{let c=await f.F.projects.updateStatus(a,b);F(a,c),window.dispatchEvent(new CustomEvent("jobStatusChanged",{detail:{jobId:a,newStatus:b}})),g.oR.success("Status updated")}catch(a){console.error("Failed to update status",a),g.oR.error("Failed to update status")}})()},[F]),I=(0,e.useCallback)(async a=>{let b=j?.toUpperCase()==="AGENT";try{if(b){let b=await f.F.orders.cancel(a);g.oR.success("deleted"===b.action?"Order deleted":"Order cancelled")}else await f.F.projects.delete(a),g.oR.success("Job deleted");n(b=>b.filter(b=>b.id!==a)),t(b=>b?.id===a?null:b),x(!1),z(!1),v(!1),window.dispatchEvent(new CustomEvent("jobDeleted",{detail:{jobId:a}}))}catch(a){throw console.error("Failed to delete/cancel project",a),g.oR.error(b?"Failed to cancel order":"Failed to delete project"),a}},[j]),J=(0,e.useCallback)(async a=>{let b=a.orgId||c;if(!b)throw g.oR.error("No organization selected. Please select an organization before creating a project."),Error("Missing organization");try{let c=await f.F.projects.create({address:a.address||a.propertyAddress||"",scheduledTime:a.scheduledTime||new Date,notes:a.notes,customerId:a.customerId,projectManagerId:a.projectManagerId,technicianId:a.technicianId,editorId:a.editorId,orgId:b}),d={...c,createdAt:new Date(c.createdAt),updatedAt:new Date(c.updatedAt),scheduledTime:new Date(c.scheduledTime)};return B(d),window.dispatchEvent(new CustomEvent("jobCreated",{detail:d})),d}catch(a){throw console.error("Failed to create project",a),g.oR.error("Failed to create project"),a}},[b,c,B]),K=(0,e.useCallback)(a=>{t(a)},[]),L=(0,e.useCallback)(a=>{t(b=>b?.id===a.id?null:a)},[]),M=(0,e.useCallback)(a=>{t(a),v(!0)},[]),N=(0,e.useCallback)(()=>{v(!1),t(null)},[]),O=(0,e.useCallback)(a=>{t(a),x(!0)},[]),P=(0,e.useCallback)(()=>{x(!1),t(null)},[]),Q=(0,e.useCallback)(()=>{x(!1),z(!0)},[]),R=(0,e.useCallback)(()=>{z(!1),t(null)},[]),S=(0,e.useCallback)(a=>{a||P()},[P]),T=(0,e.useCallback)(a=>{a||R()},[R]),U=(0,e.useCallback)(()=>{s&&(x(!1),t(s),v(!0))},[s]),V=(0,e.useCallback)(()=>{s&&(w&&x(!1),y&&z(!1),t(s),v(!0))},[s,w,y]);return(0,d.jsx)(h.Provider,{value:{projects:m,jobCards:C,jobs:C,isLoadingJobs:o,jobsError:q,refreshJobs:A,getJobById:D,getProjectById:E,updateJob:F,assignJob:G,changeJobStatus:H,createJob:J,deleteJob:I,selectedJob:s,selectJob:K,toggleJobSelection:L,showRankings:u,openRankings:M,closeRankings:N,showTaskView:w,showTaskDialog:y,openTaskView:O,closeTaskView:P,openTaskDialog:Q,closeTaskDialog:R,handleTaskViewClose:S,handleTaskDialogClose:T,handleAssignTechnician:U,handleChangeTechnician:V},children:a})}function j(){let a=(0,e.useContext)(h);if(void 0===a)throw Error("useJobManagement must be used within a JobManagementProvider");return a}},85956:(a,b,c)=>{"use strict";c.d(b,{l:()=>h});var d=c(38301),e=c(42378),f=c(33201),g=c(62857);function h(a,b={}){(0,e.useRouter)();let{user:c,isLoading:i,activeOrganizationId:j,memberships:k}=(0,f.A)(),{redirectTo:l,enforceRedirect:m}=b,n=(0,d.useCallback)(()=>(0,g.in)(k,j),[k,j]);return{user:c,organizationId:j,memberships:k,isLoading:i,getActiveOrgRole:n}}c(27654)},86276:(a,b,c)=>{"use strict";c.d(b,{Fm:()=>l,Qs:()=>o,XW:()=>m,cj:()=>h,h:()=>k,qp:()=>n});var d=c(21124);c(38301);var e=c(6843),f=c(47089),g=c(67442);function h({...a}){return(0,d.jsx)(e.bL,{"data-slot":"sheet",...a})}function i({...a}){return(0,d.jsx)(e.ZL,{"data-slot":"sheet-portal",...a})}function j({className:a,...b}){return(0,d.jsx)(e.hJ,{"data-slot":"sheet-overlay",className:(0,g.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...b})}function k({className:a,children:b,side:c="right",...h}){return(0,d.jsxs)(i,{children:[(0,d.jsx)(j,{}),(0,d.jsxs)(e.UC,{"data-slot":"sheet-content",className:(0,g.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500","right"===c&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm","left"===c&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm","top"===c&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===c&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",a),...h,children:[b,(0,d.jsxs)(e.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[(0,d.jsx)(f.A,{className:"size-4"}),(0,d.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function l({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"sheet-header",className:(0,g.cn)("flex flex-col gap-1.5 p-4",a),...b})}function m({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"sheet-footer",className:(0,g.cn)("mt-auto flex flex-col gap-2 p-4",a),...b})}function n({className:a,...b}){return(0,d.jsx)(e.hE,{"data-slot":"sheet-title",className:(0,g.cn)("text-foreground font-semibold",a),...b})}function o({className:a,...b}){return(0,d.jsx)(e.VY,{"data-slot":"sheet-description",className:(0,g.cn)("text-muted-foreground text-sm",a),...b})}},88020:(a,b,c)=>{"use strict";c.d(b,{k:()=>h});var d=c(21124),e=c(38301),f=c(199),g=c(15514);let h=e.forwardRef(({className:a,value:b,indicatorClassName:c,...e},h)=>(0,d.jsx)(f.bL,{ref:h,className:(0,g.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",a),...e,children:(0,d.jsx)(f.C1,{className:(0,g.cn)("h-full w-full flex-1 bg-primary transition-all",c),style:{transform:`translateX(-${100-(b||0)}%)`}})}));h.displayName=f.bL.displayName},88226:(a,b,c)=>{"use strict";c.d(b,{$v:()=>p,EO:()=>l,Lt:()=>h,Rx:()=>q,Zr:()=>r,ck:()=>n,r7:()=>o,tv:()=>i,wd:()=>m});var d=c(21124);c(38301);var e=c(21536),f=c(67442),g=c(19217);function h({...a}){return(0,d.jsx)(e.bL,{"data-slot":"alert-dialog",...a})}function i({...a}){return(0,d.jsx)(e.l9,{"data-slot":"alert-dialog-trigger",...a})}function j({...a}){return(0,d.jsx)(e.ZL,{"data-slot":"alert-dialog-portal",...a})}function k({className:a,...b}){return(0,d.jsx)(e.hJ,{"data-slot":"alert-dialog-overlay",className:(0,f.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...b})}function l({className:a,...b}){return(0,d.jsxs)(j,{children:[(0,d.jsx)(k,{}),(0,d.jsx)(e.UC,{"data-slot":"alert-dialog-content",className:(0,f.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...b})]})}function m({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,f.cn)("flex flex-col gap-2 text-center sm:text-left",a),...b})}function n({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,f.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...b})}function o({className:a,...b}){return(0,d.jsx)(e.hE,{"data-slot":"alert-dialog-title",className:(0,f.cn)("text-lg font-semibold",a),...b})}function p({className:a,...b}){return(0,d.jsx)(e.VY,{"data-slot":"alert-dialog-description",className:(0,f.cn)("text-muted-foreground text-sm",a),...b})}function q({className:a,...b}){return(0,d.jsx)(e.rc,{className:(0,f.cn)((0,g.r)(),a),...b})}function r({className:a,...b}){return(0,d.jsx)(e.ZD,{className:(0,f.cn)((0,g.r)({variant:"outline"}),a),...b})}},95555:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/duro/Documents/Confidential/VREM/vrem/apps/frontend/app/(protected)/layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/duro/Documents/Confidential/VREM/vrem/apps/frontend/app/(protected)/layout.tsx","default")},96341:(a,b,c)=>{"use strict";c.d(b,{O:()=>i});var d=c(21124),e=c(42378),f=c(19217),g=c(45119),h=c(18310);function i({title:a="Access Denied",description:b="You do not have permission to access this page. Please contact your administrator.",redirectTo:c="/dashboard",redirectLabel:i="Go to Dashboard"}){let j=(0,e.useRouter)();return(0,d.jsx)("div",{className:"size-full overflow-x-hidden flex items-center justify-center p-6",children:(0,d.jsxs)(g.Zp,{className:"max-w-md w-full",children:[(0,d.jsxs)(g.aR,{className:"mb-md",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3 mb-xs",children:[(0,d.jsx)(h.A,{className:"h-6 w-6 text-destructive"}),(0,d.jsx)(g.ZB,{children:a})]}),(0,d.jsx)(g.BT,{children:b})]}),(0,d.jsx)(g.Wu,{children:(0,d.jsx)(f.$,{onClick:()=>j.push(c),className:"w-full",children:i})})]})})}},99035:(a,b,c)=>{"use strict";c.d(b,{G:()=>f});var d=c(38301);c(79347);var e=c(76577);function f(){let[a,b]=(0,d.useState)(null),[c,f]=(0,d.useState)(!0),{activeOrganizationId:g,setActiveOrganization:h}=(0,e.Q)(),i=(0,d.useMemo)(()=>a?function(a,b,c){let d=[];for(let c of(d.push({id:`personal-${a.id}`,userId:"",user:{},orgId:a.id,organization:{id:a.id,name:a.name,type:a.type,logoUrl:a.logoUrl||void 0,createdAt:new Date},orgRole:"OWNER",role:"OWNER",createdAt:new Date}),b))d.push({id:`member-${c.orgId}`,userId:"",user:{},orgId:c.orgId,organization:{id:c.organization.id,name:c.organization.name,type:c.organization.type,logoUrl:c.organization.logoUrl||void 0,createdAt:c.createdAt},orgRole:c.role,role:c.role,createdAt:c.createdAt});return d}(a.personalOrg,a.memberships,a.customerOfOrgs):[],[a]),j=(0,d.useMemo)(()=>a?.customerOfOrgs||[],[a]),k=(0,d.useMemo)(()=>a?.personalOrg||null,[a]);return{memberships:i,isLoading:c,activeOrganizationId:g,setActiveOrganization:h,orgContext:a,personalOrg:k,customerOfOrgs:j}}},99042:(a,b,c)=>{"use strict";c.d(b,{H1:()=>f,H2:()=>g,H3:()=>h,H4:()=>i,Oc:()=>l,P:()=>j,QX:()=>m,yE:()=>k});var d=c(21124);c(38301);var e=c(67442);function f({children:a,className:b,...c}){return(0,d.jsx)("h1",{className:(0,e.cn)("scroll-m-20 text-4xl font-extrabold tracking-tight text-balance",b),...c,children:a})}function g({children:a,className:b,...c}){return(0,d.jsx)("h2",{className:(0,e.cn)("scroll-m-20 text-3xl font-semibold tracking-tight transition-colors first:mt-0",b),...c,children:a})}function h({children:a,className:b,...c}){return(0,d.jsx)("h3",{className:(0,e.cn)("scroll-m-20 text-2xl font-semibold tracking-tight",b),...c,children:a})}function i({children:a,className:b,...c}){return(0,d.jsx)("h4",{className:(0,e.cn)("scroll-m-20 text-xl font-semibold tracking-tight",b),...c,children:a})}function j({children:a,className:b,...c}){return(0,d.jsx)("p",{className:(0,e.cn)("leading-[1.5em]",b),...c,children:a})}function k({children:a,className:b,...c}){return(0,d.jsx)("div",{className:(0,e.cn)("text-lg font-semibold",b),...c,children:a})}function l({children:a,className:b,...c}){return(0,d.jsx)("small",{className:(0,e.cn)("text-sm font-medium leading-none",b),...c,children:a})}function m({children:a,className:b,...c}){return(0,d.jsx)("p",{className:(0,e.cn)("text-sm text-muted-foreground",b),...c,children:a})}}};